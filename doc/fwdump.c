
_UNKNOWN loc_80001EE; 
_UNKNOWN loc_800021E; 
_UNKNOWN loc_800026E; 
_UNKNOWN loc_8000398; 
_UNKNOWN loc_8000BE4; 
_UNKNOWN loc_8001DFE; 
__int16 word_80035E8 = 1288; 
__int16 word_8009A62 = 1545; 
__int16 word_800C8DC = 1030; 
__int16 word_800C96C = 1030; 
_UNKNOWN loc_800E18C; 
_UNKNOWN loc_800F4F8; 
_UNKNOWN loc_800F74C; 
_WORD byte_800F810[] = { 0 };
_BYTE byte_800F81A[8] = { 30, 40, 50, 60, 70, 80, 10, 12 }; 
_BYTE byte_800F822[38] =
{
  246,
  48,
  211,
  241,
  53,
  229,
  231,
  112,
  247,
  245,
  1,
  0,
  199,
  3,
  119,
  198,
  134,
  135,
  182,
  179,
  55,
  118,
  71,
  175,
  6,
  109,
  79,
  198,
  203,
  235,
  14,
  239,
  207,
  64,
  0,
  99,
  0,
  0
}; 
int dword_800F848[] = { 1106499338 }; 
_UNKNOWN unk_800F860; 
char si_disable_output3[2] = { '\x03', '\xFF' }; 
char si_enable_fanout3[2] = { '»', 'À' }; 
char si_set_160_159_995[68] =
{
  '\x0F',
  '\0',
  'O',
  'O',
  'o',
  '€',
  '€',
  '€',
  '€',
  '€',
  '\0',
  '\0',
  '\0',
  '\x05',
  '\0',
  '\n',
  'Ì',
  '\0',
  '\0',
  '\x04',
  '\x04',
  'â',
  '\0',
  '\n',
  'Ì',
  '\0',
  '\x03',
  'h',
  '\0',
  '\x01',
  '\f',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\x01',
  '!',
  'ò',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\x01',
  '\f',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0'
}; 
char si_reset_pll3[2] = { '±', '¬' }; 
char si_enable_output3[2] = { '\x03', 'ø' }; 
char si_disable_output2[2] = { '\x03', '\xFF' }; 
char si_enable_fanout2[2] = { '»', 'À' }; 
char si_set_159_05_159_045[68] =
{
  '\x0F',
  '\0',
  'O',
  '\x0F',
  'o',
  '€',
  '€',
  '€',
  '€',
  '€',
  '\0',
  '\0',
  '\0',
  '}',
  '\0',
  '\n',
  '¹',
  '\0',
  '\0',
  '+',
  '\x04',
  'â',
  '\0',
  '\n',
  '¹',
  '\0',
  '\x01',
  '.',
  '\0',
  '\x01',
  '\f',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\x10',
  '!',
  'ï',
  '\b',
  '\0',
  '\0',
  '\0',
  '\0',
  '\x01',
  '\f',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0'
}; 
char si_reset_pll2[2] = { '±', '¬' }; 
char si_enable_output2[2] = { '\x03', 'ø' }; 
char si_disable_output1[2] = { '\x03', '\xFF' }; 
char si_enable_fanout1[2] = { '»', 'À' }; 
char si_set_135_00_134_995mhz[68] =
{
  '\x0F',
  '\0',
  'O',
  '\x0F',
  'o',
  '€',
  '€',
  '€',
  '€',
  '€',
  '\0',
  '\0',
  '\0',
  '\x05',
  '\0',
  '\x0E',
  '3',
  '\0',
  '\0',
  '\x01',
  '\t',
  'Ä',
  '\0',
  '\x0E',
  '3',
  '\0',
  '\0',
  't',
  '\0',
  '\x01',
  '\0',
  '\x01',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\b',
  '\"',
  'v',
  'Ð',
  '\0',
  '\0',
  '\0',
  '\0',
  '\x01',
  '\0',
  '\x01',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0'
}; 
char si_reset_pll1[2] = { '±', '¬' }; 
char si_enable_output1[2] = { '\x03', 'ø' }; 
_BYTE si_disable_output[41] =
{
  3,
  255,
  187,
  192,
  15,
  0,
  79,
  15,
  111,
  128,
  128,
  128,
  128,
  128,
  0,
  0,
  0,
  5,
  0,
  13,
  153,
  0,
  0,
  3,
  9,
  196,
  0,
  13,
  153,
  0,
  4,
  92,
  0,
  1,
  0,
  1,
  0,
  0,
  0,
  0,
  0
}; 
char si_enable_fanout[2] = { '»', 'À' }; 
char si_set_130_00_129_995mhz[68] =
{
  '\x0F',
  '\0',
  'O',
  '\x0F',
  'o',
  '€',
  '€',
  '€',
  '€',
  '€',
  '\0',
  '\0',
  '\0',
  '\x05',
  '\0',
  '\r',
  '™',
  '\0',
  '\0',
  '\x03',
  '\t',
  'Ä',
  '\0',
  '\r',
  '™',
  '\0',
  '\x04',
  '\\',
  '\0',
  '\x01',
  '\0',
  '\x01',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\x04',
  '\"',
  '_',
  '`',
  '\0',
  '\0',
  '\0',
  '\0',
  '\x01',
  '\0',
  '\x01',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0',
  '\0'
}; 
char si_reset_pll[2] = { '±', '¬' }; 
char si_enable_output[2] = { '\x03', 'ø' }; 
float cos_tbl[] = {  0.0 };
float sin_tbl[] =
{
   1.0,
   0.98079,
   0.92388,
   0.83147,
   0.70711,
   0.55557,
   0.38268,
   0.19509,
   0.0
};
int dword_800FBA4[] = { 1132593152 }; 
_BYTE byte_800FBB4[107] =
{
  128,
  128,
  127,
  126,
  125,
  124,
  123,
  122,
  121,
  120,
  119,
  118,
  118,
  117,
  116,
  115,
  114,
  113,
  113,
  112,
  111,
  110,
  110,
  109,
  108,
  108,
  107,
  106,
  106,
  105,
  104,
  104,
  103,
  102,
  102,
  101,
  100,
  100,
  99,
  99,
  98,
  97,
  97,
  96,
  96,
  95,
  95,
  94,
  94,
  93,
  93,
  92,
  92,
  91,
  91,
  90,
  90,
  89,
  89,
  88,
  88,
  87,
  87,
  86,
  86,
  85,
  85,
  85,
  84,
  84,
  83,
  83,
  82,
  82,
  82,
  81,
  81,
  80,
  80,
  80,
  79,
  79,
  79,
  78,
  78,
  77,
  77,
  77,
  76,
  76,
  76,
  75,
  75,
  75,
  74,
  74,
  74,
  73,
  73,
  73,
  72,
  72,
  72,
  71,
  71,
  71,
  71
}; 
int dword_800FC34[17] =
{
  2223211137,
  2290583173,
  2374798217,
  2459013006,
  2543228307,
  2644286105,
  2745344159,
  2863179685,
  2997923500,
  3115824563,
  3267411644,
  3435775941,
  3621048782,
  3806321881,
  4042058214,
  4277860339,
  0
}; 
_UNKNOWN unk_800FC78; 
double unk_800FC98[] = ;
int dword_800FCB8[10] =
{
  2576935876,
  3217660313,
  4263712369,
  3216798150,
  2943654509,
  3216224498,
  1390345626,
  3215842861,
  745172015,
  3215111236
}; 
_UNKNOWN unk_800FCE0; 
unsigned __int8 byte_20000000;
unsigned __int8 si_cfg;
int num_result; 
char timer_ticked; 
float dword_20000010;
__int16 word_20000014; 
char byte_20000016; 
char byte_20000017; 
char byte_20000018; 
char byte_20000019; 
__int16 timer_downcount; 
unsigned __int16 word_2000001E;
int dword_20000020; 
unsigned __int8 current_state;
float dword_20000034;
float laser1_phase_max;
float laser1_phase_min;
float dword_20000040;
float dword_20000044;
char byte_20000058; 
char byte_20000059; 
char byte_2000005A; 
char byte_2000005B; 
char byte_2000005C; 
char byte_2000005D; 
char byte_2000005E; 
__int16 word_20000062; 
char byte_20000064; 
char someflag; 
char somemagicflag; 
char byte_2000006A; 
char byte_2000006C; 
unsigned __int8 byte_2000006D;
char byte_2000006E; 
unsigned __int16 word_20000070;
int dword_20000074; 
char byte_20000078; 
char byte_20000079; 
char byte_2000007B; 
int dword_2000007C; 
int dword_20000080; 
int dword_20000084; 
__int16 word_2000008C; 
char byte_2000008E; 
char byte_20000090; 
char byte_20000091; 
__int16 word_20000092; 
__int16 word_20000094; 
unsigned __int8 byte_20000096;
unsigned __int8 byte_20000098;
unsigned __int8 byte_20000099;
char byte_2000009A; 
char byte_2000009B; 
unsigned __int8 math_mode;
char byte_2000009D; 
char byte_2000009E; 
char byte_2000009F; 
char byte_200000A0; 
char byte_200000A1; 
char byte_200000A2; 
__int16 word_200000A4; 
char byte_200000A6; 
char byte_200000A7; 
char byte_200000A9; 
char byte_200000AA; 
char byte_200000AB; 
char byte_200000AC; 
char byte_200000AD; 
char byte_200000AE; 
char byte_200000AF; 
__int16 adc_battery; 
unsigned __int16 apd_pwm_value;
__int16 word_200000B6; 
unsigned __int16 signal_max;
int dword_200000BC; 
int dword_200000C0; 
int dword_200000C4; 
unsigned int dword_200000C8;
int dword_200000CC; 
int dword_200000D0; 
int dword_200000D4; 
int dword_200000D8; 
unsigned __int16 word_200000DC;
__int16 word_200000DE; 
float dword_200000E4;
float dword_200000E8;
float dword_200000EC;
char byte_200000F0; 
char byte_200000F2; 
char byte_200000F3; 
char error_no; 
char byte_200000F6; 
char byte_200000F7; 
char byte_200000F8; 
unsigned __int8 byte_200000F9;
char digit_1_decimal; 
char digit_2_decimal; 
char digit_3_decimal; 
char digit_4_decimal; 
int dword_20000100; 
int dword_20000104; 
int dword_20000108; 
char byte_2000010C; 
char byte_2000010D; 
char byte_2000010E; 
unsigned __int16 word_20000110;
__int16 word_20000112; 
char byte_20000114; 
char byte_20000115; 
unsigned __int8 byte_20000117;
char byte_20000118; 
char byte_20000119; 
char byte_2000011A; 
char byte_2000011B; 
__int16 adp_pwm_value_laser2; 
__int16 adp_pwm_value_laser1; 
__int16 word_20000120; 
__int16 word_20000122; 
unsigned __int8 byte_20000124;
char byte_20000125; 
char new_adc_data; 
int dword_20000128; 
char byte_2000012C; 
int max_distance; 
int dword_20000134; 
__int16 word_20000138; 
char byte_2000013A; 
char byte_2000013E; 
char byte_2000013F; 
char beep_enabled; 
unsigned __int16 word_20000144;
char timer_counter10; 
unsigned __int8 timer_count;
__int16 word_20000156; 
char byte_20000158; 
char byte_20000159; 
char byte_2000015A; 
char byte_2000015B; 
char byte_2000015C; 
struc_gpio stru_20000160;
char byte_20000169; 
char byte_2000016A; 
unsigned __int8 uart_idx;
char byte_2000016D; 
int dword_20000170; 
int dword_20000174; 
int dword_20000178; 
unsigned __int8 byte_2000017E;
char byte_2000017F; 
unsigned __int8 byte_20000182;
char byte_20000188; 
unsigned __int8 byte_20000189;
char byte_2000018B; 
char byte_2000018C; 
char byte_2000018E; 
char byte_2000018F; 
char byte_20000190; 
char byte_20000198; 
char byte_20000199; 
char byte_2000019A; 
int dword_2000019C; 
char byte_200001AE; 
_BYTE byte_200001AF[17]; 
unsigned __int8 selected_laser;
char byte_200001C1; 
unsigned __int8 byte_200001C2;
char byte_200001C3; 
char byte_200001C5; 
float dword_200001C8;
int dword_200001CC; 
int dword_200001D0; 
int dword_200001D4; 
char byte_200001DC; 
char byte_200001E9; 
char byte_200001EE; 
char byte_200001EF; 
char byte_200001F7; 
unsigned int signal_level;
int dword_20000200; 
int dword_20000204; 
float dword_20000208[];
float dword_2000020C;
__int16 word_2000022C; 
char tmpbuf[];
int dword_20000258[]; 
int dword_2000025C; 
int dword_20000260; 
int dword_20000264[]; 
int dword_20000268; 
int dword_2000026C; 
_BYTE lcd_data[2]; 
_WORD adc_data[512]; 
_WORD adc_data_copy[512]; 
_WORD word_20000AE8[64];
unsigned __int8 digits_1[5];
unsigned __int8 digits[];
unsigned __int8 digits_2[6];
unsigned __int8 digits_3[6];
unsigned __int8 digits_4[6];
int dword_20000B9C; 
int dword_20000BA0; 
int dword_20000BA4; 
int dword_20000BCC; 
int dword_20000BD0; 
int dword_20000BD4; 
int dword_20000BD8; 
int dword_20000BDC; 
int dword_20000BE0; 
int dword_20000BE4; 
int dword_20000BE8; 
int dword_20000BEC; 
int dword_20000BF0; 
int dword_20000BF4; 
int dword_20000BF8; 
char byte_20000BFC; 
int dword_20000C00; 
int dword_20000C04; 
int dword_20000C08; 
int dword_20000C0C; 
__int16 word_20000C10; 
__int16 word_20000C12; 
int dword_20000C18; 
__int16 word_20000C1C; 
char uart_buf[15];
char byte_20000C34[13];
__int16 word_20000C64; 
__int16 word_20000C66; 
int dword_20000C68; 
__int16 word_20000C6C; 
float dword_20000C8C[];
int dword_20000C90; 
float laser2_phase[4][8];
int dword_20000D0C[]; 
float laser1_phase[4][8];
int dword_20000D8C[]; 
float dword_20000DAC[2];
float dword_20000DB4;
float flt_20000EEC[4]; 
_UNKNOWN unk_20000EFC; 
_UNKNOWN unk_20000F60; 



#error "800CCF6: switch analysis failed (funcsize=91)"


void sub_8000120()
{
  ;
}


void sub_8000128()
{
  ;
}


void __fastcall __noreturn sub_800013E(int a1, int a2)
{
  sub_8000128();
  sub_800149C();
}


_BYTE *__fastcall sub_800014C(_BYTE *result, _BYTE *a2, unsigned int a3)
{
  _BYTE *v3; 
  _BYTE *v4; 
  unsigned int i; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  char v10; 

  v3 = result;
  v4 = a2;
  for ( i = a3; i >= 0x10; i -= 16 )
  {
    result = *(_BYTE **)v4;
    v6 = *((_DWORD *)v4 + 1);
    v7 = *((_DWORD *)v4 + 2);
    v8 = *((_DWORD *)v4 + 3);
    v4 += 16;
    *(_DWORD *)v3 = result;
    *((_DWORD *)v3 + 1) = v6;
    *((_DWORD *)v3 + 2) = v7;
    *((_DWORD *)v3 + 3) = v8;
    v3 += 16;
  }
  if ( i >= 8 )
  {
    result = *(_BYTE **)v4;
    v9 = *((_DWORD *)v4 + 1);
    v4 += 8;
    *(_DWORD *)v3 = result;
    *((_DWORD *)v3 + 1) = v9;
    v3 += 8;
    i -= 8;
  }
  if ( i >= 4 )
  {
    result = *(_BYTE **)v4;
    v4 += 4;
    *(_DWORD *)v3 = result;
    v3 += 4;
    i -= 4;
  }
  while ( 1 )
  {
    v10 = i-- >= 1;
    if ( !v10 )
      break;
    *v3++ = *v4++;
  }
  return result;
}


void reset()
{
  system_init();
  j_init_before_main();
}



void *sub_8000198()
{
  return &unk_20000F60;
}


int __fastcall sub_80001BC(unsigned int a1, unsigned int a2)
{
  if ( a1 >> 4 < a2 )
    JUMPOUT(&loc_800021E);
  if ( a1 >> 8 < a2 )
    JUMPOUT(&loc_80001EE);
  JUMPOUT(&loc_800026E);
}


int __fastcall sub_80001D0(unsigned int a1, unsigned int a2)
{
  int v2; 
  char v3; 
  unsigned __int8 v4; 
  int v5; 
  unsigned __int8 v6; 
  int v7; 
  unsigned __int8 v8; 
  int v9; 
  unsigned __int8 v10; 
  unsigned __int8 v11; 
  int v12; 
  unsigned __int8 v13; 
  int v14; 
  unsigned __int8 v15; 
  int result; 
  unsigned int v17; 
  signed int v18; 
  char v19; 
  signed int v20; 
  unsigned int v21; 
  unsigned __int8 v22; 
  int v23; 
  unsigned __int8 v24; 
  int v25; 
  unsigned __int8 v26; 
  int v27; 
  unsigned __int8 v28; 
  unsigned __int8 v29; 
  int v30; 
  unsigned __int8 v31; 
  int v32; 
  unsigned __int8 v33; 
  int v34; 

  if ( ((a1 | a2) & 0x80000000) != 0 )
  {
    v17 = a2 >> 31;
    if ( a2 >> 31 )
      a2 = -a2;
    v18 = (signed int)a1 >> 32;
    if ( __CFSHR__(a1, 32) )
      a1 = -a1;
    v19 = v18 ^ v17;
    v20 = 0;
    v3 = v19;
    if ( a1 >> 4 < a2 )
      goto LABEL_45;
    if ( a1 >> 8 < a2 )
      goto LABEL_36;
    goto LABEL_30;
  }
  v2 = 0;
  if ( a1 >> 1 < a2 )
    return v2 + (a1 >= a2) + v2;
  if ( a1 >> 4 < a2 )
  {
LABEL_15:
    v11 = a1 >> 3 >= a2;
    if ( a1 >> 3 >= a2 )
    {
      v11 = a1 >= 8 * a2;
      a1 -= 8 * a2;
    }
    v12 = v2 + v11 + v2;
    v13 = a1 >> 2 >= a2;
    if ( a1 >> 2 >= a2 )
    {
      v13 = a1 >= 4 * a2;
      a1 -= 4 * a2;
    }
    v14 = v12 + v13 + v12;
    v15 = a1 >> 1 >= a2;
    if ( a1 >> 1 >= a2 )
    {
      v15 = a1 >= 2 * a2;
      a1 -= 2 * a2;
    }
    v2 = v14 + v15 + v14;
    return v2 + (a1 >= a2) + v2;
  }
  if ( a1 >> 8 < a2 )
  {
    v4 = a1 >> 7 >= a2;
    if ( a1 >> 7 >= a2 )
    {
      v4 = a1 >= a2 << 7;
      a1 -= a2 << 7;
    }
    v5 = v4;
    v6 = a1 >> 6 >= a2;
    if ( a1 >> 6 >= a2 )
    {
      v6 = a1 >= a2 << 6;
      a1 -= a2 << 6;
    }
    v7 = v5 + v6 + v5;
    v8 = a1 >> 5 >= a2;
    if ( a1 >> 5 >= a2 )
    {
      v8 = a1 >= 32 * a2;
      a1 -= 32 * a2;
    }
    v9 = v7 + v8 + v7;
    v10 = a1 >> 4 >= a2;
    if ( a1 >> 4 >= a2 )
    {
      v10 = a1 >= 16 * a2;
      a1 -= 16 * a2;
    }
    v2 = v9 + v10 + v9;
    goto LABEL_15;
  }
  v3 = 0;
LABEL_30:
  a2 <<= 6;
  v20 = __rev(0xFCu);
  v21 = a1 >> 8;
  if ( a1 >> 8 >= a2 )
  {
    a2 <<= 6;
    v20 >>= 6;
    if ( v21 >= a2 )
    {
      a2 <<= 6;
      v20 >>= 6;
      if ( v21 >= a2 )
      {
        a2 <<= 6;
        if ( !a2 )
          return 0;
        v20 >>= 6;
      }
    }
  }
  while ( 1 )
  {
LABEL_36:
    v22 = a1 >> 7 >= a2;
    if ( a1 >> 7 >= a2 )
    {
      v22 = a1 >= a2 << 7;
      a1 -= a2 << 7;
    }
    v23 = v20 + v22 + v20;
    v24 = a1 >> 6 >= a2;
    if ( a1 >> 6 >= a2 )
    {
      v24 = a1 >= a2 << 6;
      a1 -= a2 << 6;
    }
    v25 = v23 + v24 + v23;
    v26 = a1 >> 5 >= a2;
    if ( a1 >> 5 >= a2 )
    {
      v26 = a1 >= 32 * a2;
      a1 -= 32 * a2;
    }
    v27 = v25 + v26 + v25;
    v28 = a1 >> 4 >= a2;
    if ( a1 >> 4 >= a2 )
    {
      v28 = a1 >= 16 * a2;
      a1 -= 16 * a2;
    }
    v20 = v27 + v28 + v27;
LABEL_45:
    v29 = a1 >> 3 >= a2;
    if ( a1 >> 3 >= a2 )
    {
      v29 = a1 >= 8 * a2;
      a1 -= 8 * a2;
    }
    v30 = v20 + v29 + v20;
    v31 = a1 >> 2 >= a2;
    if ( a1 >> 2 >= a2 )
    {
      v31 = a1 >= 4 * a2;
      a1 -= 4 * a2;
    }
    v32 = v31 + v30;
    v4 = __CFADD__(v31, v30) | __CFADD__(v30, v32);
    v20 = v30 + v32;
    if ( !v4 )
      break;
    a2 >>= 6;
  }
  v33 = a1 >> 1 >= a2;
  if ( a1 >> 1 >= a2 )
  {
    v33 = a1 >= 2 * a2;
    a1 -= 2 * a2;
  }
  v34 = v20 + v33 + v20 + (a1 >= a2) + v20 + v33 + v20;
  result = v34;
  if ( v3 & 1 )
    result = -v34;
  return result;
}


float __fastcall d2f(double a1)
{
  unsigned int v1; 
  float result; 
  int v3; 
  int v4; 
  unsigned __int64 v5; 
  int v6; 
  int v7; 

  v1 = LODWORD(a1);
  LODWORD(a1) = HIDWORD(a1) >> 31 << 31;
  v3 = HIDWORD(a1) & ~LODWORD(a1);
  if ( 2 * (2 * v3 ^ (unsigned int)v3) >> 22 )
  {
    v4 = v3 - 939524096;
    if ( v4 >= 0x100000 )
    {
      if ( __CFSHL__(v1, 4) && (16 * v1 || ((4 * (v1 & 0x20000000) - 0x40000000) & 0x80000000) == 0) )
      {
        v5 = v1 + __PAIR__(v4, 0x20000000);
        v4 = v5 >> 32;
        v1 = v5;
      }
      if ( (unsigned int)v4 >= 0xFF00000 )
      {
        v6 = 2139095040;
      }
      else
      {
        v6 = 8 * v4 | LODWORD(result);
        LODWORD(result) = v1 >> 29;
      }
      LODWORD(result) |= v6;
    }
  }
  else if ( v3 & 0x100000 )
  {
    v7 = v3 | LODWORD(result);
    if ( v1 | (v7 << 12) )
      result = 5.1042e38/*NaN*/;
    else
      LODWORD(result) = v7 & 0xFF8FFFFF;
  }
  return result;
}


int __fastcall sub_80004B6(__int64 a1, __int64 a2)
{
  unsigned int v2; 
  int v3; 
  unsigned int v4; 
  unsigned int v5; 
  int v6; 
  unsigned __int8 v7; 
  unsigned int v8; 
  signed int v9; 
  char v10; 
  int v11; 
  unsigned int v12; 
  signed int v13; 
  int v14; 
  signed int v15; 
  char v16; 
  unsigned int v17; 
  unsigned int v18; 
  unsigned int v19; 
  signed int v20; 
  unsigned int v21; 
  unsigned int v22; 

  v2 = HIDWORD(a1);
  v3 = (unsigned __int64)(a1 - a2) >> 32;
  HIDWORD(a1) = a1 - a2;
  if ( v2 < HIDWORD(a2) + (unsigned int)((unsigned int)a1 < (unsigned int)a2) )
  {
    v4 = v3 ^ 0x80000000;
    v2 = (__PAIR__(v2, (unsigned int)a1) - __PAIR__(v4, HIDWORD(a1))) >> 32;
    LODWORD(a1) = a1 - HIDWORD(a1);
    a2 += __PAIR__(v4, HIDWORD(a1));
  }
  HIDWORD(a1) = v2 >> 20;
  v5 = (v2 >> 20) - (HIDWORD(a2) >> 20);
  if ( !(~(v2 >> 20) & 0x7FF) )
  {
    v21 = 2 * v2 + ((_DWORD)a1 != 0);
    v22 = 2 * HIDWORD(a2) + ((_DWORD)a2 != 0);
    if ( v21 <= 0xFFE00000 && v22 <= 0xFFE00000 )
    {
      if ( v21 != v22 )
      {
        if ( v21 != -2097152 )
          LODWORD(a1) = a2;
        return a1;
      }
      if ( v2 != HIDWORD(a2) )
        return a1;
    }
    LODWORD(a1) = 0;
    return a1;
  }
  if ( (HIDWORD(a2) >> 20) & 0x7FF )
  {
    v6 = v2 & ~(v2 >> 20 << 20);
    v7 = (unsigned int)a2 <= 0;
    LODWORD(a2) = -(signed int)a2;
    v9 = -1048576 - ((HIDWORD(a2) & 0xFFFFF) + !v7);
    v10 = 32 - v5;
    if ( v5 > 0x20 )
    {
      v14 = 2 * v8;
      v8 = 2 * (v9 + __CFADD__(v8, v8) + v9);
      if ( v14 )
        ++v8;
      v10 = 62 - v5;
      if ( (signed int)(62 - v5) <= 0 )
        return a1;
      v11 = ((v9 >> (v5 - 32)) + __PAIR__((unsigned int)v6, (unsigned int)a1)) >> 32;
      LODWORD(a1) = (v9 >> (v5 - 32)) + a1;
      if ( v11 >= 0 )
        goto LABEL_7;
    }
    else
    {
      v11 = (__PAIR__(((__PAIR__(v6, v8 >> v5) + (unsigned __int64)(unsigned int)a1) >> 32) + (v9 >> v5), v9 << v10)
           + (v8 >> v5)
           + (unsigned int)a1) >> 32;
      LODWORD(a1) = (v9 << v10) + (v8 >> v5) + a1;
      if ( v11 >= 0 )
      {
LABEL_7:
        v12 = v8 << v10;
        if ( (v12 & 0x80000000) == 0 )
          return a1;
        v13 = 1;
        goto LABEL_20;
      }
    }
    v7 = __CFADD__((_DWORD)a1, (_DWORD)a1);
    LODWORD(a1) = 2 * a1;
    v15 = v11 + v7 + v11;
    v16 = v10 + 1;
    v7 = __CFSHL__(v8, v16);
    v12 = v8 << v16;
    if ( v7 )
      LODWORD(a1) = a1 + 1;
    v17 = v15 + (HIDWORD(a1) << 21);
    v7 = __CFSHR__(v17, 21);
    v18 = v17 >> 21;
    if ( v7 )
    {
      if ( v18 )
      {
        v13 = v12 >> 31;
LABEL_20:
        v7 = __CFADD__((_DWORD)a1, v13);
        LODWORD(a1) = a1 + v13;
        if ( !v7 && v12 == 2147483648 )
          LODWORD(a1) = 2 * ((unsigned int)a1 >> 1);
        return a1;
      }
      LODWORD(a1) = ((unsigned int)a1 >> 1) | (v15 << 31);
      HIDWORD(a1) = (v15 >> 1) + (HIDWORD(a1) << 20);
      if ( 2 * HIDWORD(a1) )
      {
        if ( (unsigned int)(2 * HIDWORD(a1)) >= 0x200000 )
          return a1;
      }
      else if ( !(_DWORD)a1 )
      {
        return a1;
      }
LABEL_48:
      LODWORD(a1) = 0;
      return a1;
    }
    v19 = v15 + 0x200000;
    if ( v15 != -2097152 || (_DWORD)a1 )
    {
      HIDWORD(a1) = (HIDWORD(a1) & 0xFFFFF7FF) - 2;
      if ( v15 == -2097152 )
      {
        if ( (unsigned int)a1 >> 16 )
        {
          v19 = (unsigned __int64)(unsigned int)a1 >> 16;
          LODWORD(a1) = (_DWORD)a1 << 16;
          HIDWORD(a1) -= 16;
        }
        else
        {
          v19 = a1;
          LODWORD(a1) = 0;
          HIDWORD(a1) -= 32;
        }
      }
      v20 = 0;
      if ( !(v19 >> 13) )
      {
        v19 <<= 8;
        v20 = 8;
        if ( !(v19 >> 13) )
        {
          v19 *= 32;
          v20 = 13;
        }
      }
      if ( !(v19 >> 17) )
      {
        v19 *= 16;
        v20 += 4;
      }
      if ( !(v19 >> 19) )
      {
        v19 *= 4;
        v20 += 2;
      }
      if ( !(v19 >> 20) )
        ++v20;
      LODWORD(a1) = (_DWORD)a1 << v20;
      if ( HIDWORD(a1) - v20 < 0 )
        goto LABEL_48;
    }
  }
  else if ( !(WORD2(a1) & 0x7FF) )
  {
    LODWORD(a1) = 0;
  }
  return a1;
}


double __cdecl dadd(double a1, double a2)
{
  double result; 

  if ( (HIDWORD(a1) ^ HIDWORD(a2)) >= 0 )
    JUMPOUT(&loc_8000398);
  HIDWORD(a2) ^= 0x80000000;
  LODWORD(result) = sub_80004B6(*(__int64 *)&a1, *(__int64 *)&a2);
  return result;
}


double __fastcall dsub(double a1, double a2)
{
  double result; 

  if ( (HIDWORD(a1) ^ HIDWORD(a2)) < 0 )
    JUMPOUT(&loc_8000398);
  LODWORD(result) = sub_80004B6(*(__int64 *)&a1, *(__int64 *)&a2);
  return result;
}


double __cdecl sub_80006B6(double a1, double a2)
{
  double result; 

  HIDWORD(a1) ^= 0x80000000;
  if ( (HIDWORD(a1) ^ HIDWORD(a2)) >= 0 )
    JUMPOUT(&loc_8000398);
  HIDWORD(a2) ^= 0x80000000;
  LODWORD(result) = sub_80004B6(*(__int64 *)&a1, *(__int64 *)&a2);
  return result;
}


double __fastcall sub_80006E4(double result, double a2)
{
  int v2; 
  int v3; 
  unsigned int v4; 
  char v5; 
  char v6; 
  unsigned int v7; 
  int v8; 
  unsigned int v9; 
  unsigned int v10; 
  int v11; 
  int v12; 
  int v13; 
  int v14; 
  unsigned int v15; 
  unsigned int v16; 
  unsigned int v17; 
  unsigned int v18; 
  unsigned int v19; 
  unsigned __int8 v20; 
  signed __int64 v21; 
  unsigned __int64 v22; 
  unsigned int v23; 
  unsigned int v24; 
  unsigned int v25; 
  signed __int64 v26; 
  signed __int64 v27; 
  int v28; 
  unsigned int v29; 
  unsigned int v30; 
  unsigned int v31; 
  unsigned int v32; 
  signed __int64 v33; 
  unsigned int v34; 
  unsigned int v35; 
  unsigned __int64 v36; 
  unsigned int v37; 
  unsigned int v38; 
  unsigned int v39; 
  unsigned __int64 v40; 
  unsigned int v41; 
  unsigned int v42; 
  unsigned int v43; 
  unsigned int v44; 
  int v45; 
  unsigned __int64 v46; 
  int v47; 
  unsigned int v48; 
  int v49; 
  int v50; 
  int v51; 
  unsigned int v52; 
  unsigned int v53; 
  unsigned __int64 v54; 
  unsigned int v55; 
  unsigned int v56; 
  int v57; 
  int v58; 
  unsigned __int64 v59; 
  unsigned __int64 v60; 
  unsigned int v61; 
  unsigned int v62; 
  int v63; 
  int v64; 
  unsigned __int64 v65; 
  unsigned int v66; 
  unsigned __int64 v67; 
  signed int v68; 
  int v69; 
  int v70; 
  unsigned int v71; 
  int v72; 
  unsigned int v73; 
  int v74; 
  unsigned __int64 v75; 
  unsigned __int64 v76; 
  unsigned __int64 v77; 
  unsigned __int64 v78; 
  unsigned __int64 v79; 
  signed int v80; 
  unsigned int v81; 
  unsigned int v82; 
  __int64 v83; 
  __int64 v84; 
  signed __int64 v85; 
  unsigned __int64 v86; 
  unsigned int v87; 
  unsigned int v88; 
  unsigned int v89; 
  unsigned int v90; 
  unsigned int v91; 
  __int64 v92; 
  unsigned int v93; 
  int v94; 
  unsigned int v95; 
  signed int v96; 
  unsigned int v97; 
  int v98; 

  v98 = LODWORD(a2);
  v2 = (HIDWORD(result) >> 4) & 0x7FF0000;
  v3 = (HIDWORD(a2) >> 4) & 0x7FF0000;
  v4 = HIDWORD(result) ^ HIDWORD(a2);
  v5 = (~v2 & 0x7FF0000) == 0;
  do
  {
    if ( v5 )
    {
      if ( HIDWORD(result) + (unsigned int)(*(_QWORD *)&result >> 31) + ((unsigned int)(2 * LODWORD(result)) > 0) <= 0xFFE00000
        && HIDWORD(a2) + (unsigned int)(*(_QWORD *)&a2 >> 31) + ((unsigned int)(2 * LODWORD(a2)) > 0) <= 0xFFE00000 )
      {
        if ( 2 * HIDWORD(result) != -2097152 )
          goto LABEL_53;
        if ( 2 * HIDWORD(a2) != -2097152 )
        {
          if ( (HIDWORD(a2) ^ HIDWORD(result)) >= 0 )
            HIDWORD(result) = (unsigned int)(2 * HIDWORD(result)) >> 1;
          else
            HIDWORD(result) |= 0x80000000;
          return result;
        }
      }
LABEL_54:
      *(_QWORD *)&result = 9221120237041090560LL;
      return result;
    }
    v5 = (~v3 & 0x7FF0000) == 0;
  }
  while ( !(~v3 & 0x7FF0000) );
  v6 = v3 == 0;
  while ( !v6 )
  {
    v6 = v2 == 0;
    if ( v2 )
    {
      v96 = ((v4 >> 31) | v2) - v3 + 66846720;
      v7 = LODWORD(result) << 11;
      v8 = *(_QWORD *)&result >> 11;
      v9 = (*(_QWORD *)&a2 >> 21) | 0x80000000;
      v10 = v9 >> 16;
      v81 = v8 | 0x80000000;
      v11 = LODWORD(a2) << 11 >> 16;
      HIDWORD(a2) = v9 & ~(v9 >> 16 << 16);
      v97 = v9 >> 16 << 16;
      v13 = (LODWORD(a2) << 11) & ~(v11 << 16);
      v14 = byte_800FBB4[(v9 >> 24) - 128];
      v15 = (v14 * (0x800000 - ((v9 >> 16) * v14 + v14)) >> 19) + 2;
      v91 = (((0x20000000 - ((v9 >> 13) * v15 + v15)) >> 16) * v15
           + (((0x20000000 - ((v9 >> 13) * v15 + v15)) & ~((0x20000000 - ((v9 >> 13) * v15 + v15)) >> 16 << 16)) * v15 >> 16)) >> 6;
      v16 = v7 << 31;
      if ( v7 << 31 )
        v16 = 2147483648;
      v17 = v16;
      v18 = v91 * (v81 >> 16) >> 16;
      v76 = __PAIR__(v81 >> 1, (v7 >> 1) | (v81 << 31)) - __PAIR__(v18 * v10, v18 * v11);
      LODWORD(v83) = (v18 * v13 >> 16) | (v18 * v12 << 16);
      HIDWORD(v83) = (unsigned __int64)(v18 * v12) >> 16;
      v19 = v18 * v13 << 16;
      v20 = v17 >= v19;
      v87 = v17 - v19;
      if ( !v20 )
      {
        v21 = v83 + 1;
        HIDWORD(v83) = (unsigned __int64)(v83 + 1) >> 32;
        LODWORD(v83) = v21;
      }
      v22 = v76 - v83;
      v23 = v18 << 16;
      LODWORD(v76) = v76 - v83;
      v93 = v23;
      HIDWORD(v76) = HIDWORD(v22);
      v24 = v91 * (HIDWORD(v22) >> 2) >> 16;
      HIDWORD(v84) = (unsigned __int64)(v24 * v10) >> 13;
      LODWORD(v84) = (v11 * v24 >> 13) | (v24 * v10 << 19);
      v25 = v11 * v24 << 19;
      v20 = v87 >= v25;
      v88 = v87 - v25;
      if ( !v20 )
      {
        v26 = v84 + 1;
        HIDWORD(v84) = (unsigned __int64)(v84 + 1) >> 32;
        LODWORD(v84) = v26;
      }
      v77 = v76 - v84;
      HIDWORD(v27) = (unsigned __int64)(v24 * v12) >> 29;
      LODWORD(v27) = (v24 * v13 >> 29) | 8 * v24 * v12;
      v85 = v27;
      v20 = v88 >= 8 * v24 * v13;
      v89 = v88 - 8 * v24 * v13;
      if ( !v20 )
        v85 = v27 + 1;
      v28 = (((_DWORD)v77 - (_DWORD)v85) << 26) | (v89 >> 6);
      v29 = v89 << 26;
      v94 = v93 + 8 * v24;
      v30 = v91 * ((unsigned int)((signed __int64)(v77 - v85) >> 26) >> 15) >> 16;
      v31 = v91 * ((unsigned int)((signed __int64)(v77 - v85) >> 26) >> 15) >> 16;
      v78 = __PAIR__((v77 - v85) >> 26, v28) - __PAIR__(v30 * v10, v30 * v11);
      v86 = (v30 * v13 >> 16) | ((unsigned __int64)(v30 * v12) << 16);
      v32 = v30 * v13 << 16;
      v20 = v29 >= v32;
      v90 = v29 - v32;
      if ( !v20 )
      {
        v33 = v86 + 1;
        HIDWORD(v86) = (v86 + 1) >> 32;
        LODWORD(v86) = v33;
      }
      LODWORD(v92) = v31 << 22;
      v79 = v78 - v86;
      HIDWORD(v92) = v94 + (v31 >> 10);
      v34 = v91 * (HIDWORD(v79) >> 2) >> 16;
      v36 = (unsigned __int64)(v34 * v10) << 19;
      v35 = (unsigned __int64)(v34 * v10) >> 13;
      v37 = (v34 * v11 >> 13) | v36;
      v38 = v34 * v11 << 19;
      v39 = v90 - v38;
      if ( v90 < v38 )
      {
        v40 = v37 + __PAIR__(v35, 1);
        v35 = HIDWORD(v40);
        v37 = v40;
      }
      v41 = v79 - v37;
      v82 = (v79 - __PAIR__(v35, v37)) >> 32;
      v42 = (unsigned __int64)(v34 * v12) >> 29;
      v43 = (v34 * v13 >> 29) | 8 * v34 * v12;
      v44 = 8 * v34 * v13;
      v20 = v39 >= v44;
      v45 = v39 - v44;
      if ( !v20 )
      {
        v46 = __PAIR__(v42, v43) + 1;
        v42 = (__PAIR__(v42, v43) + 1) >> 32;
        v43 = v46;
      }
      v47 = (signed __int64)(__PAIR__(v82, v41) - __PAIR__(v42, v43)) >> 6;
      v49 = ((v41 - v43) << 26) | ((unsigned __int64)(unsigned int)v45 >> 6);
      v48 = v92 + (v34 << 9);
      v95 = (v92 + (unsigned __int64)(v34 << 9)) >> 32;
      v50 = v97 | v12;
      v80 = 0;
      v51 = ((unsigned int)(v98 << 11) >> 16 << 16) | v13;
      v52 = v47 + __CFADD__(v49, v49) + v47;
      v53 = ((unsigned __int64)(unsigned int)(v45 << 26) >> 31) | 2 * v49;
      v54 = __PAIR__(v52, v53) - __PAIR__(v50, v51);
      if ( v52 > (__PAIR__(v52, v53) - __PAIR__(v50, v51)) >> 32 )
      {
        v80 = 1;
        v52 = (__PAIR__(v52, v53) - __PAIR__(v50, v51)) >> 32;
        v53 = v54;
      }
      v55 = v52 >> 31;
      v56 = v52 + __CFADD__(v53, v53) + v52;
      v57 = ((unsigned int)(v45 << 27) >> 31) | 2 * v53;
      v58 = 2 * v80;
      v59 = __PAIR__(v56, v57) - __PAIR__(v50, v51);
      if ( v55 || v56 > HIDWORD(v59) )
      {
        ++v58;
        v60 = __PAIR__(v56, v57) - __PAIR__(v50, v51);
        v56 = v60 >> 32;
        v57 = v60;
      }
      v61 = v56 >> 31;
      v62 = v56 + __CFADD__(v57, v57) + v56;
      v63 = ((unsigned int)(v45 << 28) >> 31) | 2 * v57;
      v64 = 2 * v58;
      v65 = __PAIR__(v62, v63) - __PAIR__(v50, v51);
      if ( v61 || v62 > HIDWORD(v65) )
      {
        ++v64;
        v62 = (__PAIR__(v62, v63) - __PAIR__(v50, v51)) >> 32;
        v63 = v65;
      }
      if ( v62 | v63 )
        v48 |= 1u;
      LODWORD(result) = 0;
      v67 = __PAIR__(v95, v64 << 9) + v48;
      v66 = (__PAIR__(v95, v64 << 9) + v48) >> 32;
      HIDWORD(result) = v67;
      v68 = 2;
      if ( (v66 & 0x80000000) == 0 )
      {
        HIDWORD(result) = 2 * v67;
        v68 = 1;
        v66 += __CFADD__((_DWORD)v67, (_DWORD)v67) + v66;
      }
      v69 = v68 + (v96 >> 16);
      v70 = HIDWORD(result) << 21;
      v71 = v66 << 21;
      v72 = (v66 >> 11) + (v69 << 20);
      v73 = ((unsigned __int64)HIDWORD(result) >> 11) | v71;
      HIDWORD(result) = (v96 << 31) ^ v72;
      if ( v70 )
      {
        v20 = __CFSHL__(v70, 1);
        v74 = 2 * v70;
        if ( v20 )
        {
          v75 = __PAIR__(HIDWORD(result), v73) + 1;
          HIDWORD(result) = (__PAIR__(HIDWORD(result), v73) + 1) >> 32;
          v73 = v75;
          if ( !v74 )
            v73 = 2 * ((unsigned int)v75 >> 1);
        }
      }
      if ( v72 >= 0 && v72 & 0x7FF00000 && ~v72 & 0x7FF00000 )
      {
        LODWORD(result) = v73;
      }
      else if ( v96 > 0x4000000 )
      {
        HIDWORD(result) = ((HIDWORD(result) - 1610612736) | 0x7FFFFFFF) ^ 0xFFFFF;
      }
      else
      {
        HIDWORD(result) = (unsigned int)(HIDWORD(result) + 1610612736) >> 31 << 31;
      }
      return result;
    }
  }
  if ( HIDWORD(result) & 0x7FF00000 )
  {
    HIDWORD(result) = (v4 | 0x7FFFFFFF) ^ 0xFFFFF;
    goto LABEL_57;
  }
  if ( !(HIDWORD(a2) & 0x7FF00000) )
    goto LABEL_54;
LABEL_53:
  HIDWORD(result) = v4 >> 31 << 31;
LABEL_57:
  LODWORD(result) = 0;
  return result;
}


signed int __fastcall sub_8000B30(signed __int64 a1)
{
  int v1; 
  unsigned int v2; 
  int v3; 
  int v4; 
  signed int result; 
  int v6; 
  int v7; 

  v1 = a1;
  LODWORD(a1) = a1 >> 21;
  v3 = SHIDWORD(a1) >> 20;
  if ( !(SHIDWORD(a1) >> 20) || (v2 |= 0x80000000, v3 >= 0) )
  {
    v4 = 1054 - v3;
    if ( v4 > 0 )
    {
      result = v2 >> v4;
      if ( v4 <= 255 )
        return result;
      return 0;
    }
    goto LABEL_13;
  }
  v6 = (SHIDWORD(a1) >> 20) & 0x7FF;
  if ( !v6 )
    v2 = 2 * v2 >> 1;
  v7 = 1054 - v6;
  if ( v7 < 0 )
    goto LABEL_13;
  result = -(v2 >> v7);
  if ( v7 > 255 )
    return 0;
  if ( result > 0 )
  {
LABEL_13:
    if ( 2 * HIDWORD(a1) + (unsigned int)(v1 != 0) <= 0xFFE00000 )
      return ~(SHIDWORD(a1) >> 31) ^ 0x80000000;
    return 0;
  }
  return result;
}


int __fastcall double2uint(double a1)
{
  unsigned int v1; 
  int v2; 
  int v3; 
  int result; 

  v1 = *(_QWORD *)&a1 >> 21;
  v2 = SHIDWORD(a1) >> 20;
  if ( !(SHIDWORD(a1) >> 20) || (v1 |= 0x80000000, v2 >= 0) )
  {
    v3 = 1054 - v2;
    if ( v3 < 0 )
    {
      if ( 2 * HIDWORD(a1) + (unsigned int)(LODWORD(a1) != 0) <= 0xFFE00000 )
        return ~(SHIDWORD(a1) >> 31);
    }
    else
    {
      result = v1 >> v3;
      if ( v3 <= 255 )
        return result;
    }
  }
  return 0;
}


double __fastcall ui2double(unsigned int a1)
{
  signed int v1; 
  double result; 
  unsigned int v3; 

  v3 = a1 >> 31 << 31;
  if ( a1 >> 31 << 31 )
    a1 = -a1;
  v1 = a1 << 8;
  HIDWORD(result) = (v1 >> 11) + (v3 | 0x40000000) + 24117248;
  LODWORD(result) <<= 21;
  return result;
}


double __fastcall uint2double(unsigned __int16 a1)
{
  JUMPOUT(&loc_8000BE4);
}


double __cdecl sub_8000C3C(double a1)
{
  unsigned __int64 v1; 
  signed int v2; 
  unsigned int v3; 
  char v4; 
  int v5; 
  char v6; 
  unsigned int v7; 
  unsigned int v8; 
  int v9; 
  unsigned int v10; 
  int v11; 
  unsigned int v12; 
  int v13; 
  int v14; 
  int v15; 
  int v16; 
  unsigned int v17; 
  int v18; 
  int v19; 
  int v20; 
  unsigned int v21; 
  int v22; 
  int v23; 
  int v24; 
  int v25; 
  int v26; 
  __int64 v27; 
  __int64 v28; 
  __int64 v29; 
  unsigned __int64 v30; 
  int v31; 
  int v32; 
  unsigned __int64 v33; 
  unsigned int v34; 
  unsigned __int64 v35; 
  unsigned __int64 v36; 
  char v37; 
  signed int v38; 
  char v39; 
  int v40; 
  int v41; 
  unsigned __int8 v42; 
  int v43; 
  double result; 
  int v45; 
  int v46; 
  unsigned int v47; 
  int v48; 
  int v49; 
  int v50; 
  signed int v51; 
  int v52; 
  int v53; 

  v2 = 134152192;
  v3 = HIDWORD(a1) ^ HIDWORD(v1);
  v4 = (~(HIDWORD(a1) >> 4) & 0x7FF0000) == 0;
  do
  {
    if ( v4 )
    {
      if ( HIDWORD(a1) + (unsigned int)(*(_QWORD *)&a1 >> 31) + ((unsigned int)(2 * LODWORD(a1)) > 0) > 0xFFE00000
        || HIDWORD(v1) + (unsigned int)(v1 >> 31) + ((unsigned int)(2 * v1) > 0) > 0xFFE00000
        || (unsigned int)(2 * HIDWORD(a1)) < 0x200000
        || (unsigned int)(2 * HIDWORD(v1)) < 0x200000 )
      {
        result = 2.6965397e308/*NaN*/;
      }
      else
      {
        LODWORD(result) = 0;
        HIDWORD(result) = (v3 >> 31 << 31) | 0x7FF00000;
      }
      return result;
    }
    v4 = (~(HIDWORD(v1) >> 4) & 0x7FF0000) == 0;
  }
  while ( !(~(HIDWORD(v1) >> 4) & 0x7FF0000) );
  v5 = (v3 >> 31) | (HIDWORD(a1) >> 4) & 0x7FF0000;
  v6 = ((HIDWORD(v1) >> 4) & 0x7FF0000) == 0;
  do
  {
    if ( v6 )
    {
      LODWORD(result) = 0;
      HIDWORD(result) = v5 << 31;
      return result;
    }
    v2 *= 16;
    v6 = (HIDWORD(a1) & v2) == 0;
  }
  while ( !(HIDWORD(a1) & v2) );
  v51 = ((HIDWORD(v1) >> 4) & 0x7FF0000) + v5 - 66846720;
  v7 = 16 * (HIDWORD(a1) & 0x1FFFFF | 0x100000) | (LODWORD(a1) >> 28);
  v8 = 16 * (HIDWORD(v1) & 0x1FFFFF | 0x100000) | ((unsigned int)v1 >> 28);
  HIDWORD(a1) = v7 >> 14;
  v10 = LODWORD(a1) & 0xFFFFFFF;
  v11 = v7 & ~(v7 >> 14 << 14);
  v12 = (LODWORD(a1) & 0xFFFFFFFu) >> 14;
  v13 = v10 & ~(v10 >> 14 << 14);
  HIDWORD(v1) = v8 >> 14;
  v15 = v1 & 0xFFFFFFF;
  v16 = v8 & ~(v8 >> 14 << 14);
  v17 = (v1 & 0xFFFFFFF) >> 14;
  v49 = v15 & ~(v17 << 14);
  v53 = v12 + v13;
  v52 = v17 + v49;
  v45 = 16 * v13 * v49;
  v47 = (v12 + v13) * (v17 + v49) - v12 * v17 - v13 * v49;
  v18 = (v47 >> 14) + v12 * v17;
  if ( __CFADD__(v45, v47 << 18) )
    ++v18;
  v19 = 2 * v18;
  if ( v45 + (v47 << 18) )
    v19 |= 1u;
  v20 = v11 * v49;
  v21 = 2 * v13 * v16 + 2 * v11 * v49 + v19;
  v50 = v9 + v11;
  v22 = v12 * v14;
  v23 = v17 * v9;
  v46 = v52 * (v9 + v11) - v20 - v17 * v9;
  v48 = v53 * (v14 + v16) - v13 * v16 - v22;
  if ( v21 << 27 )
    v24 = (v21 >> 5) | 1;
  else
    v24 = v21 >> 5;
  v25 = (((unsigned __int64)(unsigned int)v22 << 24) + (unsigned int)v24) >> 32;
  v26 = (v22 << 24) + v24;
  v27 = (unsigned int)((v23 << 24) + v26);
  v30 = ((unsigned __int64)(unsigned int)v46 << 10)
      + ((unsigned __int64)(unsigned int)v48 << 10)
      + __PAIR__(
          v25 + __CFADD__(v23 << 24, v26) + (unsigned int)((unsigned __int64)(unsigned int)v23 >> 8),
          (unsigned int)v27);
  LODWORD(v29) = v30 >> 32;
  LODWORD(v28) = v30;
  v31 = v9 * v14;
  v32 = v11 * v16;
  v33 = (unsigned __int64)(unsigned int)(v50 * (v14 + v16) - v31 - v32) << 6;
  HIDWORD(v29) = (unsigned __int64)(unsigned int)(v50 * (v14 + v16) - v31 - v32) >> 26;
  LODWORD(v27) = v33;
  v35 = ((unsigned __int64)(unsigned int)v31 << 20) + v27 + v29;
  v34 = v35 >> 32;
  HIDWORD(v28) = v35;
  v36 = ((unsigned __int64)(unsigned int)v32 << 24) + v28;
  if ( HIDWORD(v36) < (unsigned int)v35 )
    ++v34;
  if ( v34 < 0x200 )
  {
    v37 = 20;
    v38 = -4;
  }
  else
  {
    v37 = 21;
    v38 = -3;
  }
  v39 = 32 - v37;
  v40 = ((HIDWORD(v36) >> v37) | (v34 << (32 - v37))) + ((v38 + (v51 >> 16)) << 20);
  LODWORD(result) = ((unsigned int)v36 >> v37) | (HIDWORD(v36) << (32 - v37));
  HIDWORD(result) = (v51 << 31) ^ v40;
  v41 = (_DWORD)v36 << v39;
  if ( (_DWORD)v36 << v39 )
  {
    v42 = __CFSHL__(v41, 1);
    v43 = 2 * v41;
    if ( v42 )
    {
      ++*(_QWORD *)&result;
      if ( !v43 )
        LODWORD(result) = 2 * (LODWORD(result) >> 1);
    }
  }
  if ( v40 < 0 || !(v40 & 0x7FF00000) || !(~HIDWORD(result) & 0x7FF00000) )
  {
    if ( v51 < 0x4000000 )
      HIDWORD(result) = (unsigned int)(HIDWORD(result) + 1610612736) >> 31 << 31;
    else
      HIDWORD(result) = ((HIDWORD(result) - 1610612736) | 0x7FFFFFFF) ^ 0xFFFFF;
    LODWORD(result) = 0;
  }
  return result;
}


double __fastcall f2d(float a1)
{
  int v1; 
  double result; 

  v1 = 2 * LODWORD(a1);
  if ( !((unsigned int)(2 * LODWORD(a1) + 0x1000000) >> 25) )
  {
    if ( (LODWORD(a1) + 0x800000) & 0x800000 )
    {
      *((float *)&result + 1) = a1;
      if ( v1 )
      {
        HIDWORD(result) = LODWORD(a1) >> 31 << 31;
        LODWORD(result) = 0;
        return result;
      }
    }
    else
    {
      v1 = LODWORD(a1) << 9;
      if ( LODWORD(a1) << 9 )
        return 2.6965397e308/*NaN*/;
      HIDWORD(result) = LODWORD(a1) | 0x700000;
    }
    LODWORD(result) = v1;
    return result;
  }
  HIDWORD(result) = (SLODWORD(a1) >> 3) + 939524096;
  LODWORD(result) = LODWORD(a1) << 29;
  if ( HIDWORD(result) - 939524096 < 0 )
    HIDWORD(result) -= 1879048192;
  return result;
}


float __fastcall fdiv(float a1, float a2)
{
  unsigned int v2; 
  unsigned int v3; 
  int v4; 
  unsigned int v5; 
  unsigned int v6; 
  signed int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  unsigned int v12; 
  unsigned int v13; 
  unsigned int v14; 
  unsigned int v15; 
  int v16; 
  unsigned int v17; 
  float result; 
  int v19; 
  unsigned __int8 v20; 
  int v21; 
  unsigned int v22; 
  unsigned int v23; 

  v2 = (LODWORD(a1) >> 7) & 0xFF0000;
  v3 = (LODWORD(a2) >> 7) & 0xFF0000;
  v4 = LODWORD(a1) ^ LODWORD(a2);
  if ( !v2 || !v3 || v2 == 16711680 || v3 == 16711680 )
  {
    if ( v4 < 0 )
      v2 = (LODWORD(a1) >> 7) & 0xFF0000 | 0x100;
    if ( v2 >= 0xFF0000 || v3 >= 0xFF0000 )
    {
      if ( (unsigned int)(2 * LODWORD(a1)) <= 0xFF000000 )
      {
        v22 = 2 * LODWORD(a2);
        if ( v22 <= 0xFF000000 && (2 * LODWORD(a1) != -16777216 || v22 != -16777216) )
        {
          if ( v22 == -16777216 )
            v23 = 0;
          else
            v23 = (unsigned int)(2 * LODWORD(a1)) >> 1;
          LODWORD(result) = (v2 << 23) | v23;
          return result;
        }
      }
    }
    else
    {
      if ( v3 << 8 >> 24 )
      {
        LODWORD(result) = (unsigned int)v4 >> 31 << 31;
        return result;
      }
      if ( v2 << 8 >> 24 )
      {
        LODWORD(result) = (v2 | 0xFF) << 23;
        return result;
      }
    }
    return 5.1042e38/*NaN*/;
  }
  if ( v4 < 0 )
    v2 = (LODWORD(a1) >> 7) & 0xFF0000 | 0x100;
  v5 = (LODWORD(a2) | 0x800000) & 0xFFFFFF;
  v6 = (LODWORD(a1) | 0x800000) & 0xFFFFFF;
  v7 = v2 - v3 + 8192000;
  v8 = 2 * *((_BYTE *)dword_800FC34 + 127 - (v5 >> 17));
  v9 = (v7 >> 16) + v7;
  if ( v6 < v5 )
    v6 *= 2;
  else
    ++v9;
  v10 = -v5;
  v11 = ((v10 * v8 >> 4) * v8 >> 21) + (v8 << 7);
  v12 = v6 << 11;
  v13 = (v6 >> 8) * v11 >> 20;
  v14 = v10 * v13 + v12;
  v15 = (v14 >> 8) * v11;
  v16 = (v13 << 12) + (v15 >> 19);
  v17 = v10 * (v15 >> 19) + (v14 << 12);
  if ( v17 >= -v10 )
  {
    v17 += v10;
    ++v16;
  }
  LODWORD(result) = (v9 << 23) + v16;
  if ( v17 )
  {
    v19 = 2 * v17;
    v20 = __CFADD__(v10, v19);
    v21 = v10 + v19;
    if ( v20 )
    {
      ++LODWORD(result);
      if ( !v21 )
        LODWORD(result) = 2 * (LODWORD(result) >> 1);
    }
  }
  if ( (unsigned int)v9 >= 0xFC0000 )
  {
    if ( v9 > 0 )
    {
      if ( (unsigned int)(2 * LODWORD(result) + 0x1000000) < 0xFE000000 )
      {
        if ( LODWORD(result) - 1610612736 >= 0 )
          result = 3.4028e38/*+Inf*/;
        else
          result = -3.4028e38/*-Inf*/;
      }
    }
    else if ( (unsigned int)(v9 << 24) >> 28 )
    {
      LODWORD(result) = (unsigned int)(LODWORD(result) + 1610612736) >> 31 << 31;
    }
  }
  return result;
}



int __fastcall sub_800104C(float a1)
{
  float v1; 
  unsigned int v2; 
  int v3; 
  int v4; 
  int result; 
  int v6; 

  v1 = a1;
  v2 = LODWORD(a1) << 8;
  v3 = SLODWORD(v1) >> 23;
  if ( !(SLODWORD(v1) >> 23) || (v2 |= 0x80000000, v3 >= 0) )
  {
    v4 = 158 - v3;
    if ( v4 > 0 )
      return v2 >> v4;
    goto LABEL_10;
  }
  v3 = (unsigned __int8)v3;
  if ( !(_BYTE)v3 )
    v2 = 2 * v2 >> 1;
  v6 = 158 - v3;
  if ( v6 < 0 || (result = -(v2 >> v6), result > 0) )
  {
LABEL_10:
    if ( (unsigned int)(2 * LODWORD(v1)) <= 0xFF000000 )
      result = ~(SLODWORD(v1) >> 31) ^ 0x80000000;
    else
      result = 0;
  }
  return result;
}


int __fastcall sub_8001098(float a1)
{
  float v1; 
  unsigned int v2; 
  int v3; 
  int v4; 
  int result; 

  v1 = a1;
  v2 = LODWORD(a1) << 8;
  v3 = SLODWORD(v1) >> 23;
  if ( SLODWORD(v1) >> 23 )
  {
    v2 |= 0x80000000;
    if ( v3 < 0 )
      goto LABEL_10;
  }
  v4 = 158 - v3;
  if ( v4 >= 0 )
    return v2 >> v4;
  if ( (unsigned int)(2 * LODWORD(v1)) > 0xFF000000 )
LABEL_10:
    result = 0;
  else
    result = ~(SLODWORD(v1) >> 31);
  return result;
}


float __fastcall i2f(float result)
{
  signed int v1; 
  unsigned int v2; 
  unsigned __int8 v3; 
  int v4; 

  v1 = 31;
  if ( LODWORD(result) >> 16 || (v1 = 15, LODWORD(result) <<= 16, result != 0.0) )
  {
    if ( !(LODWORD(result) >> 24) )
    {
      v1 -= 8;
      LODWORD(result) <<= 8;
    }
    if ( !(LODWORD(result) >> 28) )
    {
      v1 -= 4;
      LODWORD(result) *= 16;
    }
    if ( !(LODWORD(result) >> 30) )
    {
      v1 -= 2;
      LODWORD(result) *= 4;
    }
    if ( SLODWORD(result) >= 0 )
    {
      --v1;
      LODWORD(result) *= 2;
    }
    v2 = (SLODWORD(result) >> 8) + (v1 << 23) + 0x40000000;
    v3 = __CFSHL__(LODWORD(result), 25);
    v4 = LODWORD(result) << 25;
    if ( v3 )
    {
      ++v2;
      if ( !v4 )
        v2 = 2 * (v2 >> 1);
    }
    result = *(float *)&v2;
  }
  return result;
}


_DWORD *__fastcall sub_8001130(int a1)
{
  int v1; 
  _DWORD *result; 

  v1 = a1;
  result = sub_8001390();
  *result = v1;
  return result;
}


unsigned int __fastcall sub_800113C(unsigned int a1, unsigned int a2, unsigned int a3, unsigned int a4, int a5)
{
  unsigned int result; 

  if ( 2 * a2 <= 0xFFE00000 && (2 * a2 != 0xFFE00000 || !a1) && 2 * a4 <= 0xFFE00000 && (2 * a4 != 0xFFE00000 || !a3) )
  {
    if ( ((a2 | a4) & 0x80000000) == 0 )
      return __get_CPSR();
    if ( a4 == a2 )
    {
      if ( a3 >= a1 )
      {
        result = __get_CPSR() & 0x6FFFFFFF;
        goto LABEL_17;
      }
      result = __get_CPSR() & 0x6FFFFFFF;
    }
    else
    {
      result = __get_CPSR() & 0x6FFFFFFF;
      if ( a4 >= a2 )
      {
LABEL_17:
        __asm { MSR.W   CPSR_f, R0 }
        return result;
      }
    }
    result |= 0x80000000;
    goto LABEL_17;
  }
  if ( a5 & 0xD0000 )
    result = sub_8001398(0, a5);
  else
    result = sub_80013C8(a1, a2, a3, a4, a5);
  return result;
}


int __fastcall sub_80011CC(int a1, int a2, int a3)
{
  int v3; 
  unsigned int v4; 
  int v5; 
  int result; 

  v3 = a1;
  v4 = (unsigned int)(2 * a2) >> 21;
  v5 = 2047;
  result = 0;
  if ( v4 && (v5 = v4 ^ 0x7FF) != 0 && a3 < v5 && a3 > (signed int)-v4 )
  {
    result = v3;
  }
  else if ( v4 && !v5 )
  {
    if ( v3 | (a2 << 12) )
      result = 0;
    else
      result = v3;
  }
  return result;
}


unsigned int __fastcall sub_8001228(unsigned int a1, unsigned int a2)
{
  unsigned int v2; 
  int v3; 
  unsigned int result; 
  unsigned int v5; 
  int v6; 
  unsigned __int8 v7; 
  int v8; 
  signed int v9; 
  unsigned int v10; 
  unsigned __int64 v11; 
  unsigned int v12; 
  int v13; 
  int v14; 
  __int64 v15; 
  int v16; 
  unsigned int v17; 
  unsigned __int64 v18; 
  unsigned int v19; 
  unsigned int v20; 

  v2 = a1;
  v3 = a1 | (a2 << 12);
  result = 0;
  if ( !(a2 & 0x7FF00000) )
  {
    if ( v3 )
      return result;
    return v2;
  }
  if ( !(~a2 & 0x7FF00000) )
  {
    if ( v3 || (a2 & 0x80000000) != 0 )
      return 0;
    return v2;
  }
  if ( (a2 & 0x80000000) != 0 )
    return 0;
  v5 = a2 >> 20;
  v6 = a2 & ~(a2 >> 20 << 20) | 0x100000;
  if ( ((_BYTE)v5 - 3) & 1 )
  {
    v7 = __CFADD__(v2, v2);
    v2 *= 2;
    v6 += v7 + v6;
  }
  v8 = (v6 << 10) | (v2 >> 22);
  v9 = 0x40000000;
  LODWORD(v11) = v2 << 10;
  v10 = 0;
  HIDWORD(v11) -= 0x40000000;
  v12 = 0x10000000;
  do
  {
    if ( HIDWORD(v11) - v9 >= 0 && ((HIDWORD(v11) - v9 - v12) & 0x80000000) == 0 )
    {
      HIDWORD(v11) = HIDWORD(v11) - v9 - v12;
      v9 += 2 * v12;
    }
    v13 = v11 >> 31;
    LODWORD(v11) = 2 * v11;
    HIDWORD(v11) += v13;
    v12 >>= 1;
  }
  while ( v12 );
  if ( HIDWORD(v11) - v9 >= 0 )
  {
    v14 = __CFADD__((_DWORD)v11, 2147483648) + HIDWORD(v11) - v9 - 1;
    if ( v14 >= 0 )
    {
      LODWORD(v11) = v11 + 2147483648;
      HIDWORD(v11) = v14;
      ++v9;
    }
  }
  LODWORD(v15) = 2 * v11;
  v16 = HIDWORD(v11) + (v11 >> 31);
  v17 = 0x40000000;
  do
  {
    HIDWORD(v15) = v16;
    if ( (((v15 - __PAIR__((unsigned int)v9, v10)) >> 32) & 0x80000000) == 0LL )
    {
      v18 = v15 - __PAIR__(v9, v10) - v17;
      if ( SHIDWORD(v18) >= 0 )
      {
        v16 = HIDWORD(v18);
        LODWORD(v15) = v18;
        v10 += 2 * v17;
      }
    }
    v7 = __CFADD__((_DWORD)v15, (_DWORD)v15);
    LODWORD(v15) = 2 * v15;
    v16 += v7 + v16;
    v17 >>= 1;
  }
  while ( v17 != 128 );
  v19 = v16 | v15;
  if ( v19 )
    v19 = 2;
  if ( __CFSHR__(v10, 10) )
    v19 |= 1u;
  result = (v10 >> 10) | (v9 << 22);
  if ( v19 )
  {
    v7 = v19 & 1;
    v20 = v19 >> 1;
    if ( v7 )
      ++result;
    if ( !v20 )
      result = 2 * (result >> 1);
  }
  return result;
}


unsigned int __fastcall sub_800132C(unsigned int a1, unsigned int a2, int a3)
{
  unsigned int result; 

  if ( 2 * a1 > 0xFF000000 || 2 * a2 > 0xFF000000 )
  {
    if ( a3 & 0xD0000 )
      result = sub_8001398(0, a3);
    else
      result = sub_80013DC(a1, a2, a3);
  }
  else if ( ((a1 | a2) & 0x80000000) != 0 )
  {
    if ( a2 >= a1 )
      result = __get_CPSR() & 0x6FFFFFFF;
    else
      result = __get_CPSR() & 0x6FFFFFFF | 0x80000000;
    __asm { MSR.W   CPSR_f, R0 }
  }
  else
  {
    result = __get_CPSR();
  }
  return result;
}


void *sub_8001390()
{
  return &unk_20000EFC;
}


unsigned int __fastcall sub_8001398(int a1, int a2)
{
  unsigned int result; 

  if ( a2 & 0x100000 )
  {
    if ( (unsigned int)(a2 << 13) >> 29 )
    {
      result = 2 * ~(a2 << 15);
    }
    else
    {
      result = __get_CPSR() & 0xFFFFFFF | 0x30000000;
      __asm { MSR.W   CPSR_f, R0 }
    }
  }
  else
  {
    result = 0;
  }
  return result;
}


unsigned int __fastcall sub_80013C8(int a1, int a2, int a3, int a4, int a5)
{
  return sub_800143E(0, 0x7FF80000u, a5);
}


unsigned int __fastcall sub_80013DC(int a1, unsigned int a2, char a3)
{
  return sub_800143E(0x7FC00000u, a2, a3);
}


void *sub_80013EC()
{
  return &unk_20000EFC;
}


#error "800140C: positive sp value has been found (funcsize=0)"


unsigned int __fastcall sub_800143E(unsigned int result, unsigned int a2, char a3)
{
  unsigned int v3; 
  int v4; 
  int v5; 
  int v6; 

  v3 = a2;
  v4 = a3 & 0xF;
  if ( v4 == 9 )
    return sub_8001398(8, a3);
  if ( v4 == 10 )
  {
    if ( !(a3 & 0x40) )
      return result;
    return 2147483648;
  }
  if ( v4 != 8 )
    return result;
  if ( a3 & 0x40 )
    return 2147483648;
  if ( a3 & 0x10 )
  {
    v5 = result << 29;
  }
  else
  {
    v6 = __ROR4__((result >> 29 << 29) | v3 & 0xFFFFFF, 29);
    v5 = v6 | (v3 >> 24 << 24);
  }
  return v5;
}


void sub_800149C()
{
  __breakpoint(171);
  while ( 1 )
    ;
}


int __fastcall sub_80014AA(char *a1, _BYTE *a2, int a3)
{
  _BYTE *v3; 
  unsigned int v4; 
  int v5; 
  unsigned int v6; 
  char v7; 

  v3 = &a2[a3];
  do
  {
    v4 = (unsigned __int8)*a1++;
    v5 = v4 & 0xF;
    if ( !(v4 & 0xF) )
      v5 = (unsigned __int8)*a1++;
    v6 = v4 >> 4;
    if ( !v6 )
      v6 = (unsigned __int8)*a1++;
    while ( --v5 )
    {
      v7 = *a1++;
      *a2++ = v7;
    }
    while ( --v6 )
      *a2++ = 0;
  }
  while ( a2 < v3 );
  return 0;
}


int __fastcall sub_80014E4(int result, int a2)
{
  if ( a2 )
    *(_DWORD *)(result + 12) |= 0x8000u;
  else
    *(_DWORD *)(result + 12) &= 0xFFFF7FFF;
  return result;
}


int __fastcall adc_set_channel(int result, int a2, int a3)
{
  *(_DWORD *)(result + 0x28) |= a2;
  *(_DWORD *)(result + 20) = a3;
  return result;
}


void __fastcall sub_8001518(_DWORD *result, int a2)
{
  *result = a2;
}


int __fastcall sub_800151C(int result, int a2)
{
  if ( a2 )
    *(_DWORD *)(result + 8) |= 1u;
  else
    *(_DWORD *)(result + 8) |= 2u;
  return result;
}


void __fastcall sub_8001534(int result, int a2)
{
  if ( a2 )
    *(_DWORD *)(result + 12) |= 1u;
  else
    *(_DWORD *)(result + 12) = 2 * (*(_DWORD *)(result + 12) >> 1);
}


int __fastcall sub_800154C(int result, int a2)
{
  *(_DWORD *)(result + 12) &= 0xFFFFFFFD;
  *(_DWORD *)(result + 12) |= a2;
  return result;
}


int __fastcall sub_800155C(int a1)
{
  int v1; 
  int result; 

  v1 = a1;
  result = 1073816576;
  if ( v1 == 1073816576 )
  {
    sub_8008C64(512, 1);
    result = sub_8008C64(512, 0);
  }
  return result;
}


int __fastcall sub_800157C(int a1)
{
  int v1; 
  int result; 

  v1 = 0;
  *(_DWORD *)(a1 + 8) |= 0x80000000;
  do
    ++v1;
  while ( v1 != 61440 && *(_DWORD *)(a1 + 8) >> 31 << 31 );
  if ( *(_DWORD *)(a1 + 8) >> 31 << 31 )
    result = 0;
  else
    result = *(_DWORD *)(a1 + 64);
  return result;
}


int __fastcall ADC_ReadResult(int a1)
{
  return (unsigned __int16)*(_DWORD *)(a1 + 0x40);
}


bool __fastcall sub_80015C0(int a1, int a2)
{
  unsigned int v2; 

  if ( a2 & 0x1000000 )
    v2 = *(_DWORD *)(a1 + 8) & 0xFEFFFFFF;
  else
    v2 = *(_DWORD *)a1;
  return (v2 & a2) != 0;
}


int __fastcall sub_80015F0(int result, int a2)
{
  *(_DWORD *)(result + 12) = *(_DWORD *)(result + 12) & 0xFFFFD203 | *(_DWORD *)a2 | (*(_BYTE *)(a2 + 4) << 13) | *(_DWORD *)(a2 + 8) | *(_DWORD *)(a2 + 12) | *(_DWORD *)(a2 + 16) | *(_DWORD *)(a2 + 20);
  return result;
}


int __fastcall sub_800161C(int result, int a2)
{
  if ( a2 )
    *(_DWORD *)(result + 12) |= 0x1000u;
  else
    *(_DWORD *)(result + 12) &= 0xFFFFEFFF;
  return result;
}


void __fastcall sub_8001638(int result)
{
  *(_DWORD *)(result + 8) |= 4u;
}


int __fastcall sub_8001642(int result)
{
  *(_DWORD *)(result + 8) |= 0x10u;
  return result;
}


int __fastcall sub_800164C(int result)
{
  *(_DWORD *)result = 0;
  *(_BYTE *)(result + 4) = 0;
  *(_DWORD *)(result + 8) = 0;
  *(_DWORD *)(result + 12) = 0;
  *(_DWORD *)(result + 16) = 0;
  *(_DWORD *)(result + 20) = 0;
  return result;
}


void adc_init()
{
  sub_8008C04(1, 1);
  sub_8008C24(2, 1);
  sub_8008998();
  sub_8002120(0x40020008);
  sub_8002230((int)&dword_20000BCC);
  dword_20000BCC = 0x40012440;
  dword_20000BD0 = (int)adc_data;
  dword_20000BD4 = 0;
  dword_20000BD8 = 512;
  dword_20000BDC = 0;
  dword_20000BE0 = 128;
  dword_20000BE4 = 256;
  dword_20000BE8 = 1024;
  dword_20000BEC = 32;
  dword_20000BF0 = 0x2000;
  dword_20000BF4 = 0;
  sub_80021F0(0x40020008, (int)&dword_20000BCC);
  sub_80021DC((_DWORD *)0x40020008, 2, 1);
  dma_ack_int(2);
  sub_8002104((_DWORD *)0x40020008, 1);
  sub_800155C(1073816576);
  sub_800164C((int)&dword_20000BF8);
  dword_20000BF8 = 0;
  byte_20000BFC = 0;
  dword_20000C00 = 1024;
  dword_20000C04 = 192;
  dword_20000C08 = 0;
  dword_20000C0C = 0;
  sub_80015F0(0x40012400, (int)&dword_20000BF8);
  sub_800161C(0x40012400, 1);
  adc_set_channel(0x40012400, 2, 5);
  sub_800157C(0x40012400);
  sub_800151C(0x40012400, 1);
  while ( !sub_80015C0(0x40012400, 0x1000001) )
    ;
  sub_800154C(1073816576, 2);
  sub_8001534(1073816576, 1);
}



















int __fastcall sub_8001760(int result, int a2)
{
  if ( a2 )
    *(_DWORD *)(result + 12) |= 0x4000u;
  else
    *(_DWORD *)(result + 12) &= 0xFFFFBFFF;
  return result;
}


bool __fastcall adc_select_channel(int a1)
{
  int v1; 
  bool result; 

  v1 = a1;
  sub_800155C(0x40012400);
  dword_20000BF8 = 0;
  byte_20000BFC = 0;
  dword_20000C00 = 0;
  dword_20000C08 = 0;
  dword_20000C0C = 0;
  sub_80015F0(0x40012400, (int)&dword_20000BF8);
  adc_set_channel(0x40012400, v1, 6);
  sub_800157C(0x40012400);
  sub_8001760(0x40012400, 1);
  sub_80014E4(0x40012400, 1);
  sub_800151C(0x40012400, 1);
  do
    result = sub_80015C0(0x40012400, 0x1000001);
  while ( !result );
  return result;
}







void __fastcall adc_capture_dma(int a1)
{
  int v1; 

  v1 = a1;
  adc_stop();
  sub_8002120(0x40020008);
  sub_8002230((int)&dword_20000BCC);
  dword_20000BCC = 0x40012440;
  dword_20000BD0 = (int)adc_data;
  dword_20000BD4 = 0;
  byte_200001C3 = v1;
  word_200000A4 = 0x200;
  dword_20000BD8 = 0x200;
  dword_20000BDC = 0;
  dword_20000BE0 = 128;
  dword_20000BE4 = 256;
  dword_20000BE8 = 1024;
  dword_20000BEC = 32;
  dword_20000BF0 = 0x2000;
  dword_20000BF4 = 0;
  sub_80021F0(0x40020008, (int)&dword_20000BCC);
  sub_80021DC((_DWORD *)0x40020008, 2, 1);
  dma_ack_int(2);
  sub_8002104((_DWORD *)0x40020008, 1);
  sub_800155C(1073816576);
  sub_800164C((int)&dword_20000BF8);
  dword_20000BF8 = 0;
  byte_20000BFC = 0;
  dword_20000C00 = 1024;
  dword_20000C04 = 192;
  dword_20000C08 = 0;
  dword_20000C0C = 0;
  sub_80015F0(0x40012400, (int)&dword_20000BF8);
  sub_800161C(0x40012400, 1);
  if ( v1 )
  {
    adc_set_channel(0x40012400, 32, 2);
    adc_set_channel(0x40012400, 2, 2);
  }
  else
  {
    adc_set_channel(0x40012400, 2, 4);
  }
  sub_800157C(0x40012400);
  sub_800151C(0x40012400, 1);
  while ( !sub_80015C0(0x40012400, 0x1000001) )
    ;
  sub_800154C(0x40012400, 2);
  sub_8001534(0x40012400, 1);
  sub_8001638(0x40012400);
}





















void adc_stop()
{
  sub_8001534(0x40012400, 0);
  sub_8001642(0x40012400);
  sub_800151C(0x40012400, 0);
  dma_ack_int(2);
}


void bt_save_config()
{
  char result; 

  sub_800014C(&result, "SPP:saveConfigure \r\n", 0x18u);
  uart1_send_buf(&result, 21);
}


void bt_set_baud()
{
  int v0; 

  sub_800014C(&v0, "SPP:setBR 9600\r\n", 0x14u);
  uart1_send_buf((char *)&v0, 18);
}


void bt_set_name()
{
  int v0; 

  sub_800014C(&v0, "SPP:setName = SNDWAY LDM STUDIO\r\n", 0x24u);
  uart1_send_buf((char *)&v0, 35);
}


void __cdecl beep_timer()
{
  __int16 v0; 
  __int16 v1; 
  __int16 v2; 
  int v3; 
  __int16 v4; 
  __int16 v5; 
  __int16 v6; 
  __int16 v7; 
  __int16 v8; 
  __int16 v9; 
  int v10; 
  __int16 v11; 
  char v12; 

  sub_8008C44(0x10000, 1);
  v8 = 0;
  v9 = 0;
  v10 = 15999;
  v11 = 0;
  v12 = 0;
  sub_800A1FC(0x40014000, (int)&v8);
  v0 = 96;
  v1 = 1;
  v2 = 4;
  v4 = 2;
  v5 = 0;
  v6 = 256;
  v7 = 0;
  v3 = 3399;
  sub_800A068(0x40014000, (int)&v0);
  TIM_Cmd((_WORD *)0x40014000, 1);
  sub_800A00C(0x40014000, 0);
}


void __fastcall beep_enable(int a1)
{
  struc_gpio v1; 

  if ( a1 == 1 )
  {
    TIM_Cmd((_WORD *)0x40014000, 1);
    v1.pin = 4;
    v1.mode = 2;
    v1.speed = 3;
    v1.otype = 0;
    v1.pupd = 0;
    gpio_init(0x48000000, &v1);
    gpio_set_AF(0x48000000, 2, 0);
    sub_800A00C(0x40014000, 1);
  }
  else if ( !a1 )
  {
    TIM_Cmd((_WORD *)0x40014000, 0);
    sub_800A00C(0x40014000, 0);
    v1.pin = 4;
    v1.mode = 1;
    v1.otype = 0;
    v1.speed = 3;
    v1.pupd = 0;
    gpio_init(0x48000000, &v1);
    GPIO_Set(0x48000000, 4);
  }
}


void sub_8001AD4()
{
  ++byte_20000182;
  if ( (signed int)(unsigned __int8)byte_20000198 > 0 )
  {
    if ( (signed int)(unsigned __int8)byte_2000019A > 0 )
      --byte_2000019A;
    if ( !byte_2000019A )
    {
      if ( byte_20000199 )
      {
        --byte_20000198;
        beep_enable(0);
        if ( (signed int)(unsigned __int8)byte_20000198 > 0 )
          byte_2000019A = 2;
        byte_20000199 = 0;
      }
      else
      {
        beep_enable(1);
        byte_20000199 = 1;
      }
    }
  }
}





bool apd_signal_level_ok()
{
  signed int v0; 
  signed int i; 

  v0 = 0;
  adc_stop();
  adc_capture_dma(0);
  new_adc_data = 0;
  while ( !new_adc_data )
    ;
  new_adc_data = 0;
  while ( !new_adc_data )
    ;
  new_adc_data = 0;
  for ( i = 0; i < 64; i = (unsigned __int8)(i + 1) )
  {
    if ( adc_data_copy[i] > (signed int)signal_max )
      v0 = (unsigned __int8)(v0 + 1);
  }
  return v0 > 4;
}



void adc_read_battery()
{
  unsigned int acc; 
  signed int i; 

  adc_stop();
  adc_select_channel(1);
  delay_mode_cycles(6u);
  acc = 0;
  for ( i = 0; i < 8; i = (unsigned __int8)(i + 1) )
  {
    sub_8001638(0x40012400);
    while ( !sub_80015C0(0x40012400, 4) )
      ;
    acc += ADC_ReadResult(0x40012400);
    sub_8001518((_DWORD *)0x40012400, 4);
  }
  adc_battery = acc >> 3;
  adc_stop();
}



void __cdecl sub_8001C18()
{
  signed int v0; 
  signed int i; 
  signed int j; 
  signed int k; 
  signed int v4; 

  v0 = 0;
  select_laser(0);
  GPIO_Set(0x48000400, 0x1000);
  delay_cycles_16000(20);
  adp_pwm_value_laser2 = 0;
  adp_pwm_value_laser1 = 0;
  adc_capture_dma(0);
  delay_cycles_16000(16);
  signal_max = 0;
  new_adc_data = 0;
  while ( !new_adc_data )
    ;
  for ( i = 0; i < 5; i = (unsigned __int8)(i + 1) )
  {
    new_adc_data = 0;
    while ( !new_adc_data )
      ;
    new_adc_data = 0;
    while ( !new_adc_data )
      ;
    for ( j = 0; j < 64; j = (unsigned __int8)(j + 1) )
    {
      if ( adc_data_copy[j] > (signed int)signal_max )
        signal_max = adc_data_copy[j];
    }
    if ( (signed int)signal_max < 3580 )
    {
      apd_update_level(2);
      signal_max = 0;
      adc_capture_dma(0);
      delay_cycles_16000(8);
      new_adc_data = 0;
      while ( !new_adc_data )
        ;
      for ( k = 0; k < 64; k = (unsigned __int8)(k + 1) )
      {
        if ( adc_data_copy[k] > (signed int)signal_max )
          signal_max = adc_data_copy[k];
      }
    }
    signal_max -= 400;
    new_adc_data = 0;
    while ( !new_adc_data )
      ;
    new_adc_data = 0;
    while ( !v0 )
    {
      if ( new_adc_data )
      {
        if ( sub_800AEFC() )
        {
          adp_pwm_value_laser2 = apd_pwm_value;
          v0 = 1;
        }
        new_adc_data = 0;
      }
    }
    if ( (signed int)(unsigned __int16)adp_pwm_value_laser2 <= 68 )
    {
      apd_pwm_value = word_200000B6;
      apd_dcdc_set(word_200000B6);
      delay_cycles_16000(8);
    }
    else
    {
      LOBYTE(i) = 0xC8u;
    }
  }
  GPIO_Reset(0x48000400, 0x1000);
  delay_cycles_16000(6);
  v4 = 0;
  new_adc_data = 0;
  while ( !new_adc_data )
    ;
  new_adc_data = 0;
  while ( !new_adc_data )
    ;
  new_adc_data = 0;
  while ( !v4 )
  {
    if ( new_adc_data )
    {
      if ( sub_800AEFC() )
      {
        adp_pwm_value_laser1 = apd_pwm_value;
        v4 = 1;
      }
      new_adc_data = 0;
    }
  }
}






void __fastcall __noreturn sub_8001DF4(int a1, int a2, int a3)
{
  JUMPOUT(loc_8001DFE);
}


void __cdecl digits_clear_all()
{
  signed int i; 

  for ( i = 0; i < 6; i = (unsigned __int8)(i + 1) )
  {
    digits_1[i] = 11;
    digits_2[i] = 11;
    digits_3[i] = 11;
  }
}


void disable_laser()
{
  si_write(si_disable_output, 2u, 0xC0);
  GPIO_Set(0x48000400, 4);
  apd_dcdc_set(6u);
  GPIO_Reset(0x48000400, 0x2000);
  GPIO_Reset(0x48000400, 0x1000);
}


void __cdecl digits_clear_4()
{
  digits_4[6] = 11;
  digits_4[7] = 11;
  digits_4[8] = 11;
  digits_4[9] = 11;
}


void dma_isr()
{
  signed int i; 

  if ( sub_80021C0(2) == 1 )
  {
    if ( !new_adc_data )
    {
      for ( i = 0; i < (unsigned __int16)word_200000A4; i = (unsigned __int16)(i + 1) )
        adc_data_copy[i] = adc_data[i];
      new_adc_data = 1;
    }
    dma_ack_int(2);
  }
}




void __fastcall dma_ack_int(int result)
{
  v40020004 = result;
}


_DWORD *__fastcall sub_8002104(_DWORD *result, int a2)
{
  if ( a2 )
    *result |= 1u;
  else
    *result &= 0xFFFEu;
  return result;
}


int __fastcall sub_8002120(int result)
{
  *(_DWORD *)result &= 0xFFFEu;
  *(_DWORD *)result = 0;
  *(_DWORD *)(result + 4) = 0;
  *(_DWORD *)(result + 8) = 0;
  *(_DWORD *)(result + 12) = 0;
  switch ( result )
  {
    case 1073872904:
      v40020004 |= 0xFu;
      break;
    case 1073872924:
      v40020004 |= 0xF0u;
      break;
    case 1073872944:
      v40020004 |= 0xF00u;
      break;
    case 1073872964:
      v40020004 |= 0xF000u;
      break;
    case 1073872984:
      v40020004 |= 0xF0000u;
      break;
  }
  return result;
}


bool __fastcall sub_80021C0(int a1)
{
  return (v40020000 & a1) != 0;
}


_DWORD *__fastcall sub_80021DC(_DWORD *result, int a2, int a3)
{
  if ( a3 )
    *result |= a2;
  else
    *result &= ~a2;
  return result;
}


int __fastcall sub_80021F0(int result, int a2)
{
  *(_DWORD *)result = *(_DWORD *)result & 0xFFFF800F | *(_DWORD *)(a2 + 8) | *(_DWORD *)(a2 + 32) | *(_DWORD *)(a2 + 16) | *(_DWORD *)(a2 + 20) | *(_DWORD *)(a2 + 24) | *(_DWORD *)(a2 + 28) | *(_DWORD *)(a2 + 36) | *(_DWORD *)(a2 + 40);
  *(_DWORD *)(result + 4) = *(_DWORD *)(a2 + 12);
  *(_DWORD *)(result + 8) = *(_DWORD *)a2;
  *(_DWORD *)(result + 12) = *(_DWORD *)(a2 + 4);
  return result;
}


int __fastcall sub_8002230(int result)
{
  *(_DWORD *)result = 0;
  *(_DWORD *)(result + 4) = 0;
  *(_DWORD *)(result + 8) = 0;
  *(_DWORD *)(result + 12) = 0;
  *(_DWORD *)(result + 16) = 0;
  *(_DWORD *)(result + 20) = 0;
  *(_DWORD *)(result + 24) = 0;
  *(_DWORD *)(result + 28) = 0;
  *(_DWORD *)(result + 32) = 0;
  *(_DWORD *)(result + 36) = 0;
  *(_DWORD *)(result + 40) = 0;
  return result;
}


void __fastcall delay_cycles_16000(int result)
{
  int i; 
  unsigned int j; 

  for ( i = 0; i < result; i = (unsigned __int8)(i + 1) )
  {
    for ( j = 0; j < 16000; ++j )
      ;
  }
}


void __fastcall lcd_segment_2_2(int a1)
{
  char v1; 

  v1 = byte_800F822[a1];
  if ( v1 & 0x40 )
    lcd_data[47] |= 1u;
  if ( v1 & 0x80 )
    lcd_data[33] |= 1u;
  if ( v1 & 0x10 )
    lcd_data[19] |= 1u;
  if ( v1 & 0x20 )
    lcd_data[5] |= 1u;
  if ( v1 & 4 )
    lcd_data[48] |= 0x80u;
  if ( v1 & 8 )
    lcd_data[34] |= 0x80u;
  if ( v1 & 1 )
    lcd_data[20] |= 0x80u;
  if ( v1 & 2 )
    lcd_data[6] |= 0x80u;
}


void __fastcall lcd_segment_2_3(int a1)
{
  char v1; 

  v1 = byte_800F822[a1];
  if ( v1 & 0x40 )
    lcd_data[46] |= 1u;
  if ( v1 & 0x80 )
    lcd_data[32] |= 1u;
  if ( v1 & 0x10 )
    lcd_data[18] |= 1u;
  if ( v1 & 0x20 )
    lcd_data[4] |= 1u;
  if ( v1 & 4 )
    lcd_data[47] |= 0x80u;
  if ( v1 & 8 )
    lcd_data[33] |= 0x80u;
  if ( v1 & 1 )
    lcd_data[19] |= 0x80u;
  if ( v1 & 2 )
    lcd_data[5] |= 0x80u;
}


void __fastcall lcd_segment_3_1(int a1, int idx, signed int value)
{
  char v3; 

  v3 = byte_800F822[a1];
  if ( v3 & 0x80 )
    lcd_data[idx + 42] |= value;
  if ( v3 & 0x40 )
    lcd_data[idx + 28] |= value;
  if ( v3 & 0x20 )
    lcd_data[idx + 14] |= value;
  if ( v3 & 0x10 )
    lcd_data[idx] |= value;
  if ( v3 & 8 )
    lcd_data[idx + 42] |= value >> 1;
  if ( v3 & 4 )
    lcd_data[idx + 28] |= value >> 1;
  if ( v3 & 2 )
    lcd_data[idx + 14] |= value >> 1;
  if ( v3 & 1 )
    lcd_data[idx] |= value >> 1;
}


void __fastcall lcd_segment_1_1(unsigned __int8 a1, int a2, signed int a3)
{
  char v3; 

  v3 = byte_800F822[a1];
  if ( v3 & 0x80 )
    lcd_data[a2 + 42] |= a3;
  if ( v3 & 0x40 )
    lcd_data[a2 + 28] |= a3;
  if ( v3 & 0x20 )
    lcd_data[a2 + 14] |= a3;
  if ( v3 & 0x10 )
    lcd_data[a2] |= a3;
  if ( v3 & 8 )
    lcd_data[a2 + 42] |= a3 >> 1;
  if ( v3 & 4 )
    lcd_data[a2 + 28] |= a3 >> 1;
  if ( v3 & 2 )
    lcd_data[a2 + 14] |= a3 >> 1;
  if ( v3 & 1 )
    lcd_data[a2] |= a3 >> 1;
}


void __fastcall lcd_segment_4_1(int a1, int a2, signed int a3)
{
  char v3; 

  v3 = byte_800F822[a1];
  if ( v3 & 0x40 )
    lcd_data[a2 + 42] |= a3;
  if ( v3 & 0x80 )
    lcd_data[a2 + 28] |= a3;
  if ( v3 & 0x10 )
    lcd_data[a2 + 14] |= a3;
  if ( v3 & 0x20 )
    lcd_data[a2] |= a3;
  if ( v3 & 4 )
    lcd_data[a2 + 42] |= a3 >> 1;
  if ( v3 & 8 )
    lcd_data[a2 + 28] |= a3 >> 1;
  if ( v3 & 1 )
    lcd_data[a2 + 14] |= a3 >> 1;
  if ( v3 & 2 )
    lcd_data[a2] |= a3 >> 1;
}


int __fastcall lcd_segment_4_2(int a1)
{
  int result; 

  result = byte_800F822[a1];
  if ( result & 0x40 )
    lcd_data[49] |= 1u;
  if ( result & 0x80 )
    lcd_data[35] |= 1u;
  if ( result & 0x10 )
    lcd_data[21] |= 1u;
  if ( result & 0x20 )
    lcd_data[7] |= 1u;
  if ( result & 4 )
    lcd_data[50] |= 0x80u;
  if ( result & 8 )
    lcd_data[36] |= 0x80u;
  if ( result & 1 )
    lcd_data[22] |= 0x80u;
  if ( result & 2 )
    lcd_data[8] |= 0x80u;
  return result;
}


void __fastcall lcd_segment_4_3(int a1)
{
  char v1; 

  v1 = byte_800F822[a1];
  if ( v1 & 0x40 )
    lcd_data[48] |= 1u;
  if ( v1 & 0x80 )
    lcd_data[34] |= 1u;
  if ( v1 & 0x10 )
    lcd_data[20] |= 1u;
  if ( v1 & 0x20 )
    lcd_data[6] |= 1u;
  if ( v1 & 4 )
    lcd_data[49] |= 0x80u;
  if ( v1 & 8 )
    lcd_data[35] |= 0x80u;
  if ( v1 & 1 )
    lcd_data[21] |= 0x80u;
  if ( v1 & 2 )
    lcd_data[7] |= 0x80u;
}


void __fastcall lcd_segment_x2(int a1)
{
  char v1; 

  v1 = byte_800F822[a1];
  if ( v1 & 0x80 )
    lcd_data[45] |= 0x40u;
  if ( v1 & 0x40 )
    lcd_data[31] |= 0x40u;
  if ( v1 & 0x20 )
    lcd_data[17] |= 0x40u;
  if ( v1 & 0x10 )
    lcd_data[3] |= 0x40u;
  if ( v1 & 8 )
    lcd_data[45] |= 0x80u;
  if ( v1 & 4 )
    lcd_data[31] |= 0x80u;
  if ( v1 & 2 )
    lcd_data[17] |= 0x80u;
  if ( v1 & 1 )
    lcd_data[3] |= 0x80u;
}


void __fastcall lcd_segment_x1(int a1)
{
  char v1; 

  v1 = byte_800F822[a1];
  if ( v1 & 0x80 )
    lcd_data[45] |= 0x10u;
  if ( v1 & 0x40 )
    lcd_data[31] |= 0x10u;
  if ( v1 & 0x20 )
    lcd_data[17] |= 0x10u;
  if ( v1 & 0x10 )
    lcd_data[3] |= 0x10u;
  if ( v1 & 8 )
    lcd_data[45] |= 0x20u;
  if ( v1 & 4 )
    lcd_data[31] |= 0x20u;
  if ( v1 & 2 )
    lcd_data[17] |= 0x20u;
  if ( v1 & 1 )
    lcd_data[3] |= 0x20u;
}


void __fastcall lcd_segment_xx(int a1)
{
  char v1; 

  v1 = byte_800F822[a1];
  if ( v1 & 0x80 )
    lcd_data[45] |= 4u;
  if ( v1 & 0x40 )
    lcd_data[31] |= 4u;
  if ( v1 & 0x20 )
    lcd_data[17] |= 4u;
  if ( v1 & 0x10 )
    lcd_data[3] |= 4u;
  if ( v1 & 8 )
    lcd_data[45] |= 8u;
  if ( v1 & 4 )
    lcd_data[31] |= 8u;
  if ( v1 & 2 )
    lcd_data[17] |= 8u;
  if ( v1 & 1 )
    lcd_data[3] |= 8u;
}


void __fastcall lcd_segment_y_1(int a1)
{
  char v1; 

  v1 = byte_800F822[a1];
  if ( v1 & 0x80 )
    lcd_data[46] |= 0x80u;
  if ( v1 & 0x40 )
    lcd_data[32] |= 0x80u;
  if ( v1 & 0x20 )
    lcd_data[18] |= 0x80u;
  if ( v1 & 0x10 )
    lcd_data[4] |= 0x80u;
  if ( v1 & 8 )
    lcd_data[45] |= 1u;
  if ( v1 & 4 )
    lcd_data[31] |= 1u;
  if ( v1 & 2 )
    lcd_data[17] |= 1u;
  if ( v1 & 1 )
    lcd_data[3] |= 1u;
}


void __fastcall lcd_segment_y_2(int a1)
{
  char v1; 

  v1 = byte_800F822[a1];
  if ( v1 & 0x80 )
    lcd_data[46] |= 0x20u;
  if ( v1 & 0x40 )
    lcd_data[32] |= 0x20u;
  if ( v1 & 0x20 )
    lcd_data[18] |= 0x20u;
  if ( v1 & 0x10 )
    lcd_data[4] |= 0x20u;
  if ( v1 & 8 )
    lcd_data[46] |= 0x40u;
  if ( v1 & 4 )
    lcd_data[32] |= 0x40u;
  if ( v1 & 2 )
    lcd_data[18] |= 0x40u;
  if ( v1 & 1 )
    lcd_data[4] |= 0x40u;
}


void __fastcall lcd_segment_y_3(int a1)
{
  char v1; 

  v1 = byte_800F822[a1];
  if ( v1 & 0x80 )
    lcd_data[46] |= 8u;
  if ( v1 & 0x40 )
    lcd_data[32] |= 8u;
  if ( v1 & 0x20 )
    lcd_data[18] |= 8u;
  if ( v1 & 0x10 )
    lcd_data[4] |= 8u;
  if ( v1 & 8 )
    lcd_data[46] |= 0x10u;
  if ( v1 & 4 )
    lcd_data[32] |= 0x10u;
  if ( v1 & 2 )
    lcd_data[18] |= 0x10u;
  if ( v1 & 1 )
    lcd_data[4] |= 0x10u;
}


void __fastcall lcd_segment_1_2(int a1)
{
  char v1; 

  v1 = byte_800F822[a1];
  if ( v1 & 0x80 )
    lcd_data[53] |= 1u;
  if ( v1 & 0x40 )
    lcd_data[39] |= 1u;
  if ( v1 & 0x20 )
    lcd_data[25] |= 1u;
  if ( v1 & 0x10 )
    lcd_data[11] |= 1u;
  if ( v1 & 8 )
    lcd_data[54] |= 0x80u;
  if ( v1 & 4 )
    lcd_data[40] |= 0x80u;
  if ( v1 & 2 )
    lcd_data[26] |= 0x80u;
  if ( v1 & 1 )
    lcd_data[12] |= 0x80u;
}


void __fastcall lcd_segment_2_1(int a1, int a2, signed int a3)
{
  char v3; 

  v3 = byte_800F822[a1];
  if ( v3 & 0x40 )
    lcd_data[a2 + 42] |= a3;
  if ( v3 & 0x80 )
    lcd_data[a2 + 28] |= a3;
  if ( v3 & 0x10 )
    lcd_data[a2 + 14] |= a3;
  if ( v3 & 0x20 )
    lcd_data[a2] |= a3;
  if ( v3 & 4 )
    lcd_data[a2 + 42] |= a3 >> 1;
  if ( v3 & 8 )
    lcd_data[a2 + 28] |= a3 >> 1;
  if ( v3 & 1 )
    lcd_data[a2 + 14] |= a3 >> 1;
  if ( v3 & 2 )
    lcd_data[a2] |= a3 >> 1;
}


void __cdecl lcd_battery_symbol()
{
  double v0; 
  unsigned __int8 v1; 
  double v2; 
  char v3; 
  double v4; 
  double v5; 
  double v6; 

  v0 = uint2double(adc_battery);
  d_lt(v0, 1474.56);
  if ( !v1 && byte_2000005B )
    lcd_data[46] |= 0x40u;
  v2 = uint2double(adc_battery);
  d_gt(v2, 1474.56);
  if ( !(!v3 & v1) )
    lcd_data[46] |= 0x42u;
  v4 = uint2double(adc_battery);
  d_gt(v4, 1638.4);
  if ( !v1 )
    lcd_data[18] |= 2u;
  v5 = uint2double(adc_battery);
  d_gt(v5, 1802.24);
  if ( !v1 )
    lcd_data[4] |= 2u;
  v6 = uint2double(adc_battery);
  d_gt(v6, 1966.08);
  if ( !v1 )
    lcd_data[32] |= 2u;
}




void __cdecl lcd_symbols_()
{
  if ( !dword_20000260 )
    byte_200000F6 = dword_20000260;
  if ( !dword_2000025C )
    byte_200000F7 = dword_2000025C;
  if ( !dword_20000258[0] )
    byte_200000F8 = dword_20000258[0];
  if ( (signed int)current_state > 1
    && (signed int)current_state < 150
    && !byte_2000009E
    && current_state != 98
    && current_state != 99 )
  {
    byte_200000F9 = 0;
  }
  if ( byte_200000F6 == 1 )
    lcd_data[54] |= 0x10u;
  if ( byte_200000F6 == 2 )
    lcd_data[54] |= 4u;
  if ( byte_200000F6 == 3 )
    lcd_data[54] |= 1u;
  if ( byte_200000F7 == 1 )
    lcd_data[33] |= 2u;
  if ( byte_200000F7 == 2 )
    lcd_data[34] |= 0x80u;
  if ( byte_200000F7 == 3 )
    lcd_data[34] |= 0x20u;
  if ( current_state != 160 && current_state != 161 )
  {
    if ( byte_200000F8 == 1 )
      lcd_data[51] |= 1u;
    if ( byte_200000F8 == 2 )
      lcd_data[52] |= 0x40u;
    if ( byte_200000F8 == 3 )
      lcd_data[52] |= 0x10u;
  }
  if ( current_state != 160 && current_state != 161 )
  {
    if ( byte_200000F9 == 1 )
      lcd_data[35] |= 2u;
    if ( byte_200000F9 == 2 )
      lcd_data[36] |= 0x80u;
    if ( byte_200000F9 == 3 )
      lcd_data[36] |= 0x20u;
  }
}









void __cdecl lcd_err()
{
  if ( current_state == 101 && (signed int)(unsigned __int8)error_no > 0 )
  {
    digits_4[6] = 11;
    digits_4[7] = 11;
    digits_4[8] = 11;
    digits_4[9] = 11;
    digits_4[0] = 12;
    digits_4[1] = 13;
    digits_4[2] = 13;
    digits_4[3] = 11;
    if ( error_no == 8 )
      digits_4[4] = 11;
    else
      digits_4[4] = error_no;
    dword_200000C8 = 0;
  }
}



void __cdecl lcd_write_number_1()
{
  char v0; 

  v0 = byte_2000009D;
  if ( current_state == 0x99 )
    byte_2000009D = byte_20000125;
  if ( (signed int)current_state < 200 && (signed int)byte_20000000 < 4 || byte_2000009D == 9 )
  {
    digits_1[6] = 11;
    digits_1[7] = 11;
    digits_1[8] = 11;
    digits_1[9] = 11;
    if ( digit_1_decimal == 1 )
      digits_1[9] = 2;
    if ( digit_1_decimal == 2 )
      digits_1[9] = 3;
  }
  lcd_segment_1_1(digits_1[0], 13, 32);
  lcd_segment_1_1(digits_1[1], 13, 128);
  lcd_segment_1_1(digits_1[2], 12, 2);
  lcd_segment_1_1(digits_1[3], 12, 8);
  lcd_segment_1_1(digits_1[4], 12, 32);
  if ( digits_1[6] == 1 )
    lcd_data[26] |= 0x40u;
  lcd_segment_1_2(digits_1[7]);
  if ( digits_1[8] == 1 )
    lcd_data[11] |= 2u;
  lcd_segment_1_1(digits_1[9], 11, 8);
  byte_2000009D = v0;
}





void __cdecl lcd_write_number_2()
{
  char v0; 

  v0 = byte_2000009D;
  if ( current_state == 153 )
    byte_2000009D = byte_20000125;
  if ( (signed int)current_state < 200 && (signed int)byte_20000000 < 4 || byte_2000009D == 9 )
  {
    digits_2[6] = 11;
    digits_2[7] = 11;
    digits_2[8] = 11;
    digits_2[9] = 11;
    if ( digit_2_decimal == 1 )
      digits_2[9] = 2;
    if ( digit_2_decimal == 2 )
      digits_2[9] = 3;
  }
  lcd_segment_2_1(digits_2[0], 6, 4);
  lcd_segment_2_1(digits_2[1], 6, 16);
  lcd_segment_2_1(digits_2[2], 6, 64);
  lcd_segment_2_2(digits_2[3]);
  lcd_segment_2_1(digits_2[4], 5, 4);
  if ( digits_2[6] == 1 )
    lcd_data[5] |= 8u;
  lcd_segment_2_1(digits_2[7], 5, 32);
  if ( digits_2[8] == 1 )
    lcd_data[19] |= 0x40u;
  lcd_segment_2_3(digits_2[9]);
  byte_2000009D = v0;
}





void __cdecl lcd_write_number_3()
{
  char v0; 

  v0 = byte_2000009D;
  if ( current_state == 153 )
    byte_2000009D = byte_20000125;
  if ( (signed int)current_state < 200 && (signed int)byte_20000000 < 4 || byte_2000009D == 9 )
  {
    digits_3[6] = 11;
    digits_3[7] = 11;
    digits_3[8] = 11;
    digits_3[9] = 11;
    if ( digit_3_decimal == 1 )
      digits_3[9] = 2;
    if ( digit_3_decimal == 2 )
      digits_3[9] = 3;
  }
  lcd_segment_3_1(digits_3[0], 10, 2);
  lcd_segment_3_1(digits_3[1], 10, 8);
  lcd_segment_3_1(digits_3[2], 10, 32);
  lcd_segment_3_1(digits_3[3], 10, 128);
  lcd_segment_3_1(digits_3[4], 9, 2);
  if ( digits_3[6] == 1 )
    lcd_data[23] |= 4u;
  lcd_segment_3_1(digits_3[7], 9, 16);
  if ( digits_3[8] == 1 )
    lcd_data[9] |= 0x20u;
  lcd_segment_3_1(digits_3[9], 9, 128);
  byte_2000009D = v0;
}





void __cdecl sub_80033B8()
{
  convert_number(byte_800F81A[byte_2000017E], 3);
  digits[2] = 1;
  lcd_segment_x2(1);
  lcd_segment_x1(digits[3]);
  lcd_segment_xx(digits[4]);
}


void __cdecl lcd_write_number_4()
{
  if ( current_state == 153 )
  {
    if ( digit_4_decimal )
    {
      digits_clear_4();
      if ( digit_4_decimal == 1 )
        digits_4[9] = 2;
      if ( digit_4_decimal == 2 )
        digits_4[9] = 3;
    }
    else if ( (signed int)byte_20000124 < 4 )
    {
      digits_clear_4();
    }
  }
  else if ( (signed int)current_state < 200 )
  {
    if ( (signed int)byte_20000000 < 4 )
      digits_clear_4();
    if ( digit_4_decimal == 1 )
      digits_4[9] = 2;
    if ( digit_4_decimal == 2 )
      digits_4[9] = 3;
  }
  if ( !digits_4[0] )
  {
    digits_4[0] = 11;
    if ( !digits_4[1] && (signed int)byte_200000F9 < 3 )
    {
      digits_4[1] = 11;
      if ( !digits_4[2] && (signed int)byte_200000F9 < 2 )
      {
        digits_4[2] = 11;
        if ( !digits_4[3] && !byte_200000F9 )
          digits_4[3] = 11;
      }
    }
  }
  lcd_segment_4_1(digits_4[0], 8, 4);
  lcd_segment_4_1(digits_4[1], 8, 0x10);
  lcd_segment_4_1(digits_4[2], 8, 0x40);
  lcd_segment_4_2(digits_4[3]);
  lcd_segment_4_1(digits_4[4], 7, 4);
  if ( digits_4[6] == 1 )
    lcd_data[7] |= 8u;
  if ( digits_4[8] == 1 )
    lcd_data[21] |= 0x40u;
  lcd_segment_4_1(digits_4[7], 7, 32);
  lcd_segment_4_3(digits_4[9]);
  if ( byte_2000006A )
    lcd_data[8] |= 1u;
}




void __fastcall sub_8003568()
{
  signed int i; 

  if ( (signed int)current_state > 200 )
  {
    for ( i = 0; i < 10; i = (unsigned __int8)(i + 1) )
      digits_4[i] = 11;
  }
  if ( current_state == 203 )
  {
    if ( byte_200000F0 <= 0 )
      digits_4[9] = -byte_200000F0;
    else
      digits_4[9] = byte_200000F0;
  }
}



void __fastcall sub_80035B4(int a1, char *a2)
{
  if ( current_state == 153 )
  {
    math_mode = byte_200000AB;
    a2 = &byte_2000009D;
    byte_2000009D = tmpbuf[0] & 0xF;
  }
  switch_(math_mode, (int)a2);
  JUMPOUT(*(_DWORD *)&word_80035E8);
}






void lcd_clear_digits4()
{
  signed int i; 
  signed int j; 

  if ( (signed int)current_state > 1 && (signed int)current_state < 100 && !byte_2000009E )
  {
    for ( i = 0; i < 10; i = (unsigned __int8)(i + 1) )
      digits_4[i] = 11;
    for ( j = 1; j <= 5; j = (unsigned __int8)(j + 1) )
      digits_4[j] = 10;
  }
}



void sub_8003CB8()
{
  convet_2_digits((unsigned __int8)byte_2000018E);
  if ( (signed int)(unsigned __int8)byte_2000018B <= 0 )
  {
    lcd_segment_x1((unsigned __int8)byte_2000018C);
  }
  else
  {
    lcd_segment_x1((unsigned __int8)byte_2000018B);
    lcd_segment_xx((unsigned __int8)byte_2000018C);
  }
}





void sub_8003CF4()
{
  convet_2_digits((unsigned __int8)byte_20000190);
  if ( (signed int)(unsigned __int8)byte_2000018B <= 0 )
  {
    lcd_segment_x1((unsigned __int8)byte_2000018C);
  }
  else
  {
    lcd_segment_x1((unsigned __int8)byte_2000018B);
    lcd_segment_xx((unsigned __int8)byte_2000018C);
  }
}





void __cdecl lcd_write_number_xx()
{
  float v0; 
  int v1; 
  double v2; 
  unsigned __int8 v3; 
  char v4; 

  v0 = fmul(dword_20000010, 10.0);
  v1 = sub_800104C(v0);
  dword_20000178 = v1;
  v2 = ui2double(v1);
  d_gt(v2, 0.0);
  if ( !v4 & v3 )
  {
    convert_number(-dword_20000178, 1);
    lcd_data[45] |= 1u;
  }
  else
  {
    convert_number(dword_20000178, 1);
  }
  lcd_data[46] |= 0x10u;
  lcd_data[32] |= 4u;
  lcd_segment_y_1(digits[2]);
  lcd_segment_y_2(digits[3]);
  lcd_segment_y_3(digits[4]);
}



void __cdecl lcd_symbols_xx()
{
  int v0; 
  int v1; 
  int v2; 
  char v3; 
  unsigned __int8 v4; 

  v0 = byte_20000000;
  v1 = math_mode;
  if ( current_state == 153 )
  {
    byte_20000000 = byte_20000124;
    math_mode = byte_200000AB;
    byte_2000009D = byte_20000125;
  }
  v2 = switch_(v0, v1);
  v3 = *(_BYTE *)((v2 << 16) + 0x10) + 3;
  lcd_data[54] |= 0x80u;
  lcd_data[33] |= 0x10u;
  lcd_data[51] |= 8u;
  lcd_data[35] |= 0x10u;
  byte_20000000 = v2;
  math_mode = v4;
  byte_2000009D = v3;
}





void __cdecl sub_8004178()
{
  lcd_data[2] |= 8u;
  if ( ((signed int)current_state > 0 && (signed int)current_state < 5
     || (signed int)current_state > 90 && (signed int)current_state < 100)
    && byte_2000005B )
  {
    lcd_data[30] |= 8u;
  }
  if ( (signed int)current_state > 4 && (signed int)current_state < 98 )
    lcd_data[30] |= 8u;
  if ( byte_2000013E )
  {
    if ( byte_2000013E == 1 )
    {
      lcd_data[30] |= 2u;
      lcd_data[16] |= 6u;
      lcd_data[2] |= 2u;
    }
  }
  else
  {
    lcd_data[30] |= 6u;
  }
}




void __cdecl lcd_convert_digits()
{
  unsigned __int8 *v0; 
  unsigned __int8 v1; 
  char v2; 
  unsigned __int8 v3; 
  float v4; 
  int v5; 
  int v6; 
  float v7; 
  int v8; 
  float v9; 
  int v10; 
  int v11; 
  float v12; 
  int v13; 
  int v14; 
  float v15; 
  int v16; 
  float v17; 
  int v18; 
  int v19; 
  float v20; 
  int v21; 
  int v22; 
  float v23; 
  int v24; 
  float v25; 
  int v26; 
  int v27; 

  v1 = byte_20000000;
  v2 = byte_2000009D;
  v3 = math_mode;
  if ( current_state == 153 )
  {
    byte_20000000 = byte_20000124;
    byte_2000009D = byte_20000125;
    v0 = &math_mode;
    math_mode = byte_200000AB;
  }
  sub_800C964(byte_20000000, (int)v0);
  if ( dword_20000260 )
  {
    if ( byte_2000009D == 9 )
    {
      v11 = sub_80001BC(dword_20000260 + 5, 0xAu);
      convert_number(v11, (unsigned __int8)byte_200000F6);
      byte_200000F6 = byte_2000007B;
    }
    else
    {
      if ( !byte_20000000 )
      {
        v4 = i2f(dword_20000260);
        sub_800BCD4(v4, 0);
        v5 = sub_8001098(dword_20000034);
        convert_number(v5, (unsigned __int8)byte_200000F6);
        byte_200000F6 = byte_2000007B;
      }
      if ( byte_20000000 == 1 )
      {
        v6 = sub_80001BC(dword_20000260 + 5, 0xAu);
        convert_number(v6, (unsigned __int8)byte_200000F6);
        byte_200000F6 = byte_2000007B;
      }
      if ( byte_20000000 == 2 )
      {
        v7 = i2f(dword_20000260);
        sub_800BCD4(v7, 2);
        v8 = sub_8001098(dword_20000034);
        convert_number(v8, (unsigned __int8)byte_200000F6);
        byte_200000F6 = byte_2000007B;
      }
      if ( byte_20000000 == 3 )
      {
        v9 = i2f(dword_20000260);
        sub_800BCD4(v9, 3);
        v10 = sub_8001098(dword_20000034);
        convert_number(v10, (unsigned __int8)byte_200000F6);
        byte_200000F6 = byte_2000007B;
      }
      if ( byte_20000000 == 4 )
      {
        dword_20000034 = i2f(dword_20000260);
        sub_800DFD4(digits_1);
      }
      if ( byte_20000000 == 5 )
      {
        dword_20000034 = i2f(dword_20000260);
        sub_800DDE8(digits_1);
      }
    }
    copy_digits(0);
    if ( !digits_1[0] )
    {
      digits_1[0] = 11;
      if ( !digits_1[1] && (signed int)(unsigned __int8)byte_200000F6 < 3 )
      {
        digits_1[1] = 11;
        if ( !digits_1[2] && (signed int)(unsigned __int8)byte_200000F6 < 2 )
        {
          digits_1[2] = 11;
          if ( !digits_1[3] && !byte_200000F6 )
            digits_1[3] = 11;
        }
      }
    }
    lcd_write_number_1();
  }
  if ( dword_2000025C )
  {
    if ( byte_2000009D == 9 )
    {
      v19 = sub_80001BC(dword_2000025C + 5, 0xAu);
      convert_number(v19, (unsigned __int8)byte_200000F7);
      byte_200000F7 = byte_2000007B;
    }
    else
    {
      if ( !byte_20000000 )
      {
        v12 = i2f(dword_2000025C);
        sub_800BCD4(v12, 0);
        v13 = sub_8001098(dword_20000034);
        convert_number(v13, (unsigned __int8)byte_200000F7);
        byte_200000F7 = byte_2000007B;
      }
      if ( byte_20000000 == 1 )
      {
        v14 = sub_80001BC(dword_2000025C + 5, 0xAu);
        convert_number(v14, (unsigned __int8)byte_200000F7);
        byte_200000F7 = byte_2000007B;
      }
      if ( byte_20000000 == 2 )
      {
        v15 = i2f(dword_2000025C);
        sub_800BCD4(v15, 2);
        v16 = sub_8001098(dword_20000034);
        convert_number(v16, (unsigned __int8)byte_200000F7);
        byte_200000F7 = byte_2000007B;
      }
      if ( byte_20000000 == 3 )
      {
        v17 = i2f(dword_2000025C);
        sub_800BCD4(v17, 3);
        v18 = sub_8001098(dword_20000034);
        convert_number(v18, (unsigned __int8)byte_200000F7);
        byte_200000F7 = byte_2000007B;
      }
      if ( byte_20000000 == 4 )
      {
        dword_20000034 = i2f(dword_2000025C);
        sub_800DFD4(digits_2);
      }
      if ( byte_20000000 == 5 )
      {
        dword_20000034 = i2f(dword_2000025C);
        sub_800DDE8(digits_2);
      }
    }
    copy_digits(1);
    if ( !digits_2[0] )
    {
      digits_2[0] = 11;
      if ( !digits_2[1] && (signed int)(unsigned __int8)byte_200000F6 < 3 )
      {
        digits_2[1] = 11;
        if ( !digits_2[2] && (signed int)(unsigned __int8)byte_200000F6 < 2 )
        {
          digits_2[2] = 11;
          if ( !digits_2[3] && !byte_200000F6 )
            digits_2[3] = 11;
        }
      }
    }
    lcd_write_number_2();
  }
  if ( dword_20000258[0] )
  {
    if ( byte_2000009D == 9 )
    {
      v27 = sub_80001BC(dword_20000258[0] + 5, 0xAu);
      convert_number(v27, (unsigned __int8)byte_200000F8);
      byte_200000F8 = byte_2000007B;
    }
    else
    {
      if ( !byte_20000000 )
      {
        v20 = i2f(dword_20000258[0]);
        sub_800BCD4(v20, 0);
        v21 = sub_8001098(dword_20000034);
        convert_number(v21, (unsigned __int8)byte_200000F8);
        byte_200000F8 = byte_2000007B;
      }
      if ( byte_20000000 == 1 )
      {
        v22 = sub_80001BC(dword_20000258[0] + 5, 0xAu);
        convert_number(v22, (unsigned __int8)byte_200000F8);
        byte_200000F8 = byte_2000007B;
      }
      if ( byte_20000000 == 2 )
      {
        v23 = i2f(dword_20000258[0]);
        sub_800BCD4(v23, 2);
        v24 = sub_8001098(dword_20000034);
        convert_number(v24, (unsigned __int8)byte_200000F8);
        byte_200000F8 = byte_2000007B;
      }
      if ( byte_20000000 == 3 )
      {
        v25 = i2f(dword_20000258[0]);
        sub_800BCD4(v25, 3);
        v26 = sub_8001098(dword_20000034);
        convert_number(v26, (unsigned __int8)byte_200000F8);
        byte_200000F8 = byte_2000007B;
      }
      if ( byte_20000000 == 4 )
      {
        dword_20000034 = i2f(dword_20000258[0]);
        sub_800DFD4(digits_3);
      }
      if ( byte_20000000 == 5 )
      {
        dword_20000034 = i2f(dword_20000258[0]);
        sub_800DDE8(digits_3);
      }
    }
    copy_digits(2);
    if ( !digits_3[0] )
    {
      digits_3[0] = 11;
      if ( !digits_3[1] && (signed int)(unsigned __int8)byte_200000F6 < 3 )
      {
        digits_3[1] = 11;
        if ( !digits_3[2] && (signed int)(unsigned __int8)byte_200000F6 < 2 )
        {
          digits_3[2] = 11;
          if ( !digits_3[3] && !byte_200000F6 )
            digits_3[3] = 11;
        }
      }
    }
    lcd_write_number_3();
  }
  byte_20000000 = v1;
  byte_2000009D = v2;
  math_mode = v3;
}












signed int sub_8004758()
{
  signed int result; 

  byte_200000AD = 1;
  byte_2000009E = 0;
  disable_laser();
  byte_2000009E = 0;
  byte_2000006A = 0;
  byte_200000AC = 0;
  current_state = 0;
  byte_20000114 = 0;
  byte_2000013A = 0;
  if ( ++math_mode == 3 )
    math_mode = 4;
  if ( (signed int)math_mode > 7 )
    math_mode = 0;
  dword_20000258[0] = 0;
  dword_2000025C = 0;
  dword_20000260 = 0;
  digits_clear_4();
  digit_1_decimal = 0;
  digit_2_decimal = 0;
  digit_3_decimal = 0;
  digit_4_decimal = 0;
  dword_200000C0 = 0;
  dword_200000C8 = 0;
  dword_20000128 = 0;
  for ( dword_20000100 = 0; (unsigned int)dword_20000100 < 0xA; ++dword_20000100 )
    digits_4[dword_20000100] = 11;
  dword_20000B9C = 0;
  dword_20000BA0 = 0;
  dword_20000BA4 = 0;
  if ( math_mode == 1 )
    digit_4_decimal = 1;
  if ( math_mode == 2 )
    digit_4_decimal = 2;
  byte_2000009D = 0;
  byte_2000005B = 0;
  result = 10;
  timer_count = 10;
  byte_20000182 = 10;
  return result;
}























signed int sub_800487C()
{
  signed int result; 

  if ( v4002200C & 1 )
  {
    result = 1;
  }
  else if ( v4002200C & 0x10 )
  {
    result = 2;
  }
  else if ( v4002200C & 4 )
  {
    result = 3;
  }
  else
  {
    result = 4;
  }
  return result;
}


void FLASH_lock()
{
  v40022010 |= 0x80u;
}


bool sub_80048CC()
{
  return (v4002201C & 6) != 0;
}


void sub_80048E8()
{
  v40022010 |= 0x2000u;
}


void sub_80048FC()
{
  v40022010 &= 0xFFFFFDFF;
}


int __fastcall FLASH_OB_write_RDP(__int16 a1)
{
  __int16 v1; 
  signed int v2; 
  signed int v3; 

  v1 = a1;
  v2 = sub_80049EC();
  if ( v2 == 4 )
  {
    v40022010 |= 0x20u;
    v40022010 |= 0x40u;
    v3 = sub_80049EC();
    v2 = v3;
    if ( v3 == 4 )
    {
      v40022010 &= 0xFFFFFFDF;
      v40022010 |= 0x10u;
      v1FFFF800 = v1;
      v2 = sub_80049EC();
      if ( v2 != 5 )
        v40022010 &= 0xFFFFFFEF;
    }
    else if ( v3 != 5 )
    {
      v40022010 &= 0xFFFFFFDF;
    }
  }
  return v2;
}


void FLASH_OB_unlock()
{
  if ( !(v40022010 & 0x200) )
    v40022008 = 0xCDEF89AB;
}


void FLASH_unlock()
{
  if ( v40022010 & 0x80 )
    v40022004 = 0xCDEF89AB;
}


signed int sub_80049EC()
{
  int v0; 
  signed int v1; 
  int v2; 

  v1 = sub_800487C();
  while ( v1 == 1 && v0 )
  {
    v1 = sub_800487C();
    v0 = v2 - 1;
  }
  if ( !v0 )
    v1 = 5;
  return v1;
}


int __fastcall gpio_init(int result, struc_gpio *a2)
{
  struc_gpio *v2; 
  unsigned int i; 

  v2 = a2;
  for ( i = 0; i < 0x10; ++i )
  {
    if ( (v2->pin & (1 << i)) == 1 << i )
    {
      if ( v2->mode == 1 || v2->mode == 2 )
      {
        *(_DWORD *)(result + 8) &= ~(3 << 2 * i);
        *(_DWORD *)(result + 8) |= v2->speed << 2 * i;
        *(_WORD *)(result + 4) &= ~(1 << i);
        *(_WORD *)(result + 4) |= v2->otype << i;
      }
      *(_DWORD *)result &= ~(3 << 2 * i);
      *(_DWORD *)result |= v2->mode << 2 * i;
      *(_DWORD *)(result + 12) &= ~(3 << 2 * i);
      *(_DWORD *)(result + 12) |= v2->pupd << 2 * i;
    }
  }
  return result;
}


int __fastcall gpio_set_AF(int result, signed int a2, int a3)
{
  *(_DWORD *)(result + 32 + 4 * (a2 >> 3)) &= ~(15 << (4 * a2 & 0x1F));
  *(_DWORD *)(result + 32 + 4 * (a2 >> 3)) |= a3 << (4 * a2 & 0x1F);
  return result;
}


bool __fastcall GPIO_Read(int a1, __int16 a2)
{
  return (unsigned __int16)(*(_WORD *)(a1 + 0x10) & a2) != 0;
}


void __fastcall GPIO_Reset(int result, __int16 a2)
{
  *(_WORD *)(result + 0x28) = a2;
}


void __fastcall GPIO_Set(int result, int a2)
{
  *(_DWORD *)(result + 0x18) = a2;
}


void __noreturn sub_8004B04()
{
  while ( 1 )
    ;
}


void fm_i2c_write_ack()
{
  GPIO_Reset(0x48000400, 2048);
  delay_cycles(60);
  GPIO_Reset(0x48000400, 1024);
  delay_cycles(60);
  GPIO_Set(0x48000400, 2048);
  delay_cycles(60);
  GPIO_Reset(0x48000400, 2048);
  delay_cycles(60);
}


void fm_i2c_write_nak()
{
  GPIO_Reset(1207960576, 2048);
  delay_cycles(60);
  GPIO_Set(1207960576, 1024);
  delay_cycles(60);
  GPIO_Set(1207960576, 2048);
  delay_cycles(60);
  GPIO_Reset(1207960576, 2048);
  delay_cycles(60);
}


int __fastcall fm_read_buf(_BYTE *buf, int count, int adr, int i2c_addr)
{
  _BYTE *v4; 
  int result; 

  v4 = buf;
  result = fm_i2c_start();
  if ( result )
  {
    fm_i2c_write(i2c_addr);
    if ( fm_i2c_getack() )
    {
      fm_i2c_write((unsigned int)(adr << 16) >> 24);
      fm_i2c_getack();
      fm_i2c_write((unsigned __int8)adr);
      fm_i2c_getack();
      fm_i2c_start();
      fm_i2c_write(i2c_addr | 1);
      fm_i2c_getack();
      while ( count )
      {
        *v4 = fm_i2c_read();
        if ( count == 1 )
          fm_i2c_write_nak();
        else
          fm_i2c_write_ack();
        ++v4;
        --count;
      }
      fm_i2c_stop();
      result = 1;
    }
    else
    {
      fm_i2c_stop();
      result = 0;
    }
  }
  return result;
}


int fm_i2c_read()
{
  signed int v0; 
  int v1; 
  signed int v2; 

  v0 = 8;
  v1 = 0;
  GPIO_Set(0x48000400, 0x400);
  while ( 1 )
  {
    v2 = v0;
    v0 = (unsigned __int8)(v0 - 1);
    if ( !v2 )
      break;
    v1 = 2 * v1 & 0xFF;
    GPIO_Reset(0x48000400, 0x800);
    delay_cycles(60);
    GPIO_Set(0x48000400, 0x800);
    delay_cycles(60);
    if ( v48000410 & 0x400 )
      v1 |= 1u;
  }
  GPIO_Reset(0x48000400, 2048);
  return v1;
}


void __fastcall fm_i2c_write(int a1)
{
  int v1; 
  signed int v2; 
  signed int v3; 

  v1 = a1;
  v2 = 8;
  while ( 1 )
  {
    v3 = v2;
    v2 = (unsigned __int8)(v2 - 1);
    if ( !v3 )
      break;
    GPIO_Reset(0x48000400, 0x800);
    delay_cycles(60);
    if ( v1 & 0x80 )
      GPIO_Set(0x48000400, 0x400);
    else
      GPIO_Reset(0x48000400, 0x400);
    v1 = 2 * v1 & 0xFF;
    delay_cycles(60);
    GPIO_Set(0x48000400, 0x800);
    delay_cycles(60);
  }
  GPIO_Reset(0x48000400, 0x800);
}


signed int fm_i2c_start()
{
  signed int result; 

  GPIO_Set(0x48000400, 1024);
  GPIO_Set(0x48000400, 2048);
  delay_cycles(60);
  GPIO_Reset(0x48000400, 1024);
  delay_cycles(60);
  if ( v48000410 & 0x400 )
  {
    result = 0;
  }
  else
  {
    GPIO_Reset(0x48000400, 1024);
    delay_cycles(60);
    result = 1;
  }
  return result;
}


void fm_i2c_stop()
{
  GPIO_Reset(1207960576, 2048);
  delay_cycles(60);
  GPIO_Reset(1207960576, 1024);
  delay_cycles(60);
  GPIO_Set(1207960576, 2048);
  delay_cycles(60);
  GPIO_Set(1207960576, 1024);
  delay_cycles(60);
}


signed int fm_i2c_getack()
{
  signed int result; 

  GPIO_Reset(1207960576, 2048);
  delay_cycles(60);
  GPIO_Set(1207960576, 1024);
  delay_cycles(60);
  GPIO_Set(1207960576, 2048);
  delay_cycles(60);
  if ( v48000410 & 0x400 )
  {
    GPIO_Reset(1207960576, 2048);
    result = 0;
  }
  else
  {
    GPIO_Reset(1207960576, 2048);
    result = 1;
  }
  return result;
}


signed int __fastcall fm_write_byte(int a1, int adr, int a3)
{
  int v3; 
  int v4; 
  int v5; 
  signed int result; 

  v3 = a1;
  v4 = adr;
  v5 = a3;
  result = fm_i2c_start();
  if ( result )
  {
    fm_i2c_write(v5);
    if ( fm_i2c_getack() )
    {
      fm_i2c_write((unsigned int)(v4 << 16) >> 24);
      fm_i2c_getack();
      fm_i2c_write((unsigned __int8)v4);
      fm_i2c_getack();
      fm_i2c_write(v3);
      fm_i2c_getack();
      fm_i2c_stop();
      delay_cycles8020(3u);
      result = 1;
    }
    else
    {
      fm_i2c_stop();
      result = 0;
    }
  }
  return result;
}


void __fastcall delay_cycles(int result)
{
  int i; 

  for ( i = result; i; --i )
    ;
}


void gpio_setup()
{
  sub_8008C04(0x4E0000, 1);
  sub_8008C44(0x200, 1);
  sub_8008C44(0x10000, 1);
  GPIO_Set(0x48000400, 0x1000);
  stru_20000160.pin = 1;
  stru_20000160.mode = 1;
  stru_20000160.otype = 0;
  stru_20000160.speed = 3;
  gpio_init(0x48000400, &stru_20000160);        
  stru_20000160.pin = 2;
  stru_20000160.speed = 1;
  stru_20000160.mode = IN;
  stru_20000160.pupd = 1;
  stru_20000160.otype = 0;
  gpio_init(0x48000400, &stru_20000160);        
  delay_mode_cycles(0xAu);
  GPIO_Reset(0x48000400, 1);
  stru_20000160.pin = 4;
  stru_20000160.mode = 2;
  stru_20000160.speed = 3;
  stru_20000160.otype = 0;
  stru_20000160.pupd = 0;
  gpio_init(0x48000000, &stru_20000160);        
  gpio_set_AF(0x48000000, 2, 0);                
  stru_20000160.pin = 0x1B;
  stru_20000160.mode = 3;
  gpio_init(0x48000000, &stru_20000160);        
  stru_20000160.pin = 0xC00;
  stru_20000160.speed = 1;
  stru_20000160.mode = 1;
  stru_20000160.pupd = 0;
  stru_20000160.otype = 1;
  gpio_init(0x48000400, &stru_20000160);        
  GPIO_Set(0x48000400, 0x400);
  GPIO_Set(0x48000400, 0x800);
  stru_20000160.pin = 0x30;
  stru_20000160.speed = 1;
  stru_20000160.mode = 1;
  stru_20000160.pupd = 0;
  stru_20000160.otype = 1;
  gpio_init(0x48000400, &stru_20000160);        
  GPIO_Set(0x48000400, 16);
  GPIO_Set(0x48000400, 32);
  stru_20000160.pin = 4;
  stru_20000160.speed = 3;
  stru_20000160.mode = 1;
  stru_20000160.pupd = 0;
  stru_20000160.otype = 0;
  gpio_init(0x48000400, &stru_20000160);        
  delay_mode_cycles(0xAu);
  GPIO_Reset(0x48000400, 4);
  stru_20000160.pin = 0x3000;
  stru_20000160.speed = 3;
  stru_20000160.mode = 1;
  stru_20000160.pupd = 0;
  stru_20000160.otype = 0;
  gpio_init(0x48000400, &stru_20000160);        
  stru_20000160.pin = 0x2000;
  stru_20000160.speed = 3;
  stru_20000160.mode = 1;
  stru_20000160.pupd = 0;
  stru_20000160.otype = 0;
  gpio_init(0x48000000, &stru_20000160);        
  stru_20000160.pin = 0x1000;
  stru_20000160.speed = 3;
  stru_20000160.mode = 1;
  stru_20000160.pupd = 0;
  stru_20000160.otype = 1;
  gpio_init(0x48000400, &stru_20000160);        
  stru_20000160.pin = 0x420;
  stru_20000160.speed = 3;
  stru_20000160.mode = 1;
  stru_20000160.pupd = 0;
  stru_20000160.otype = 1;
  gpio_init(0x48000000, &stru_20000160);        
  stru_20000160.pin = 0x80;
  stru_20000160.speed = 1;
  stru_20000160.mode = 0;
  stru_20000160.pupd = 1;
  stru_20000160.otype = 0;
  gpio_init(0x48000000, &stru_20000160);        
  stru_20000160.pin = 0xC000;
  stru_20000160.speed = 1;
  stru_20000160.mode = 0;
  stru_20000160.pupd = 1;
  stru_20000160.otype = 0;
  gpio_init(0x48000400, &stru_20000160);        
  stru_20000160.pin = 0x8800;
  gpio_init(0x48000000, &stru_20000160);        
  stru_20000160.pin = 0xC0;
  gpio_init(0x48001400, &stru_20000160);        
  stru_20000160.pin = 0x3C8;
  stru_20000160.speed = 3;
  stru_20000160.mode = 1;
  stru_20000160.pupd = 0;
  stru_20000160.otype = 0;
  gpio_init(0x48000400, &stru_20000160);        
  GPIO_Set(0x48000400, 0x1000);
}


void init_gpio_and_lcd()
{
  unsigned int i; 

  gpio_setup();
  beep_timer();
  beep_enable(0);
  GPIO_Reset(0x48000400, 8);
  lcd_init();
  for ( i = 0; i < 0x38; ++i )
    lcd_data[i] = -1;
  lcd_update();
}


void __fastcall sub_80050B8()
{
  unsigned int v0; 
  unsigned int v1; 
  unsigned int v2; 
  signed int v3; 

  if ( byte_20000090 && !byte_20000091 && (signed int)(unsigned __int16)word_20000062 >= 150 && current_state != 153 )
  {
    word_20000062 = 0;
    byte_20000091 = 1;
    byte_2000009E = 1;
    byte_200000AC = 1;
    byte_200000AE = 0;
    sub_800C8C0(byte_20000000);
    dword_200000D4 = 0;
    dword_200000D8 = 0;
    byte_20000078 = 0;
    timer_downcount = 3000;
    if ( math_mode )
    {
      if ( math_mode == 1 || math_mode == 2 )
        byte_20000078 = 1;
      if ( math_mode == 4 && byte_2000009D == 1 )
        byte_20000078 = 1;
      if ( math_mode == 5 )
        byte_20000078 = 1;
      if ( math_mode == 6 && byte_2000009D == 2 )
        byte_20000078 = 1;
      if ( math_mode == 7 && byte_2000009D == 1 )
        byte_20000078 = 1;
    }
    else
    {
      digit_1_decimal = math_mode;
      digit_2_decimal = math_mode;
      digit_3_decimal = math_mode;
      digit_4_decimal = math_mode;
      byte_2000009D = math_mode;
      dword_20000258[0] = math_mode;
      dword_2000025C = math_mode;
      dword_20000260 = math_mode;
      byte_200000F2 = math_mode;
      byte_20000114 = math_mode;
    }
    if ( current_state == 101 )
      current_state = 0;
    sub_8008F14();
  }
  if ( byte_20000019 && !byte_200000A7 )
  {
    switch ( byte_20000018 )
    {
      case 2:
        v1 = 150;
        if ( current_state && current_state != 0x99 && current_state != 203 )
          v1 = 75;
        if ( (unsigned __int16)word_20000014 > v1 )
        {
          if ( current_state == 203 )
          {
            if ( byte_200000F0 < 9 )
              ++byte_200000F0;
            beep_do(1, 8);
          }
          byte_200000A7 = 1;
        }
        break;
      case 3:
        v2 = 150;
        if ( current_state && current_state != 153 && current_state != 203 )
          v2 = 75;
        if ( (unsigned __int16)word_20000014 >= v2 )
        {
          v3 = 1;
          if ( byte_2000009D == 9 )
            v3 = 0;
          if ( (math_mode == 1 || math_mode == 2) && byte_20000114 )
            v3 = 0;
          if ( v3 == 1 )
          {
            if ( (signed int)++byte_20000000 > 5 )
              byte_20000000 = 0;
            fw_write_byte(5, byte_20000000);
            delay_cycles_16000(30);
            for ( dword_20000100 = 0; (unsigned int)dword_20000100 < 0xA; ++dword_20000100 )
              digits_4[dword_20000100] = 11;
            sub_800C8C0(byte_20000000);
            sub_8006B8C();
            byte_2000005E = 1;
          }
          timer_count = 0;
          byte_20000182 = 10;
          byte_200000A7 = 1;
          word_20000014 = 0;
          beep_do(1, 8);
        }
        break;
      case 4:
        if ( (signed int)(unsigned __int16)word_20000014 > 150 )
        {
          byte_200000A7 = 1;
          word_20000014 = 0;
          if ( current_state || !byte_200000F3 )
          {
            if ( current_state == 203 )
            {
              if ( byte_200000F0 > -9 )
                --byte_200000F0;
              beep_do(1, 8);
            }
          }
          else
          {
            current_state = 150;
            byte_200000F3 = 0;
            dword_200000D0 = dword_20000134;
            if ( (signed int)(unsigned __int8)byte_20000190 >= 30 )
            {
              byte_20000190 = 30;
              tmpbuf_to_eeprom();
              current_state = 154;
              beep_do(3, 8);
            }
            else
            {
              ++byte_20000190;
              tmpbuf_to_eeprom();
              beep_do(1, 8);
            }
          }
        }
        break;
      case 5:
        v0 = 150;
        if ( current_state && current_state != 153 && current_state != 203 )
          v0 = 75;
        if ( (unsigned __int16)word_20000014 >= v0 )
        {
          if ( byte_20000059 )
          {
            byte_20000059 = 0;
            current_state = 0xCBu;
            byte_200000A7 = 1;
            byte_20000019 = 0;
          }
          else
          {
            if ( (signed int)current_state < 0x96 )
            {
              GPIO_Set(0x48000400, 8);
              lcd_fill(0, 56, 0);
              lcd_update();
              disable_laser();
              delay_cycles_16000(100);
              beep_do(1, 8);
              while ( (signed int)(unsigned __int8)byte_20000198 > 0 )
                ;
              GPIO_Reset(0x48000400, 0x200);    
              GPIO_Set(0x48000400, 1);
              delay_cycles_16000(250);
              GPIO_Set(0x48000400, 1);
              delay_cycles_16000(250);
              while ( 1 )
                ;
            }
            if ( current_state == 153 )
            {
              byte_20000190 = 0;
              fw_write_byte(6, 0);
              sub_800BC68();
              digits_clear_4();
              beep_do(2, 8);
              byte_200000A7 = 1;
              byte_20000019 = 0;
            }
          }
        }
        break;
    }
  }
}



































void __cdecl button_handler()
{
  char v0; 
  char v1; 
  __int16 v2; 
  __int16 v3; 
  char v4; 

  byte_20000016 = 0;
  byte_20000017 = GPIO_Read(0x48000000, 0x80);
  if ( byte_20000017 )
  {
    if ( byte_20000090 && !someflag && !byte_20000091 )
    {
      beep_do(1, 8);
      if ( (signed int)current_state <= 200 )
      {
        if ( current_state == 153 )
        {
          math_mode = 0;
          sub_800BC68();
          digits_clear_4();
          byte_2000018E = 1;
          dword_200000C8 = 0;
          dword_200000C0 = 0;
        }
        sub_8008F14();
        byte_200000AE = 0;
      }
      else
      {
        if ( current_state == 203 )
        {
          current_state = 0;
          byte_20000059 = 0;
          fw_write_byte(8, (unsigned __int8)byte_200000F0);
          delay_cycles_16000(30);
          byte_2000005E = 1;
        }
        if ( current_state == 204 )
        {
          current_state = 0;
          fw_write_byte(9, byte_2000017E);
          delay_cycles_16000(30);
          byte_2000005E = 1;
        }
      }
    }
    byte_20000090 = 0;
    byte_20000091 = 0;
    word_20000062 = 0;
    if ( someflag )
    {
      if ( !GPIO_Read(0x48000400, 0x8000) && !GPIO_Read(0x48001400, 0x40) )
      {
        somemagicflag = 1;
        current_state = 204;
        word_20000156 = 0;
        word_200000DC = 0;
        word_200000DE = 0;
        LODWORD(dword_200000E4) = 0;
        LODWORD(dword_200000EC) = 0;
        byte_200000F0 = 0;
        byte_2000013F = 0;
      }
      someflag = 0;
      if ( !somemagicflag )
        byte_20000018 = somemagicflag;
      word_20000014 = 0;
    }
  }
  else if ( (signed int)(unsigned __int16)++word_20000062 >= 1 && !someflag )
  {
    if ( !byte_20000090 )
    {
      timer_downcount = 3000;
      word_2000001E = 30;
      byte_20000090 = 1;
      word_20000094 = 0;
      if ( (signed int)current_state > 0 && (signed int)current_state <= 99 && !math_mode && !byte_20000091 )
      {
        if ( byte_2000009E )
        {
          if ( (signed int)(unsigned __int8)byte_2000017F > 0 )
          {
            byte_200000AD = 1;
            byte_2000009E = 0;
            disable_laser();
            byte_2000009E = 0;
            current_state = 0;
            byte_200000AC = 0;
            beep_do(1, 8);
          }
        }
        else if ( current_state == 99 )
        {
          byte_200000AC = 1;
        }
        byte_20000091 = 1;
        if ( byte_2000005D == 1 )
        {
          apd_pwm_value = word_2000008C;
          apd_dcdc_set(word_2000008C);
        }
      }
      if ( current_state == 98 && !math_mode && !byte_20000091 && !byte_2000009E )
      {
        byte_200000AC = 1;
        byte_20000091 = 1;
      }
      if ( current_state == 93 )
      {
        disable_laser();
        byte_2000009E = 0;
        current_state = 0;
        byte_200000AC = 0;
        byte_20000090 = 0;
        byte_20000091 = 1;
        beep_do(1, 8);
      }
    }
    if ( byte_200000AE == 1 )
      byte_200000AE = 0;
  }
  byte_20000017 = GPIO_Read(0x48000000, 0x8000);
  if ( !byte_20000017 )
  {
    byte_20000016 = 1;
    timer_downcount = 3000;
    word_2000001E = 30;
    if ( byte_20000018 == 1 )
    {
      if ( (signed int)(unsigned __int16)++word_20000014 > 2 )
        byte_20000019 = 1;
    }
    else
    {
      word_20000014 = 0;
      byte_20000018 = 1;
    }
  }
  byte_20000017 = GPIO_Read(0x48001400, 128);
  if ( !byte_20000017 )
  {
    byte_20000016 = 1;
    timer_downcount = 3000;
    word_2000001E = 30;
    if ( byte_20000018 == 2 )
    {
      if ( (signed int)(unsigned __int16)++word_20000014 > 2 )
        byte_20000019 = 1;
    }
    else
    {
      word_20000014 = 0;
      byte_20000018 = 2;
    }
  }
  byte_20000017 = GPIO_Read(0x48001400, 64);
  if ( !byte_20000017 )
  {
    timer_downcount = 3000;
    word_2000001E = 30;
    byte_20000016 = 1;
    if ( byte_20000018 == 3 )
    {
      if ( (signed int)(unsigned __int16)++word_20000014 > 2 )
        byte_20000019 = 1;
    }
    else
    {
      word_20000014 = 0;
      byte_20000018 = 3;
    }
  }
  byte_20000017 = GPIO_Read(0x48000000, 0x800);
  if ( !byte_20000017 )
  {
    byte_20000016 = 1;
    timer_downcount = 3000;
    word_2000001E = 30;
    if ( byte_20000018 == 4 )
    {
      if ( (signed int)(unsigned __int16)++word_20000014 > 2 )
        byte_20000019 = 1;
    }
    else
    {
      word_20000014 = 0;
      byte_20000018 = 4;
    }
  }
  byte_20000017 = GPIO_Read(0x48000400, 0x8000);
  if ( !byte_20000017 )
  {
    byte_20000016 = 1;
    timer_downcount = 3000;
    word_2000001E = 30;
    if ( byte_20000018 == 5 )
    {
      if ( (signed int)(unsigned __int16)++word_20000014 > 2 )
        byte_20000019 = 1;
    }
    else
    {
      word_20000014 = 0;
      byte_20000018 = 5;
    }
  }
  if ( !byte_20000016 )
  {
    dword_20000074 = (unsigned __int8)byte_20000016;
    byte_2000008E = byte_20000016;
    word_20000014 = (unsigned __int8)byte_20000016;
    v0 = byte_20000018 == 5;
    while ( v0 && byte_20000019 )
    {
      v0 = byte_200000A7 == 0;
      if ( !byte_200000A7 )
      {
        byte_2000006C = 1;
        beep_do(1, 8);
        byte_2000009E = 0;
        byte_200000AE = 0;
        error_no = 0;
        somemagicflag = 0;
        byte_2000010D = 0;
        byte_2000005D = 0;
        byte_2000010C = 0;
        byte_20000059 = 0;
        byte_2000010E = 0;
        ++word_20000094;
        dword_200000C8 = 0;
        for ( dword_20000100 = 0; (unsigned int)dword_20000100 < 0xA; ++dword_20000100 )
          digits_4[dword_20000100] = 11;
        if ( (signed int)current_state <= 200 )
        {
          if ( current_state == 153 )
          {
            if ( (unsigned __int8)byte_2000018E < (signed int)(unsigned __int8)byte_20000190 )
            {
              fm_shift_saved((unsigned __int8)byte_2000018E);
              fw_write_byte(6, (unsigned __int8)--byte_20000190);
              byte_2000009D = 0;
              byte_200000F2 = 0;
              digit_1_decimal = 0;
              digit_2_decimal = 0;
              digit_3_decimal = 0;
              digit_4_decimal = 0;
              eeprom_to_tmpbuf();
            }
            else
            {
              fw_write_byte(6, (unsigned __int8)--byte_20000190);
              if ( (signed int)(unsigned __int8)byte_2000018E <= 1 )
              {
                math_mode = 0;
                sub_800BC68();
                digits_clear_4();
                byte_2000018E = 1;
              }
              else
              {
                --byte_2000018E;
                byte_2000009D = 0;
                byte_200000F2 = 0;
                digit_1_decimal = 0;
                digit_2_decimal = 0;
                digit_3_decimal = 0;
                digit_4_decimal = 0;
                eeprom_to_tmpbuf();
              }
            }
          }
          else if ( current_state )
          {
            if ( math_mode && (signed int)(unsigned __int16)word_20000094 <= 1 )
            {
              if ( byte_2000009D )
              {
                byte_2000005E = 1;
                error_no = 0;
                if ( (signed int)(unsigned __int8)byte_2000009D > 0 )
                  dword_20000258[3 - (unsigned __int8)byte_2000009D--] = 0;
                num_result = 0;
                dword_200000C8 = 0;
              }
              else
              {
                disable_laser();
                byte_200000AD = 1;
                byte_2000009E = 0;
                byte_2000006C = 1;
                error_no = 0;
                current_state = 0;
                sub_800BC68();
                sub_800C8C0(byte_20000000);
                math_mode = 0;
                byte_2000018E = 1;
                dword_200000C0 = 0;
                digits_clear_4();
              }
              byte_2000005E = 1;
            }
            else
            {
              if ( dword_20000260 )
              {
                if ( math_mode == 1 )
                  digit_4_decimal = 1;
                if ( math_mode == 2 )
                  digit_4_decimal = 2;
              }
              else
              {
                math_mode = 0;
              }
              sub_800BC68();
              disable_laser();
              byte_200000AD = 1;
              byte_2000009E = 0;
              num_result = 0;
              dword_200000C8 = 0;
              error_no = 0;
              current_state = 0;
              if ( math_mode == 1 )
                digit_4_decimal = 1;
              if ( math_mode == 2 )
                digit_4_decimal = 2;
              byte_2000018E = 1;
              dword_200000C0 = 0;
              digits_clear_4();
              byte_2000005E = 1;
            }
          }
          else if ( (signed int)(unsigned __int8)byte_20000114 <= 0 )
          {
            dword_20000128 = 0;
            byte_2000006A = 0;
            if ( math_mode )
            {
              if ( byte_2000009D == 9 )
                word_20000094 = 2;
              if ( (signed int)(unsigned __int16)word_20000094 <= 1 )
              {
                byte_2000005E = 1;
                error_no = 0;
                if ( (signed int)(unsigned __int8)byte_2000009D <= 0 )
                {
                  sub_800BC68();
                  sub_800C8C0(byte_20000000);
                  math_mode = 0;
                  byte_2000018E = 1;
                  dword_200000C0 = 0;
                  num_result = 0;
                  dword_200000C8 = 0;
                  digits_clear_4();
                }
                else
                {
                  dword_20000258[3 - (unsigned __int8)byte_2000009D--] = 0;
                  byte_20000090 = 1;
                }
                num_result = 0;
                dword_200000C8 = 0;
              }
              else
              {
                sub_800BC68();
                sub_800C8C0(byte_20000000);
                math_mode = 0;
                byte_2000018E = 1;
                dword_200000C0 = 0;
                num_result = 0;
                dword_200000C8 = 0;
                digits_clear_4();
              }
            }
            else
            {
              error_no = math_mode;
              byte_2000005E = 1;
              dword_20000260 = 0;
              dword_2000025C = 0;
              dword_20000258[0] = 0;
              dword_200000C8 = 0;
              byte_200000F3 = 0;
              dword_200000C0 = 0;
              digits_clear_4();
              byte_2000006A = 0;
            }
          }
          else
          {
            if ( byte_2000009D != 2 || math_mode )
            {
              sub_800BC68();
              math_mode = 0;
              byte_20000114 = 0;
              dword_20000258[0] = 0;
              dword_200000C8 = 0;
              byte_2000009D = 0;
              error_no = 0;
            }
            else if ( (signed int)(unsigned __int16)word_20000094 >= 2 )
            {
              sub_800BC68();
              math_mode = 0;
              byte_20000114 = 0;
              dword_20000258[0] = 0;
              dword_200000C8 = 0;
              byte_2000009D = 0;
              error_no = 0;
            }
            else if ( byte_20000114 == 2 )
            {
              dword_20000128 = dword_2000025C;
              dword_200000C8 = 0;
              dword_20000258[0] = 0;
            }
            else
            {
              byte_2000009D = 0;
              dword_20000128 -= 10 * sub_80001BC(dword_200000C8 + 5, 0xAu);
              dword_2000025C = dword_20000128;
              dword_200000C8 = 0;
              dword_20000258[0] = 0;
              byte_2000005C = 1;
            }
            byte_2000005E = 1;
          }
        }
        else
        {
          current_state = 0;
        }
        break;
      }
    }
    v1 = byte_20000018 == 4;
    while ( v1 )
    {
      byte_2000005B = 1;
      timer_count = 0;
      byte_20000182 = 10;
      if ( !byte_20000019 )
        break;
      v1 = byte_200000A7 == 0;
      if ( !byte_200000A7 )
      {
        if ( byte_2000005D )
        {
          apd_pwm_value += 2;
          apd_dcdc_set(apd_pwm_value);
        }
        else
        {
          if ( (signed int)current_state < 2 && somemagicflag == 1 )
          {
            if ( byte_200000AA )
            {
              if ( 10000 - (unsigned int)byte_800F810[(unsigned __int8)byte_2000013E] < dword_200000CC )
              {
                v3 = sub_80001BC(dword_200000CC - (10000 - byte_800F810[(unsigned __int8)byte_2000013E]), 0xAu);
                word_200000DE = v3 | 0x8000;
                fw_write_byte(12, (unsigned __int8)v3);
                delay_cycles_16000(30);
                fw_write_byte(13, (signed int)(unsigned __int16)word_200000DE >> 8);
                delay_cycles_16000(30);
              }
              else
              {
                word_200000DE = sub_80001BC(
                                  10000 - dword_200000CC - byte_800F810[(unsigned __int8)byte_2000013E] + 5,
                                  0xAu);
                fw_write_byte(12, (unsigned __int8)word_200000DE);
                delay_cycles_16000(30);
                fw_write_byte(13, (signed int)(unsigned __int16)word_200000DE >> 8);
                delay_cycles_16000(30);
              }
              byte_200000F0 = 0;
              fw_write_byte(8, 0);
              delay_cycles_16000(30);
              beep_enabled = 1;
              fw_write_byte(7, 1);
              delay_cycles_16000(30);
              JUMPOUT(&loc_800E18C);
            }
            if ( 10000 - (unsigned int)byte_800F810[(unsigned __int8)byte_2000013E] < dword_200000CC )
            {
              v2 = sub_80001BC(dword_200000CC - (10000 - byte_800F810[(unsigned __int8)byte_2000013E]), 0xAu);
              word_200000DC = v2 | 0x8000;
              fw_write_byte(10, (unsigned __int8)v2);
              delay_cycles_16000(30);
              fw_write_byte(11, (signed int)word_200000DC >> 8);
              delay_cycles_16000(30);
            }
            else
            {
              word_200000DC = sub_80001BC(
                                10000 - dword_200000CC - byte_800F810[(unsigned __int8)byte_2000013E] + 5,
                                0xAu);
              fw_write_byte(10, (unsigned __int8)word_200000DC);
              delay_cycles_16000(30);
              fw_write_byte(11, (signed int)word_200000DC >> 8);
              delay_cycles_16000(30);
            }
            byte_200000AA = 1;
            byte_2000013F = 1;
            byte_2000005E = 1;
          }
          if ( current_state == 203 )
          {
            if ( byte_200000F0 > (signed int)-9u )
              --byte_200000F0;
          }
          else if ( current_state == 153 )
          {
            uart1_send_string("ATF0#");
            math_mode = 0;
            sub_800BC68();
            digits_clear_4();
            byte_2000018E = 1;
            dword_200000C8 = 0;
            dword_200000C0 = 0;
          }
          else
          {
            if ( (signed int)(unsigned __int8)byte_20000190 > 0 && !current_state && !somemagicflag )
            {
              byte_2000018E = 1;
              byte_2000009D = 0;
              byte_200000F2 = 0;
              digit_1_decimal = 0;
              digit_2_decimal = 0;
              digit_3_decimal = 0;
              digit_4_decimal = 0;
              eeprom_to_tmpbuf();
              current_state = 153;
              dword_20000258[0] = 0;
              dword_2000025C = 0;
              dword_20000260 = 0;
              byte_2000006A = 0;
              byte_200000F2 = 0;
              byte_20000114 = 0;
              math_mode = 0;
              byte_2000009D = 0;
              byte_20000058 = 50;
            }
            uart1_send_string("ATF1#");
          }
        }
        word_20000014 = 0;
        beep_do(1, 8);
        byte_200000A7 = 1;
        break;
      }
    }
    if ( byte_20000018 == 3 && byte_20000019 && !byte_200000A7 )
    {
      if ( !somemagicflag )
      {
        if ( (signed int)(unsigned __int8)++byte_2000013E > 1 )
          byte_2000013E = 0;
        if ( byte_2000005D )
        {
          if ( selected_laser )
          {
            GPIO_Reset(0x48000400, 0x2000);
            selected_laser = 0;
          }
          else
          {
            GPIO_Set(0x48000400, 0x2000);
            selected_laser = 1;
          }
        }
      }
      timer_count = 0;
      byte_20000182 = 10;
      word_20000014 = 0;
      beep_do(1, 8);
      byte_200000A7 = 1;
    }
    if ( byte_20000018 == 1 && byte_20000019 && !byte_200000A7 )
    {
      if ( byte_2000005D == 1 )
      {
        if ( (signed int)++si_cfg >= 4 )
          si_cfg = 0;
        si_write_config(si_cfg);
      }
      else if ( !somemagicflag )
      {
        if ( current_state == 153 )
        {
          if ( (unsigned __int8)byte_2000018E >= (signed int)(unsigned __int8)byte_20000190 )
            byte_2000018E = 1;
          else
            ++byte_2000018E;
          byte_2000009D = 0;
          byte_200000F2 = 0;
          digit_1_decimal = 0;
          digit_2_decimal = 0;
          digit_3_decimal = 0;
          digit_4_decimal = 0;
          eeprom_to_tmpbuf();
        }
        else
        {
          sub_8004758();
        }
      }
      byte_200000A7 = 1;
      word_20000014 = 0;
      beep_do(1, 8);
      byte_2000009D = 0;
    }
    v4 = byte_20000018 == 2;
    while ( v4 && byte_20000019 )
    {
      v4 = byte_200000A7 == 0;
      if ( !byte_200000A7 )
      {
        byte_2000005B = 1;
        timer_count = 0;
        byte_20000182 = 10;
        if ( byte_2000005D )
        {
          apd_pwm_value -= 2;
          apd_dcdc_set(apd_pwm_value);
        }
        else
        {
          if ( current_state )
          {
            if ( (math_mode == 1 || math_mode == 2) && (byte_2000009D == 2 || !byte_2000009D) )
            {
              if ( byte_20000114 == 2 )
              {
                if ( !dword_20000B9C )
                {
                  dword_20000BA0 = dword_20000B9C;
                  dword_20000BA4 = dword_20000B9C;
                  byte_2000009D = dword_20000B9C;
                  byte_20000114 = 1;
                  sub_800BC68();
                  dword_200000C8 = 0;
                  byte_2000005E = 1;
                  dword_20000BA4 += dword_20000BA0;
                  dword_20000BA0 = dword_20000B9C;
                  dword_20000B9C = num_result;
                  digit_4_decimal = math_mode;
                  byte_20000090 = 1;
                  byte_2000013A = 0;
                }
              }
              else if ( byte_20000114 == 1 && !dword_20000BA4 && !dword_20000BA0 )
              {
                dword_20000B9C = dword_20000BA0;
                dword_20000BA4 = dword_20000BA0;
                byte_2000009D = dword_20000BA0;
                byte_20000114 = 2;
                sub_800BC68();
                dword_200000C8 = 0;
                byte_2000005E = 1;
                if ( byte_2000013A )
                  dword_20000B9C += num_result;
                else
                  dword_20000BA4 = num_result;
                digit_4_decimal = math_mode;
                byte_20000090 = 1;
                ++byte_2000013A;
              }
              for ( dword_20000100 = 0; (unsigned int)dword_20000100 < 0xA; ++dword_20000100 )
                digits_4[dword_20000100] = 11;
            }
          }
          else if ( math_mode )
          {
            if ( math_mode == 1 || math_mode == 2 )
            {
              if ( (unsigned __int8)byte_2000009D == math_mode + 1 )
              {
                if ( byte_20000114 != 1 && byte_20000114 )
                {
                  byte_2000009D = 0;
                  byte_20000114 = 2;
                  sub_800BC68();
                  dword_200000C8 = 0;
                  byte_2000005E = 1;
                  if ( byte_2000013A )
                    dword_20000B9C += num_result;
                  else
                    dword_20000BA4 = num_result;
                  digit_4_decimal = math_mode;
                  byte_20000090 = 1;
                  ++byte_2000013A;
                }
                else
                {
                  byte_2000009D = 0;
                  byte_20000114 = 1;
                  sub_800BC68();
                  dword_200000C8 = 0;
                  byte_2000005E = 1;
                  dword_20000BA4 += dword_20000BA0;
                  dword_20000BA0 = dword_20000B9C;
                  dword_20000B9C = num_result;
                  digit_4_decimal = math_mode;
                  byte_20000090 = 1;
                  byte_2000013A = 0;
                }
              }
              for ( dword_20000100 = 0; (unsigned int)dword_20000100 < 0xA; ++dword_20000100 )
                digits_4[dword_20000100] = 11;
            }
          }
          else if ( !somemagicflag )
          {
            byte_200000F2 = somemagicflag;
            dword_20000258[0] = (unsigned __int8)somemagicflag;
            dword_2000025C = (unsigned __int8)somemagicflag;
            dword_20000260 = (unsigned __int8)somemagicflag;
            if ( byte_2000009D )
            {
              byte_2000009D = 0;
              digit_4_decimal = 0;
              dword_2000025C = dword_20000128;
              dword_200000C0 = dword_20000128;
              if ( byte_20000114 == 1 )
                byte_20000114 = 2;
              else
                byte_20000114 = 1;
            }
            else
            {
              digit_4_decimal = byte_2000009D;
              dword_2000025C = dword_200000C0;
              dword_20000128 = dword_200000C0;
              if ( byte_20000114 == 1 )
                byte_20000114 = 2;
              else
                byte_20000114 = 1;
            }
            for ( dword_20000100 = 0; (unsigned int)dword_20000100 < 0xA; ++dword_20000100 )
              digits_4[dword_20000100] = 11;
            dword_20000258[0] = 0;
            byte_2000006A = 0;
          }
          if ( current_state == 204 && (signed int)++byte_2000017E > 7 )
            byte_2000017E = 0;
          if ( current_state == 153 )
          {
            if ( (signed int)(unsigned __int8)byte_2000018E <= 1 )
              byte_2000018E = byte_20000190;
            else
              --byte_2000018E;
            byte_2000009D = 0;
            byte_200000F2 = 0;
            digit_1_decimal = 0;
            digit_2_decimal = 0;
            digit_3_decimal = 0;
            digit_4_decimal = 0;
            eeprom_to_tmpbuf();
          }
          if ( current_state == 203 && byte_200000F0 < 9 )
            ++byte_200000F0;
        }
        beep_do(1, 8);
        break;
      }
    }
    byte_20000018 = 0;
    word_20000014 = 0;
    byte_20000019 = 0;
    byte_200000A7 = 0;
  }
  if ( byte_20000019 )
  {
    if ( current_state == 101 )
      current_state = 0;
  }
}
































































void __fastcall lcd_send_cmd(int a1)
{
  signed int i; 

  GPIO_Reset(0x48000400, 0x100);
  GPIO_Reset(0x48000400, 0x40);
  delay_cycles1(60u);
  GPIO_Reset(0x48000400, 0x80);
  delay_cycles1(60u);
  GPIO_Set(0x48000400, 0x40);
  for ( i = 0; i < 8; i = (unsigned __int8)(i + 1) )
  {
    GPIO_Reset(0x48000400, 0x40);
    if ( a1 & 0x80 )
      GPIO_Set(0x48000400, 0x80);
    else
      GPIO_Reset(0x48000400, 0x80);
    delay_cycles1(60u);
    GPIO_Set(0x48000400, 0x40);
    delay_cycles1(60u);
    a1 = 2 * a1 & 0xFF;
  }
  GPIO_Set(0x48000400, 0x100);
}


void lcd_init()
{
  GPIO_Reset(0x48000400, 0x200);
  delay_cycles1(5000u);
  GPIO_Set(0x48000400, 0x200);
  delay_cycles1(5000u);
  lcd_send_cmd(47);
  lcd_send_cmd(52);
  lcd_send_cmd(177);
  lcd_send_cmd(30);
  lcd_send_cmd(178);
  lcd_send_cmd(15);
  lcd_send_cmd(20);
  lcd_send_cmd(160);
  lcd_send_cmd(148);
  lcd_send_cmd(104);
  lcd_send_cmd(61);
  lcd_send_cmd(136);
  lcd_send_cmd(136);
  lcd_send_cmd(136);
  lcd_send_cmd(136);
  lcd_send_cmd(96);
  lcd_send_cmd(227);
}


void lcd_draw()
{
  char *v0; 
  int v1; 
  int v2; 

  if ( !error_no && (byte_2000005C || byte_2000005E) )
  {
    sub_800C8C0(byte_20000000);
    sub_8006B8C();
  }
  lcd_fill(0, 56, 0);
  if ( current_state == 153 )
  {
    byte_20000124 = (tmpbuf[1] & 0x70) >> 4;
    byte_200000AB = tmpbuf[1] & 0xF;
    byte_20000125 = tmpbuf[0] & 0xF;
    byte_2000006A = (signed int)(unsigned __int8)tmpbuf[0] >> 4;
    sub_800C8C0(byte_20000124);
    dword_200000D0 = *(_DWORD *)&tmpbuf[16];
    dword_200000C0 = *(_DWORD *)&tmpbuf[16];
    sub_8008AE4(*(unsigned int *)&tmpbuf[16], byte_200000F9);
    byte_200000F9 = byte_2000007B;
    copy_digits(3);
    digit_4_decimal = 0;
    if ( (tmpbuf[1] & 0xF) == 1 )
      digit_4_decimal = 1;
    if ( (tmpbuf[1] & 0xF) == 2 )
      digit_4_decimal = 2;
    if ( (tmpbuf[1] & 0xF) == 3 )
      digit_4_decimal = 1;
    dword_20000260 = *(_DWORD *)&tmpbuf[4];
    dword_2000025C = *(_DWORD *)&tmpbuf[8];
    dword_20000258[0] = *(_DWORD *)&tmpbuf[12];
    if ( byte_200000AB == 1 && byte_20000125 == 9 )
    {
      digit_1_decimal = 1;
      digit_2_decimal = 1;
      digit_3_decimal = 1;
    }
    if ( byte_200000AB == 2 && byte_20000125 == 9 )
    {
      digit_1_decimal = 2;
      digit_2_decimal = 2;
      digit_3_decimal = 2;
    }
  }
  lcd_battery_symbol();
  sub_8004178();
  lcd_clear_digits4();
  lcd_err();
  sub_8003568();
  if ( (signed int)current_state < 200 )
  {
    sub_80035B4(current_state, v0);
    lcd_symbols_xx();
    lcd_convert_digits();
    lcd_write_number_4();
    lcd_symbols_();
  }
  v1 = current_state;
  if ( current_state == 155 )
  {
    current_state = 0;
    lcd_data[45] |= 0x20u;
    lcd_segment_x2(22);
    lcd_segment_x1(18);
    lcd_segment_xx(16);
  }
  else
  {
    if ( (signed int)current_state <= 155 )
    {
      switch_(current_state - 150, (int)v0);
      v1 = 4 * v2;
    }
    if ( v1 != 160 && v1 != 199 )
    {
      if ( v1 == 203 )
      {
        if ( byte_2000005B )
        {
          if ( byte_200000F0 < 0 )
            lcd_data[22] |= 0x20u;
          lcd_segment_4_2(digits_4[9]);
        }
        lcd_segment_3_1(15, 10, 8);
        lcd_segment_3_1(14, 10, 0x20);
        lcd_segment_3_1(16, 10, 0x80);
      }
      else if ( v1 == 204 )
      {
        sub_80033B8();
      }
    }
  }
  if ( somemagicflag )
  {
    lcd_write_number_xx();
    lcd_data[45] |= 0x20u;
    if ( byte_2000013F & 1 )
      lcd_data[31] |= 0x54u;
    if ( byte_2000013F & 2 )
      lcd_data[3] |= 0xA8u;
  }
  lcd_update();
}






















void __cdecl eeprom_to_tmpbuf()
{
  int v0; 
  char *v1; 
  unsigned int i; 

  byte_2000018F = byte_2000018E - 1;
  v0 = 20 * (unsigned __int8)(byte_2000018E - 1) + 32;
  v1 = tmpbuf;
  for ( i = 0; i < 0x14; i = (unsigned __int8)(i + 1) )
    *v1++ = fm_read_byte(v0++);
  byte_2000005E = 1;
}





void __fastcall sub_8006B8C()
{
  int *v0; 
  int v1; 
  int v2; 
  float v3; 
  float v4; 
  double v5; 
  double v6; 
  float v7; 
  float v8; 
  double v9; 
  double v10; 
  float v11; 
  int v12; 
  float v13; 
  float v14; 
  double v15; 
  double v16; 
  double v17; 
  double v18; 
  float v19; 
  float v20; 
  float v21; 
  double v22; 
  double v23; 
  int v24; 
  float v25; 
  float v26; 
  double v27; 
  double v28; 
  float v29; 
  float v30; 
  double v31; 
  double v32; 
  float v33; 
  float v34; 
  float v35; 
  double v36; 
  double v37; 
  int v38; 
  int v39; 
  float v40; 
  float v41; 
  double v42; 
  double v43; 
  float v44; 
  float v45; 
  double v46; 
  double v47; 
  float v48; 
  float v49; 
  double v50; 
  double v51; 
  float v52; 
  float v53; 
  float v54; 
  float v55; 
  double v56; 
  double v57; 
  int v58; 
  float v59; 
  float v60; 
  double v61; 
  double v62; 
  float v63; 
  float v64; 
  double v65; 
  double v66; 
  double v67; 
  double v68; 
  float v69; 
  float v70; 
  float v71; 
  float v72; 
  double v73; 
  double v74; 
  float v75; 
  float v76; 
  double v77; 
  double v78; 
  float v79; 
  float v80; 
  double v81; 
  double v82; 
  float v83; 
  float v84; 
  double v85; 
  double v86; 
  float v87; 
  float v88; 
  float v89; 
  float v90; 
  double v91; 
  double v92; 
  int v93; 
  float v94; 
  float v95; 
  double v96; 
  double v97; 
  float v98; 
  float v99; 
  double v100; 
  double v101; 
  float v102; 
  float v103; 
  double v104; 
  double v105; 
  float v106; 
  int v107; 
  double v108; 
  double v109; 
  float v110; 
  float v111; 
  double v112; 
  double v113; 
  float v114; 
  float v115; 
  double v116; 
  double v117; 
  float v118; 
  float v119; 
  double v120; 
  double v121; 
  float v122; 
  float v123; 
  float v124; 
  float v125; 
  double v126; 
  double v127; 
  double v128; 
  int v129; 
  float v130; 
  float v131; 
  double v132; 
  double v133; 
  float v134; 
  float v135; 
  double v136; 
  double v137; 
  float v138; 
  float v139; 
  double v140; 
  double v141; 
  int v142; 
  double v143; 
  double v144; 
  float v145; 
  float v146; 
  double v147; 
  double v148; 
  float v149; 
  float v150; 
  double v151; 
  double v152; 
  float v153; 
  float v154; 
  double v155; 
  double v156; 
  float v157; 
  float v158; 
  float v159; 
  float v160; 
  double v161; 
  double v162; 
  double v163; 
  float v164; 
  float v165; 
  double v166; 
  double v167; 
  float v168; 
  float v169; 
  double v170; 
  double v171; 
  float v172; 
  float v173; 
  double v174; 
  double v175; 
  int v176; 
  double v177; 
  double v178; 
  float v179; 
  float v180; 
  double v181; 
  double v182; 
  float v183; 
  float v184; 
  double v185; 
  double v186; 
  float v187; 
  float v188; 
  double v189; 
  double v190; 
  float v191; 
  float v192; 
  float v193; 
  float v194; 
  double v195; 
  double v196; 
  double v197; 
  int v198; 
  float v199; 
  float v200; 
  double v201; 
  double v202; 
  float v203; 
  float v204; 
  double v205; 
  double v206; 
  int v207; 
  float v208; 
  float v209; 
  float v210; 
  double v211; 
  double v212; 
  double v213; 
  int v214; 
  float v215; 
  float v216; 
  float v217; 
  double v218; 
  double v219; 
  double v220; 
  float v221; 
  float v222; 
  double v223; 
  double v224; 
  float v225; 
  float v226; 
  double v227; 
  double v228; 
  int v229; 
  float v230; 
  float v231; 
  float v232; 
  double v233; 
  double v234; 
  double v235; 
  int v236; 
  float v237; 
  float v238; 
  float v239; 
  double v240; 
  double v241; 
  double v242; 
  float v243; 
  float v244; 
  double v245; 
  double v246; 
  float v247; 
  float v248; 
  double v249; 
  double v250; 
  int v251; 
  float v252; 
  float v253; 
  float v254; 
  double v255; 
  double v256; 
  float v257; 
  float v258; 
  double v259; 
  double v260; 
  float v261; 
  float v262; 
  double v263; 
  double v264; 
  int v265; 
  float v266; 
  float v267; 
  float v268; 
  double v269; 
  double v270; 
  float v271; 
  float v272; 
  double v273; 
  double v274; 
  int v275; 
  float v276; 
  float v277; 
  float v278; 
  double v279; 
  double v280; 
  float v281; 
  float v282; 
  float v283; 
  double v284; 
  double v285; 
  float v286; 
  float v287; 
  double v288; 
  double v289; 
  float v290; 
  float v291; 
  double v292; 
  double v293; 
  float v294; 
  float v295; 
  double v296; 
  double v297; 
  int v298; 
  float v299; 
  float v300; 
  float v301; 
  double v302; 
  double v303; 
  float v304; 
  float v305; 
  double v306; 
  double v307; 
  float v308; 
  float v309; 
  double v310; 
  double v311; 
  int v312; 
  float v313; 
  float v314; 
  float v315; 
  double v316; 
  double v317; 
  float v318; 
  float v319; 
  double v320; 
  double v321; 
  int v322; 
  float v323; 
  float v324; 
  float v325; 
  double v326; 
  double v327; 
  float v328; 
  float v329; 
  float v330; 
  double v331; 
  double v332; 
  float v333; 
  float v334; 
  double v335; 
  double v336; 
  signed int v337; 
  signed int v338; 

  v338 = 1;
  v337 = 1;
  if ( math_mode )
  {
    if ( math_mode < 8u )
    {
      switch ( math_mode )
      {
        case 1u:
          if ( byte_2000009D == 9 )
          {
            dword_20000034 = i2f(num_result);
            digit_1_decimal = 1;
            digit_2_decimal = 1;
            digit_3_decimal = 1;
            byte_200000F9 = *((_BYTE *)&unk_800F860 + byte_20000000);
            byte_200000F6 = byte_200000F9;
            byte_200000F7 = byte_200000F9;
            byte_200000F8 = byte_200000F9;
            convert_number(num_result, byte_200000F9);
            byte_200000F9 = byte_2000007B;
            copy_digits(3);
          }
          if ( byte_2000009D == 2 )
          {
            if ( !byte_20000000 || (signed int)byte_20000000 > 2 )
            {
              v3 = i2f(dword_20000260);
              dword_20000034 = v3;
              v4 = fdiv(v3, 30.48);
              dword_20000034 = v4;
              v5 = f2d(v4);
              v6 = dadd(v5, 0.5);
              dword_2000007C = double2uint(v6);
              v7 = i2f(dword_2000025C);
              dword_20000034 = v7;
              v8 = fdiv(v7, 30.48);
              dword_20000034 = v8;
              v9 = f2d(v8);
              v10 = dadd(v9, 0.5);
              dword_20000080 = double2uint(v10);
              dword_20000034 = i2f(dword_2000007C);
              v11 = i2f(dword_20000080);
              dword_20000034 = fmul(v11, dword_20000034);
              dword_20000034 = fdiv(dword_20000034, 100.0);
              dword_20000134 = sub_800104C(dword_20000034);
              num_result = sub_8001098(dword_20000034);
              byte_200000F9 = 2;
              v12 = sub_8001098(dword_20000034);
              convert_number(v12, byte_200000F9);
              byte_200000F9 = byte_2000007B;
            }
            if ( byte_20000000 == 1 )
            {
              v13 = i2f(dword_20000260);
              dword_20000034 = v13;
              v14 = fdiv(v13, *(float *)&dword_800F848[byte_20000000]);
              dword_20000034 = v14;
              v15 = f2d(v14);
              v16 = dadd(v15, 0.5);
              dword_2000007C = double2uint(v16);
              dword_20000034 = i2f(dword_2000025C);
              dword_20000034 = fdiv(dword_20000034, *(float *)&dword_800F848[byte_20000000]);
              v17 = f2d(dword_20000034);
              v18 = dadd(v17, 0.5);
              dword_20000080 = double2uint(v18);
              dword_20000034 = i2f(dword_2000007C);
              v19 = i2f(dword_20000080);
              v20 = fmul(v19, dword_20000034);
              dword_20000034 = v20;
              v21 = fdiv(v20, 1000.0);
              v22 = f2d(v21);
              v23 = dadd(v22, 0.5);
              dword_20000034 = d2f(v23);
              dword_20000134 = sub_800104C(dword_20000034);
              num_result = sub_8001098(dword_20000034);
              v24 = sub_8001098(dword_20000034);
              convert_number(v24, byte_200000F9);
              byte_200000F9 = byte_2000007B;
            }
            if ( byte_20000000 == 2 )
            {
              v25 = i2f(dword_20000260);
              dword_20000034 = v25;
              v26 = fdiv(v25, *(float *)&dword_800F848[byte_20000000]);
              dword_20000034 = v26;
              v27 = f2d(v26);
              v28 = dadd(v27, 0.5);
              dword_2000007C = double2uint(v28);
              v29 = i2f(dword_2000025C);
              dword_20000034 = v29;
              v30 = fdiv(v29, *(float *)&dword_800F848[byte_20000000]);
              dword_20000034 = v30;
              v31 = f2d(v30);
              v32 = dadd(v31, 0.5);
              dword_20000080 = double2uint(v32);
              dword_20000034 = i2f(dword_2000007C);
              v33 = i2f(dword_20000080);
              v34 = fmul(v33, dword_20000034);
              dword_20000034 = v34;
              v35 = fdiv(v34, 100.0);
              v36 = f2d(v35);
              v37 = dadd(v36, 0.5);
              dword_20000034 = d2f(v37);
              dword_20000134 = sub_800104C(dword_20000034);
              num_result = sub_8001098(dword_20000034);
              v38 = sub_8001098(dword_20000034);
              convert_number(v38, byte_200000F9);
              byte_200000F9 = byte_2000007B;
            }
            copy_digits(3);
          }
          break;
        case 2u:
          if ( byte_2000009D == 9 )
          {
            dword_20000034 = i2f(num_result);
            digit_1_decimal = 2;
            digit_2_decimal = 2;
            digit_3_decimal = 2;
            byte_200000F9 = *((_BYTE *)&unk_800F860 + byte_20000000);
            byte_200000F6 = byte_200000F9;
            byte_200000F7 = byte_200000F9;
            byte_200000F8 = byte_200000F9;
            v39 = sub_8001098(dword_20000034);
            convert_number(v39, byte_200000F9);
            byte_200000F9 = byte_2000007B;
            copy_digits(3);
          }
          if ( byte_2000009D == 3 )
          {
            if ( !byte_20000000 || (signed int)byte_20000000 > 2 )
            {
              v40 = i2f(dword_20000260);
              dword_20000034 = v40;
              v41 = fdiv(v40, 30.48);
              dword_20000034 = v41;
              v42 = f2d(v41);
              v43 = dadd(v42, 0.5);
              dword_2000007C = double2uint(v43);
              v44 = i2f(dword_2000025C);
              dword_20000034 = v44;
              v45 = fdiv(v44, 30.48);
              dword_20000034 = v45;
              v46 = f2d(v45);
              v47 = dadd(v46, 0.5);
              dword_20000080 = double2uint(v47);
              v48 = i2f(dword_20000258[0]);
              dword_20000034 = v48;
              v49 = fdiv(v48, 30.48);
              dword_20000034 = v49;
              v50 = f2d(v49);
              v51 = dadd(v50, 0.5);
              dword_20000084 = double2uint(v51);
              dword_20000034 = i2f(dword_2000007C);
              v52 = i2f(dword_20000080);
              dword_20000034 = fmul(v52, dword_20000034);
              dword_20000034 = fdiv(dword_20000034, 100.0);
              v53 = i2f(dword_20000084);
              v54 = fmul(v53, dword_20000034);
              dword_20000034 = v54;
              v55 = fdiv(v54, 100.0);
              v56 = f2d(v55);
              v57 = dadd(v56, 0.5);
              dword_20000034 = d2f(v57);
              dword_20000134 = sub_800104C(dword_20000034);
              num_result = sub_8001098(dword_20000034);
              byte_200000F9 = 2;
              v58 = sub_8001098(dword_20000034);
              convert_number(v58, byte_200000F9);
              byte_200000F9 = byte_2000007B;
            }
            if ( byte_20000000 == 1 )
            {
              v59 = i2f(dword_20000260);
              dword_20000034 = v59;
              v60 = fdiv(v59, *(float *)&dword_800F848[byte_20000000]);
              dword_20000034 = v60;
              v61 = f2d(v60);
              v62 = dadd(v61, 0.5);
              dword_2000007C = double2uint(v62);
              v63 = i2f(dword_2000025C);
              dword_20000034 = v63;
              v64 = fdiv(v63, *(float *)&dword_800F848[byte_20000000]);
              dword_20000034 = v64;
              v65 = f2d(v64);
              v66 = dadd(v65, 0.5);
              dword_20000080 = double2uint(v66);
              dword_20000034 = i2f(dword_20000258[0]);
              dword_20000034 = fdiv(dword_20000034, *(float *)&dword_800F848[byte_20000000]);
              v67 = f2d(dword_20000034);
              v68 = dadd(v67, 0.5);
              dword_20000084 = double2uint(v68);
              dword_20000034 = i2f(dword_2000007C);
              v69 = i2f(dword_20000080);
              dword_20000034 = fmul(v69, dword_20000034);
              dword_20000034 = fdiv(dword_20000034, 1000.0);
              v70 = i2f(dword_20000084);
              v71 = fmul(v70, dword_20000034);
              dword_20000034 = v71;
              v72 = fdiv(v71, 1000.0);
              v73 = f2d(v72);
              v74 = dadd(v73, 0.5);
              dword_20000034 = d2f(v74);
              num_result = sub_8001098(dword_20000034);
              dword_20000134 = num_result;
              convert_number(num_result, byte_200000F9);
              byte_200000F9 = byte_2000007B;
            }
            if ( byte_20000000 == 2 )
            {
              v75 = i2f(dword_20000260);
              dword_20000034 = v75;
              v76 = fdiv(v75, *(float *)&dword_800F848[byte_20000000]);
              dword_20000034 = v76;
              v77 = f2d(v76);
              v78 = dadd(v77, 0.5);
              dword_2000007C = double2uint(v78);
              v79 = i2f(dword_2000025C);
              dword_20000034 = v79;
              v80 = fdiv(v79, *(float *)&dword_800F848[byte_20000000]);
              dword_20000034 = v80;
              v81 = f2d(v80);
              v82 = dadd(v81, 0.5);
              dword_20000080 = double2uint(v82);
              v83 = i2f(dword_20000258[0]);
              dword_20000034 = v83;
              v84 = fdiv(v83, *(float *)&dword_800F848[byte_20000000]);
              dword_20000034 = v84;
              v85 = f2d(v84);
              v86 = dadd(v85, 0.5);
              dword_20000084 = double2uint(v86);
              dword_20000034 = i2f(dword_2000007C);
              v87 = i2f(dword_20000080);
              dword_20000034 = fmul(v87, dword_20000034);
              dword_20000034 = fdiv(dword_20000034, 100.0);
              v88 = i2f(dword_20000084);
              v89 = fmul(v88, dword_20000034);
              dword_20000034 = v89;
              v90 = fdiv(v89, 100.0);
              v91 = f2d(v90);
              v92 = dadd(v91, 0.5);
              dword_20000034 = d2f(v92);
              dword_20000134 = sub_800104C(dword_20000034);
              num_result = sub_8001098(dword_20000034);
              v93 = sub_8001098(dword_20000034);
              convert_number(v93, byte_200000F9);
              byte_200000F9 = byte_2000007B;
            }
            copy_digits(3);
          }
          break;
        case 3u:
          if ( byte_2000009D == 3 )
          {
            if ( !byte_20000000 || (signed int)byte_20000000 > 2 )
            {
              v94 = i2f(dword_20000260);
              dword_20000034 = v94;
              v95 = fdiv(v94, 30.48);
              v96 = f2d(v95);
              v97 = dadd(v96, 0.5);
              dword_20000034 = d2f(v97);
              dword_2000007C = sub_8001098(dword_20000034);
              v98 = i2f(dword_2000025C);
              dword_20000034 = v98;
              v99 = fdiv(v98, 30.48);
              v100 = f2d(v99);
              v101 = dadd(v100, 0.5);
              dword_20000034 = d2f(v101);
              dword_20000080 = sub_8001098(dword_20000034);
              v102 = i2f(dword_20000258[0]);
              dword_20000034 = v102;
              v103 = fdiv(v102, 30.48);
              v104 = f2d(v103);
              v105 = dadd(v104, 0.5);
              v106 = d2f(v105);
              dword_20000034 = v106;
              v107 = sub_8001098(v106);
              dword_20000084 = v107;
              v108 = uint2double((unsigned __int16)dword_2000007C + (unsigned __int16)dword_20000080 + v107);
              v109 = sub_80006E4(v108, 2.0);
              dword_20000040 = d2f(v109);
              v110 = i2f(dword_2000007C);
              v111 = sub_800F728(v110, dword_20000040);
              v112 = f2d(v111);
              v113 = sub_80006E4(v112, 100.0);
              dword_20000034 = d2f(v113);
              v114 = i2f(dword_20000080);
              v115 = sub_800F728(v114, dword_20000040);
              v116 = f2d(v115);
              v117 = sub_80006E4(v116, 100.0);
              laser1_phase_max = d2f(v117);
              v118 = i2f(dword_20000084);
              v119 = sub_800F728(v118, dword_20000040);
              v120 = f2d(v119);
              v121 = sub_80006E4(v120, 100.0);
              laser1_phase_min = d2f(v121);
              v122 = fmul(dword_20000040, dword_20000034);
              dword_20000040 = v122;
              v123 = fmul(v122, laser1_phase_max);
              dword_20000040 = v123;
              v124 = fmul(v123, laser1_phase_min);
              dword_20000040 = v124;
              v125 = fmul(v124, 100.0);
              dword_20000040 = v125;
              v126 = f2d(v125);
              v127 = dsqrt(v126);
              v128 = dadd(v127, 0.5);
              dword_20000034 = d2f(v128);
              dword_20000134 = sub_800104C(dword_20000034);
              num_result = sub_8001098(dword_20000034);
              byte_200000F9 = 2;
              v129 = sub_8001098(dword_20000034);
              convert_number(v129, 2);
              byte_200000F9 = byte_2000007B;
            }
            if ( byte_20000000 == 1 )
            {
              v130 = i2f(dword_20000258[0]);
              v131 = fdiv(v130, *(float *)&dword_800F848[byte_20000000]);
              v132 = f2d(v131);
              v133 = dadd(v132, 0.5);
              dword_2000007C = double2uint(v133);
              v134 = i2f(dword_2000025C);
              v135 = fdiv(v134, *(float *)&dword_800F848[byte_20000000]);
              v136 = f2d(v135);
              v137 = dadd(v136, 0.5);
              dword_20000080 = double2uint(v137);
              v138 = i2f(dword_20000260);
              v139 = fdiv(v138, *(float *)&dword_800F848[byte_20000000]);
              v140 = f2d(v139);
              v141 = dadd(v140, 0.5);
              v142 = double2uint(v141);
              dword_20000084 = v142;
              v143 = uint2double((unsigned __int16)dword_2000007C + (unsigned __int16)dword_20000080 + v142);
              v144 = sub_80006E4(v143, 2.0);
              dword_20000040 = d2f(v144);
              v145 = i2f(dword_2000007C);
              v146 = sub_800F728(v145, dword_20000040);
              v147 = f2d(v146);
              v148 = sub_80006E4(v147, 1000.0);
              dword_20000034 = d2f(v148);
              v149 = i2f(dword_20000080);
              v150 = sub_800F728(v149, dword_20000040);
              v151 = f2d(v150);
              v152 = sub_80006E4(v151, 1000.0);
              laser1_phase_max = d2f(v152);
              v153 = i2f(dword_20000084);
              v154 = sub_800F728(v153, dword_20000040);
              v155 = f2d(v154);
              v156 = sub_80006E4(v155, 1000.0);
              laser1_phase_min = d2f(v156);
              v157 = fmul(dword_20000040, dword_20000034);
              dword_20000040 = v157;
              v158 = fmul(v157, laser1_phase_max);
              dword_20000040 = v158;
              v159 = fmul(v158, laser1_phase_min);
              dword_20000040 = v159;
              v160 = fmul(v159, 1000.0);
              dword_20000040 = v160;
              v161 = f2d(v160);
              v162 = dsqrt(v161);
              v163 = dadd(v162, 0.5);
              dword_20000034 = d2f(v163);
              num_result = sub_8001098(dword_20000034);
              dword_20000134 = sub_800104C(dword_20000034);
              convert_number(num_result, byte_200000F9);
              byte_200000F9 = byte_2000007B;
            }
            if ( byte_20000000 == 2 )
            {
              v164 = i2f(dword_20000258[0]);
              v165 = fdiv(v164, *(float *)&dword_800F848[byte_20000000]);
              v166 = f2d(v165);
              v167 = dadd(v166, 0.5);
              dword_2000007C = double2uint(v167);
              v168 = i2f(dword_2000025C);
              v169 = fdiv(v168, *(float *)&dword_800F848[byte_20000000]);
              v170 = f2d(v169);
              v171 = dadd(v170, 0.5);
              dword_20000080 = double2uint(v171);
              v172 = i2f(dword_20000260);
              v173 = fdiv(v172, *(float *)&dword_800F848[byte_20000000]);
              v174 = f2d(v173);
              v175 = dadd(v174, 0.5);
              v176 = double2uint(v175);
              dword_20000084 = v176;
              v177 = uint2double((unsigned __int16)dword_2000007C + (unsigned __int16)dword_20000080 + v176);
              v178 = sub_80006E4(v177, 2.0);
              dword_20000040 = d2f(v178);
              v179 = i2f(dword_2000007C);
              v180 = sub_800F728(v179, dword_20000040);
              v181 = f2d(v180);
              v182 = sub_80006E4(v181, 100.0);
              dword_20000034 = d2f(v182);
              v183 = i2f(dword_20000080);
              v184 = sub_800F728(v183, dword_20000040);
              v185 = f2d(v184);
              v186 = sub_80006E4(v185, 100.0);
              laser1_phase_max = d2f(v186);
              v187 = i2f(dword_20000084);
              v188 = sub_800F728(v187, dword_20000040);
              v189 = f2d(v188);
              v190 = sub_80006E4(v189, 100.0);
              laser1_phase_min = d2f(v190);
              v191 = fmul(dword_20000040, dword_20000034);
              dword_20000040 = v191;
              v192 = fmul(v191, laser1_phase_max);
              dword_20000040 = v192;
              v193 = fmul(v192, laser1_phase_min);
              dword_20000040 = v193;
              v194 = fmul(v193, 100.0);
              dword_20000040 = v194;
              v195 = f2d(v194);
              v196 = dsqrt(v195);
              v197 = dadd(v196, 0.5);
              dword_20000034 = d2f(v197);
              num_result = sub_8001098(dword_20000034);
              dword_20000134 = sub_800104C(dword_20000034);
              v198 = sub_8001098(dword_20000034);
              convert_number(v198, byte_200000F9);
              byte_200000F9 = byte_2000007B;
            }
            copy_digits(3);
          }
          break;
        case 4u:
          if ( byte_2000009D == 2 )
          {
            if ( (signed int)byte_20000000 >= 4 )
            {
              dword_20000034 = i2f(dword_20000260);
              dword_20000034 = fmul(dword_20000034, dword_20000034);
              v215 = i2f(dword_2000025C);
              laser1_phase_max = v215;
              v216 = fmul(v215, v215);
              laser1_phase_max = v216;
              v217 = fsub(dword_20000034, v216);
              dword_20000034 = v217;
              v218 = f2d(v217);
              v219 = dsqrt(v218);
              v220 = dadd(v219, 0.5);
              dword_20000034 = d2f(v220);
              num_result = sub_8001098(dword_20000034);
              sub_8008AE4(num_result, byte_200000F9);
            }
            else
            {
              v199 = i2f(dword_20000260);
              v200 = fdiv(v199, *(float *)&dword_800F848[byte_20000000]);
              v201 = f2d(v200);
              v202 = dadd(v201, 0.5);
              dword_2000007C = double2uint(v202);
              dword_20000034 = i2f(dword_2000007C);
              dword_20000034 = fmul(dword_20000034, dword_20000034);
              v203 = i2f(dword_2000025C);
              v204 = fdiv(v203, *(float *)&dword_800F848[byte_20000000]);
              v205 = f2d(v204);
              v206 = dadd(v205, 0.5);
              v207 = double2uint(v206);
              dword_20000080 = v207;
              v208 = i2f(v207);
              laser1_phase_max = v208;
              v209 = fmul(v208, v208);
              laser1_phase_max = v209;
              v210 = fsub(dword_20000034, v209);
              dword_20000034 = v210;
              v211 = f2d(v210);
              v212 = dsqrt(v211);
              v213 = dadd(v212, 0.5);
              dword_20000034 = d2f(v213);
              num_result = sub_8001098(dword_20000034);
              v214 = sub_8001098(dword_20000034);
              convert_number(v214, byte_200000F9);
            }
            byte_200000F9 = byte_2000007B;
            copy_digits(3);
          }
          break;
        case 5u:
          if ( byte_2000009D == 2 )
          {
            if ( (signed int)byte_20000000 >= 4 )
            {
              dword_20000034 = i2f(dword_20000260);
              dword_20000034 = fmul(dword_20000034, dword_20000034);
              v237 = i2f(dword_2000025C);
              laser1_phase_max = v237;
              v238 = fmul(v237, v237);
              laser1_phase_max = v238;
              v239 = fadd(dword_20000034, v238);
              dword_20000034 = v239;
              v240 = f2d(v239);
              v241 = dsqrt(v240);
              v242 = dadd(v241, 0.5);
              dword_20000034 = d2f(v242);
              num_result = sub_8001098(dword_20000034);
              sub_8008AE4(num_result, byte_200000F9);
            }
            else
            {
              v221 = i2f(dword_20000260);
              v222 = fdiv(v221, *(float *)&dword_800F848[byte_20000000]);
              v223 = f2d(v222);
              v224 = dadd(v223, 0.5);
              dword_2000007C = double2uint(v224);
              dword_20000034 = i2f(dword_2000007C);
              dword_20000034 = fmul(dword_20000034, dword_20000034);
              v225 = i2f(dword_2000025C);
              v226 = fdiv(v225, *(float *)&dword_800F848[byte_20000000]);
              v227 = f2d(v226);
              v228 = dadd(v227, 0.5);
              v229 = double2uint(v228);
              dword_20000080 = v229;
              v230 = i2f(v229);
              laser1_phase_max = v230;
              v231 = fmul(v230, v230);
              laser1_phase_max = v231;
              v232 = fadd(dword_20000034, v231);
              dword_20000034 = v232;
              v233 = f2d(v232);
              v234 = dsqrt(v233);
              v235 = dadd(v234, 0.5);
              dword_20000034 = d2f(v235);
              num_result = sub_8001098(dword_20000034);
              v236 = sub_8001098(dword_20000034);
              convert_number(v236, byte_200000F9);
            }
            byte_200000F9 = byte_2000007B;
            copy_digits(3);
          }
          break;
        case 6u:
          if ( byte_2000009D == 3 )
          {
            if ( (signed int)byte_20000000 >= 4 )
            {
              dword_20000034 = i2f(dword_20000260);
              dword_20000034 = fmul(dword_20000034, dword_20000034);
              v276 = i2f(dword_20000258[0]);
              laser1_phase_max = v276;
              v277 = fmul(v276, v276);
              laser1_phase_max = v277;
              v278 = fsub(dword_20000034, v277);
              dword_20000034 = v278;
              v279 = f2d(v278);
              v280 = dsqrt(v279);
              laser1_phase_min = d2f(v280);
              dword_20000034 = i2f(dword_2000025C);
              dword_20000034 = fmul(dword_20000034, dword_20000034);
              v281 = i2f(dword_20000258[0]);
              laser1_phase_max = v281;
              v282 = fmul(v281, v281);
              laser1_phase_max = v282;
              v283 = fsub(dword_20000034, v282);
              dword_20000034 = v283;
              v284 = f2d(v283);
              v285 = dsqrt(v284);
              v286 = d2f(v285);
              dword_20000034 = v286;
              v287 = fsub(laser1_phase_min, v286);
              v288 = f2d(v287);
              v289 = dadd(v288, 0.5);
              dword_20000034 = d2f(v289);
              num_result = sub_8001098(dword_20000034);
              sub_8008AE4(num_result, byte_200000F9);
            }
            else
            {
              v243 = i2f(dword_20000260);
              v244 = fdiv(v243, *(float *)&dword_800F848[byte_20000000]);
              v245 = f2d(v244);
              v246 = dadd(v245, 0.5);
              dword_2000007C = double2uint(v246);
              dword_20000034 = i2f(dword_2000007C);
              dword_20000034 = fmul(dword_20000034, dword_20000034);
              v247 = i2f(dword_20000258[0]);
              v248 = fdiv(v247, *(float *)&dword_800F848[byte_20000000]);
              v249 = f2d(v248);
              v250 = dadd(v249, 0.5);
              v251 = double2uint(v250);
              dword_20000080 = v251;
              v252 = i2f(v251);
              laser1_phase_max = v252;
              v253 = fmul(v252, v252);
              laser1_phase_max = v253;
              v254 = fsub(dword_20000034, v253);
              dword_20000034 = v254;
              v255 = f2d(v254);
              v256 = dsqrt(v255);
              laser1_phase_min = d2f(v256);
              v257 = i2f(dword_2000025C);
              v258 = fdiv(v257, *(float *)&dword_800F848[byte_20000000]);
              v259 = f2d(v258);
              v260 = dadd(v259, 0.5);
              dword_2000007C = double2uint(v260);
              dword_20000034 = i2f(dword_2000007C);
              dword_20000034 = fmul(dword_20000034, dword_20000034);
              v261 = i2f(dword_20000258[0]);
              v262 = fdiv(v261, *(float *)&dword_800F848[byte_20000000]);
              v263 = f2d(v262);
              v264 = dadd(v263, 0.5);
              v265 = double2uint(v264);
              dword_20000080 = v265;
              v266 = i2f(v265);
              laser1_phase_max = v266;
              v267 = fmul(v266, v266);
              laser1_phase_max = v267;
              v268 = fsub(dword_20000034, v267);
              dword_20000034 = v268;
              v269 = f2d(v268);
              v270 = dsqrt(v269);
              v271 = d2f(v270);
              dword_20000034 = v271;
              v272 = fsub(laser1_phase_min, v271);
              v273 = f2d(v272);
              v274 = dadd(v273, 0.5);
              dword_20000034 = d2f(v274);
              num_result = sub_8001098(dword_20000034);
              v275 = sub_8001098(dword_20000034);
              convert_number(v275, byte_200000F9);
            }
            byte_200000F9 = byte_2000007B;
            copy_digits(3);
          }
          break;
        case 7u:
          if ( byte_2000009D == 3 )
          {
            if ( (signed int)byte_20000000 >= 4 )
            {
              dword_20000034 = i2f(dword_20000260);
              dword_20000034 = fmul(dword_20000034, dword_20000034);
              v323 = i2f(dword_2000025C);
              laser1_phase_max = v323;
              v324 = fmul(v323, v323);
              laser1_phase_max = v324;
              v325 = fsub(dword_20000034, v324);
              laser1_phase_min = v325;
              v326 = f2d(v325);
              v327 = dsqrt(v326);
              laser1_phase_min = d2f(v327);
              dword_20000034 = i2f(dword_20000258[0]);
              dword_20000034 = fmul(dword_20000034, dword_20000034);
              v328 = i2f(dword_2000025C);
              laser1_phase_max = v328;
              v329 = fmul(v328, v328);
              laser1_phase_max = v329;
              v330 = fsub(dword_20000034, v329);
              dword_20000034 = v330;
              v331 = f2d(v330);
              v332 = dsqrt(v331);
              v333 = d2f(v332);
              dword_20000034 = v333;
              v334 = fadd(v333, laser1_phase_min);
              v335 = f2d(v334);
              v336 = dadd(v335, 0.5);
              dword_20000034 = d2f(v336);
              num_result = sub_8001098(dword_20000034);
              sub_8008AE4(num_result, byte_200000F9);
            }
            else
            {
              v290 = i2f(dword_20000260);
              v291 = fdiv(v290, *(float *)&dword_800F848[byte_20000000]);
              v292 = f2d(v291);
              v293 = dadd(v292, 0.5);
              dword_2000007C = double2uint(v293);
              dword_20000034 = i2f(dword_2000007C);
              dword_20000034 = fmul(dword_20000034, dword_20000034);
              v294 = i2f(dword_2000025C);
              v295 = fdiv(v294, *(float *)&dword_800F848[byte_20000000]);
              v296 = f2d(v295);
              v297 = dadd(v296, 0.5);
              v298 = double2uint(v297);
              dword_20000080 = v298;
              v299 = i2f(v298);
              laser1_phase_max = v299;
              v300 = fmul(v299, v299);
              laser1_phase_max = v300;
              v301 = fsub(dword_20000034, v300);
              laser1_phase_min = v301;
              v302 = f2d(v301);
              v303 = dsqrt(v302);
              laser1_phase_min = d2f(v303);
              v304 = i2f(dword_20000258[0]);
              v305 = fdiv(v304, *(float *)&dword_800F848[byte_20000000]);
              v306 = f2d(v305);
              v307 = dadd(v306, 0.5);
              dword_2000007C = double2uint(v307);
              dword_20000034 = i2f(dword_2000007C);
              dword_20000034 = fmul(dword_20000034, dword_20000034);
              v308 = i2f(dword_2000025C);
              v309 = fdiv(v308, *(float *)&dword_800F848[byte_20000000]);
              v310 = f2d(v309);
              v311 = dadd(v310, 0.5);
              v312 = double2uint(v311);
              dword_20000080 = v312;
              v313 = i2f(v312);
              laser1_phase_max = v313;
              v314 = fmul(v313, v313);
              laser1_phase_max = v314;
              v315 = fsub(dword_20000034, v314);
              dword_20000034 = v315;
              v316 = f2d(v315);
              v317 = dsqrt(v316);
              v318 = d2f(v317);
              dword_20000034 = v318;
              v319 = fadd(v318, laser1_phase_min);
              v320 = f2d(v319);
              v321 = dadd(v320, 0.5);
              dword_20000034 = d2f(v321);
              num_result = sub_8001098(dword_20000034);
              v322 = sub_8001098(dword_20000034);
              convert_number(v322, byte_200000F9);
            }
            byte_200000F9 = byte_2000007B;
            copy_digits(3);
          }
          break;
        default:
          return;
      }
    }
  }
  else if ( byte_20000114 )
  {
    byte_2000009D = 2;
    if ( byte_20000114 == 1 )
    {
      if ( byte_2000005C )
      {
        dword_2000025C = dword_20000128;
        dword_20000128 += 10 * sub_80001BC(dword_200000C8 + 5, 0xAu);
        dword_20000258[0] = dword_200000C8;
      }
      dword_20000134 = dword_20000128;
      sub_8008AE4(dword_20000128, byte_200000F9);
      byte_200000F9 = byte_2000007B;
      copy_digits(3);
    }
    if ( byte_20000114 == 2 )
    {
      if ( byte_2000005C )
      {
        dword_2000025C = dword_20000128;
        dword_20000128 -= 10 * sub_80001BC(dword_200000C8 + 5, 0xAu);
        dword_20000258[0] = dword_200000C8;
      }
      if ( dword_20000128 >= 0 )
      {
        dword_20000134 = dword_20000128;
        sub_8008AE4(dword_20000128, byte_200000F9);
        byte_200000F9 = byte_2000007B;
        copy_digits(3);
        byte_2000006A = 0;
        dword_200000C8 = dword_20000128;
      }
      else
      {
        dword_20000128 = -dword_20000128;
        dword_20000134 = dword_20000128;
        sub_8008AE4(dword_20000128, byte_200000F9);
        byte_200000F9 = byte_2000007B;
        copy_digits(3);
        byte_2000006A = 1;
        byte_20000114 = 0;
        byte_2000009D = 0;
        dword_200000C8 = dword_20000128;
        dword_20000128 = 0;
      }
    }
  }
  else
  {
    if ( byte_2000009E && byte_2000010D )
    {
      while ( 1 )
      {
        v2 = v338;
        if ( !v338 )
          goto LABEL_13;
        if ( dword_2000025C + ((unsigned int)dword_20000258[0] >> 1) >= dword_200000C8 )
          break;
        v1 = dword_2000025C;
        if ( dword_2000025C + ((unsigned int)(dword_20000258[0] * v338) >> 1) < dword_200000C8 )
        {
          v1 = dword_2000025C;
          if ( dword_2000025C + ((unsigned int)(dword_20000258[0] * (v338 + 2)) >> 1) >= dword_200000C8 )
          {
            v1 = dword_2000025C;
            v2 = dword_2000025C + dword_20000258[0] * v337;
            v0 = dword_20000258;
            dword_20000260 = dword_2000025C + dword_20000258[0] * v337;
LABEL_13:
            sub_8001DF4(v2, (int)v0, v1);
          }
        }
        v0 = (int *)(v337++ + 1);
        v338 += 2;
      }
      v2 = dword_2000025C;
      v0 = dword_20000258;
      dword_20000260 = dword_2000025C;
      goto LABEL_13;
    }
    sub_8008AE4(dword_200000C8, byte_200000F9);
    byte_200000F9 = byte_2000007B;
    copy_digits(3);
  }
}

























void __fastcall fm_shift_saved(signed int a1)
{
  int v1; 
  unsigned int v2; 
  unsigned int v3; 

  if ( (unsigned __int8)byte_20000190 > a1 )
  {
    v1 = 20 * a1 + 32;
    v2 = 20 * (a1 - 1) + 32;
    v3 = 20 * ((unsigned __int8)byte_20000190 - a1);
    while ( v3 > 0x100 )
    {
      v3 -= 256;
      fm_read_buf((_BYTE *)adc_data_copy, 256, v1, 0xA0);
      fm_write_buf((_BYTE *)adc_data_copy, v2, 256, 0xA0);
      v1 += 256;
      v2 += 256;
      delay_cycles_16000(15);
    }
    if ( v3 )
    {
      fm_read_buf((_BYTE *)adc_data_copy, v3, v1, 0xA0);
      fm_write_buf((_BYTE *)adc_data_copy, v2, v3, 0xA0);
    }
    delay_cycles_16000(10);
  }
}



int sub_8008998()
{
  byte_2000015A = 9;
  byte_2000015B = 0;
  byte_2000015C = 1;
  return sub_80089B4((int)&byte_2000015A);
}





int __fastcall sub_80089B4(int result)
{
  if ( *(_BYTE *)(result + 2) )
  {
    *(_DWORD *)(4 * ((signed int)*(_BYTE *)result >> 2) - 536812544) = *(_DWORD *)(4
                                                                                 * ((signed int)*(_BYTE *)result >> 2)
                                                                                 - 536812544) & ~(255 << (8 * *(_BYTE *)result & 0x1F)) | (((*(_BYTE *)(result + 1) << 6) & 0xFF) << (8 * *(_BYTE *)result & 0x1F));
    vE000E100 = 1 << (*(_BYTE *)result & 0x1F);
  }
  else
  {
    vE000E180 = 1 << (*(_BYTE *)result & 0x1F);
  }
  return result;
}


int sub_8008A24()
{
  byte_2000015A = 21;
  byte_2000015B = 0;
  byte_2000015C = 1;
  return sub_80089B4((int)&byte_2000015A);
}





int apd_dcdc_init()
{
  sub_8008C44(2048, 1);
  stru_20000160.pin = 0x100;
  stru_20000160.mode = 2;
  stru_20000160.speed = 3;
  stru_20000160.otype = 0;
  stru_20000160.pupd = 0;
  gpio_init(0x48000000, &stru_20000160);        
  gpio_set_AF(0x48000000, 8, 2);                
  dword_20000C68 = 999;
  word_20000C64 = 0;
  word_20000C6C = 0;
  word_20000C66 = 0;
  sub_800A1FC(0x40012C00, (int)&word_20000C64);
  word_20000C10 = 96;
  word_20000C12 = 1;
  dword_20000C18 = dword_20000020 - 1;
  word_20000C1C = 0;
  sub_800A068(0x40012C00, (int)&word_20000C10);
  sub_800A0FC(0x40012C00, 8);
  sub_8009FCC((_WORD *)0x40012C00, 1);
  TIM_Cmd((_WORD *)0x40012C00, 1);
  return sub_800A00C(0x40012C00, 0);
}











int __fastcall sub_8008AE4(unsigned int a1, int r1_0)
{
  int result; 
  float v3; 
  double v4; 
  double v5; 
  int v6; 
  int a2; 

  a2 = r1_0;
  dword_20000034 = i2f(a1);
  if ( current_state == 153 )
  {
    if ( (signed int)byte_20000124 >= 4 )
    {
      if ( byte_200000AB != 1 && byte_200000AB != 2 )
      {
        dword_20000034 = i2f(dword_200000D0);
        if ( byte_20000124 == 4 )
          sub_800DFD4(digits_4);
        result = byte_20000124;
        if ( byte_20000124 == 5 )
          sub_800DDE8(digits_4);
      }
      else
      {
        convert_number(dword_200000D0, a2);
      }
    }
    else
    {
      convert_number(dword_200000D0, a2);
    }
  }
  else
  {
    if ( (signed int)byte_20000000 < 4 )
    {
      v3 = fdiv(dword_20000034, *(float *)&dword_800F848[byte_20000000]);
      v4 = f2d(v3);
      v5 = dadd(v4, 0.5);
      dword_20000034 = d2f(v5);
      dword_20000134 = sub_800104C(dword_20000034);
      v6 = sub_8001098(dword_20000034);
      convert_number(v6, a2);
    }
    if ( byte_20000000 == 4 )
    {
      dword_20000134 = sub_800104C(dword_20000034);
      sub_800DFD4(digits_4);
    }
    result = byte_20000000;
    if ( byte_20000000 == 5 )
    {
      dword_20000134 = sub_800104C(dword_20000034);
      sub_800DDE8(digits_4);
    }
  }
  return result;
}






int __fastcall sub_8008C04(int result, int a2)
{
  if ( a2 )
    v40021014 |= result;
  else
    v40021014 &= ~result;
  return result;
}


int __fastcall sub_8008C24(int result, int a2)
{
  if ( a2 )
    v4002101C |= result;
  else
    v4002101C &= ~result;
  return result;
}


int __fastcall sub_8008C44(int result, int a2)
{
  if ( a2 )
    v40021018 |= result;
  else
    v40021018 &= ~result;
  return result;
}


int __fastcall sub_8008C64(int result, int a2)
{
  if ( a2 )
    v4002100C |= result;
  else
    v4002100C &= ~result;
  return result;
}


int __fastcall RCC_GetClock(int *a1)
{
  int *v1; 
  int v2; 
  unsigned int v3; 
  int result; 

  v1 = a1;
  v2 = v40021004 & 0xC;
  if ( v40021004 & 0xC )
  {
    if ( v2 == 4 )
    {
      *a1 = 8000000;
    }
    else if ( v2 == 8 )
    {
      v3 = ((v40021004 & 0x3C0000u) >> 18) + 2;
      if ( v40021004 & 0x10000 )
        *a1 = sub_80001BC(8000000u, (v4002102C & 0xF) + 1) * v3;
      else
        *a1 = 4000000 * v3;
    }
    else
    {
      *a1 = 8000000;
    }
  }
  else
  {
    *a1 = 8000000;
  }
  v1[1] = (unsigned int)*v1 >> byte_200001AF[(v40021004 & 0xF0u) >> 4];
  v1[2] = (unsigned int)v1[1] >> byte_200001AF[(v40021004 & 0x700u) >> 8];
  if ( (v40021030 & 0x100) == 256 )
  {
    if ( (v40021004 & 0x4000) == 0x4000 )
      v1[3] = (unsigned int)v1[2] >> 2;
    else
      v1[3] = (unsigned int)v1[2] >> 1;
  }
  else
  {
    v1[3] = 14000000;
  }
  if ( (v40021030 & 0x40) == 64 )
    v1[4] = 0x8000;
  else
    v1[4] = 32786;
  if ( (v40021030 & 0x10) == 16 )
    v1[5] = *v1;
  else
    v1[5] = 8000000;
  if ( v40021030 & 3 )
  {
    if ( (v40021030 & 3) == 1 )
    {
      result = *v1;
      v1[6] = *v1;
    }
    else if ( (v40021030 & 3) == 2 )
    {
      result = 0x8000;
      v1[6] = 0x8000;
    }
    else
    {
      result = v40021030 & 3;
      if ( result == 3 )
      {
        result = 8000000;
        v1[6] = 8000000;
      }
    }
  }
  else
  {
    result = v1[2];
    v1[6] = result;
  }
  return result;
}


void sub_8008DF0()
{
  signed int v0; 
  unsigned __int16 v1; 
  signed int v2; 

  v0 = 0;
  select_laser(0);
  GPIO_Set(0x48000400, 0x1000);
  apd_pwm_value = adp_pwm_value_laser2 + 4;
  apd_dcdc_set(adp_pwm_value_laser2 + 4);
  adc_capture_dma(0);
  delay_cycles_16000(8);
  new_adc_data = 0;
  while ( !new_adc_data )
    ;
  new_adc_data = 0;
  while ( !new_adc_data )
    ;
  new_adc_data = 0;
  while ( !v0 )
  {
    if ( new_adc_data )
    {
      if ( sub_800AEFC() )
      {
        adp_pwm_value_laser2 = apd_pwm_value;
        v0 = 1;
      }
      new_adc_data = 0;
    }
  }
  GPIO_Reset(0x48000400, 0x1000);
  v1 = apd_pwm_value;
  apd_pwm_value = adp_pwm_value_laser1 + 4;
  apd_dcdc_set(adp_pwm_value_laser1 + 4);
  delay_cycles_16000(8);
  v2 = 0;
  new_adc_data = 0;
  while ( !new_adc_data )
    ;
  new_adc_data = 0;
  while ( !new_adc_data )
    ;
  new_adc_data = 0;
  while ( !v2 )
  {
    if ( new_adc_data )
    {
      if ( sub_800AEFC() )
      {
        adp_pwm_value_laser1 = apd_pwm_value;
        v2 = 1;
      }
      new_adc_data = 0;
    }
  }
  GPIO_Set(0x48000400, 0x1000);
  apd_pwm_value = v1;
  apd_dcdc_set(v1);
}





void __cdecl sub_8008F14()
{
  char v0; 
  double v1; 
  double v2; 
  double v3; 
  unsigned __int8 v4; 
  signed int i; 
  double v6; 

  if ( current_state == 199 )
  {
    if ( byte_2000010C == 2 )
    {
      fw_write_byte(21, (unsigned __int8)dword_20000104);
      delay_cycles_16000(16);
      fw_write_byte(20, (unsigned int)(unsigned __int16)dword_20000104 << 16 >> 24);
      delay_cycles_16000(16);
      fw_write_byte(19, (unsigned int)(dword_20000104 << 8) >> 24);
      delay_cycles_16000(16);
      fw_write_byte(24, (unsigned __int8)dword_20000108);
      delay_cycles_16000(16);
      fw_write_byte(23, (unsigned int)(unsigned __int16)dword_20000108 << 16 >> 24);
      delay_cycles_16000(16);
      fw_write_byte(22, (unsigned int)(dword_20000108 << 8) >> 24);
      byte_2000009E = 1;
      current_state = 0;
      byte_2000010C = 0;
      byte_200000AC = 1;
    }
    else
    {
      byte_2000010C = 2;
      beep_do(1, 8);
    }
  }
  if ( current_state == 100 )
  {
LABEL_43:
    LODWORD(dword_20000010) = 0x41C80000;
    byte_200000AD = 0;
    byte_2000017F = 0;
    byte_200001DC = 0;
    sub_800C8C0(byte_20000000);
    byte_200000A6 = 1;
    word_20000112 = 100;
    byte_200000A7 = 1;
    byte_20000115 = 0;
    word_20000092 = 0;
    byte_2000006E = 0;
    dword_200000D8 = 0;
    dword_200000D4 = 0;
    byte_20000078 = 0;
    byte_200000F3 = 0;
    byte_2000009B = 0;
    byte_200000A9 = 0;
    v1 = uint2double(adc_battery);
    d_gt(v1, 1474.56);
    if ( !v0 & v4 && byte_2000005D != 1 )
    {
      v3 = uint2double(adc_battery);
      d_lt(v3, 1474.56);
      if ( v4 )
      {
        f_gt(dword_20000010, 50.0);
        if ( !v4 || (f_lt(dword_20000010, 0.0), !v4) )
          error_no = 4;
      }
      else
      {
        error_no = 3;
      }
      current_state = 100;
    }
    else
    {
      GPIO_Reset(0x48000400, 4);
      GPIO_Reset(0x48000400, 0x2000);
      delay_cycles_16000(5);
      byte_2000005A = 0;
      if ( math_mode )
        word_20000110 = 160;
      else
        word_20000110 = 40;
      if ( current_state == 101 )
        byte_2000009E = 0;
      if ( byte_200000AA )
      {
        GPIO_Reset(0x48000400, 0x1000);
        byte_200000A6 = 0;
      }
      else
      {
        GPIO_Set(0x48000400, 0x1000);
        byte_200000A6 = 1;
      }
      si_write_config(0);
      apd_pwm_value = word_2000008C;
      apd_dcdc_set(word_2000008C);
      delay_cycles_16000(8);
      adc_read_battery();
      apd_update_level(0);
      if ( (signed int)signal_max < 3000 )
      {
        si_write_config(0);
        sub_8001C18();
        if ( (signed int)signal_max < 3000 && word_20000120 )
        {
          adp_pwm_value_laser2 = word_20000120;
          adp_pwm_value_laser1 = word_20000122;
        }
        GPIO_Reset(0x48000400, 0x2000);
        GPIO_Set(0x48000400, 0x1000);
        apd_update_level(0);
      }
      byte_2000005A = 0;
      si_cfg = 0;
      byte_2000011A = 0;
      byte_2000005C = 0;
      byte_2000011B = 0;
      byte_2000005B = 0;
      byte_20000117 = 0;
      new_adc_data = 0;
      byte_200001EF = 0;
      if ( byte_2000005D == 1 )
      {
        byte_2000005A = 0;
      }
      else if ( current_state == 161 )
      {
        byte_200000AC = 1;
      }
      current_state = 98;
      v2 = uint2double(adc_battery);
      d_lt(v2, 1474.56);
      if ( !v4 )
      {
        error_no = 3;
        current_state = 100;
      }
    }
    if ( !math_mode && !byte_20000114 && dword_200000C8 && !byte_2000006A )
      do_math();
    byte_2000006A = 0;
    if ( (signed int)current_state < 100 )
      error_no = 0;
    if ( (signed int)(unsigned __int8)byte_20000114 > 0 && !math_mode )
    {
      dword_2000025C = dword_20000128;
      dword_20000258[0] = 0;
      dword_200000C8 = 0;
      byte_2000009D = 0;
    }
    if ( (math_mode == 1 || math_mode == 4 || math_mode == 5) && byte_2000009D == 2 )
    {
      dword_20000258[0] = 0;
      dword_2000025C = 0;
      dword_20000260 = 0;
      byte_2000009D = 0;
      digits_clear_all();
      dword_200000C8 = num_result;
      dword_200000C0 = num_result;
      byte_200000F2 = 0;
      byte_20000119 = 0;
    }
    if ( (math_mode == 2 || math_mode == 6 || math_mode == 7) && byte_2000009D == 3 )
    {
      dword_20000258[0] = 0;
      dword_2000025C = 0;
      dword_20000260 = 0;
      byte_2000009D = 0;
      digits_clear_all();
      dword_200000C8 = num_result;
      byte_200000F2 = 0;
      byte_20000119 = 0;
    }
    if ( !error_no )
      lcd_convert_digits();
    for ( i = 0; i < 6; i = (unsigned __int8)(i + 1) )
      digits_4[i] = 0;
    digits_4[6] = 11;
    digits_4[7] = 11;
    digits_4[8] = 11;
    digits_4[9] = 11;
    dword_200000C0 = 0;
    return;
  }
  if ( (signed int)current_state > 100 )
  {
    if ( current_state != 101 )
    {
      if ( current_state == 160 )
      {
        GPIO_Reset(0x48000400, 4);
        GPIO_Reset(0x48000400, 0x2000);
        current_state = -95;
        return;
      }
      if ( current_state != 161 )
      {
        v0 = current_state == 199;
        if ( current_state == 199 )
          return;
        goto LABEL_11;
      }
    }
    goto LABEL_43;
  }
  if ( !current_state )
  {
    if ( (math_mode == 1 || math_mode == 2) && byte_2000009D == 9 )
    {
      byte_2000009D = 0;
      dword_20000BA4 = 0;
      dword_20000BA0 = 0;
      dword_20000B9C = 0;
      math_mode = 0;
      dword_20000260 = 0;
      dword_2000025C = 0;
      dword_20000258[0] = 0;
      digit_1_decimal = 0;
      digit_2_decimal = 0;
      digit_3_decimal = 0;
      digit_4_decimal = 0;
      dword_200000C8 = 0;
    }
    if ( byte_20000114 == 1 && (math_mode == 1 || math_mode == 2) && (unsigned __int8)byte_2000009D == math_mode + 1 )
    {
      dword_20000BA4 += dword_20000BA0;
      dword_20000BA0 = dword_20000B9C;
      dword_20000B9C = num_result;
      dword_20000260 = 10 * dword_20000BA4;
      dword_2000025C = 10 * dword_20000BA0;
      dword_20000258[0] = 10 * num_result;
      num_result += dword_20000BA4 + dword_20000BA0;
      byte_2000009D = 9;
      byte_2000005E = 1;
      byte_20000114 = 0;
      return;
    }
    if ( byte_20000114 == 2 && (math_mode == 1 || math_mode == 2) && (unsigned __int8)byte_2000009D == math_mode + 1 )
    {
      dword_20000B9C += num_result;
      dword_20000260 = 10 * dword_20000BA4;
      dword_2000025C = 0;
      dword_20000258[0] = 10 * dword_20000B9C;
      if ( dword_20000BA4 < (unsigned int)dword_20000B9C )
      {
        num_result = dword_20000B9C - dword_20000BA4;
        byte_2000006A = 1;
      }
      else
      {
        num_result = dword_20000BA4 - dword_20000B9C;
      }
      byte_2000009D = 9;
      byte_2000005E = 1;
      byte_20000114 = 0;
      return;
    }
    goto LABEL_43;
  }
  if ( current_state == 93 )
  {
    GPIO_Reset(0x48000400, 4);
    select_laser(1);
    GPIO_Set(0x48000400, 0x1000);
    byte_200000A6 = 1;
    word_20000112 = 100;
    delay_cycles_16000(5);
    byte_200001DC = 0;
    byte_2000005A = 0;
    word_20000110 = 40;
    si_write_config(0);
    apd_pwm_value = word_2000008C;
    apd_dcdc_set(word_2000008C);
    delay_cycles_16000(8);
    adc_read_battery();
    if ( !apd_signal_level_ok() )
      apd_update_level(1);
    byte_200001EF = 0;
    error_no = 0;
    byte_2000005A = 0;
    si_cfg = 0;
    byte_2000005B = 0;
    byte_20000117 = 0;
    new_adc_data = 0;
    byte_2000011A = 0;
    current_state = 98;
    v6 = uint2double(adc_battery);
    d_lt(v6, 1474.56);
    if ( !v4 )
    {
      error_no = 3;
      current_state = 100;
    }
  }
  else
  {
    if ( current_state != 98 )
    {
      v0 = current_state == 99;
LABEL_11:
      if ( v0 )
      {
        if ( byte_2000005A )
        {
          current_state = 97;
          word_20000112 = 100;
          byte_20000118 = 0;
          byte_200000A9 = 0;
          adc_stop();
          adc_capture_dma(0);
          byte_200000AC = 0;
          new_adc_data = 0;
        }
        else
        {
          byte_200000AC = 1;
        }
      }
      else if ( byte_2000009E && (signed int)(unsigned __int8)byte_2000017F > 0 )
      {
        if ( math_mode )
        {
          byte_200000AD = 1;
          byte_200000AC = 0;
          beep_do(1, 8);
        }
        else
        {
          byte_2000009E = math_mode;
          beep_do(1, 8);
          disable_laser();
          byte_2000009D = 0;
          current_state = 0;
          byte_200000AC = 0;
          byte_200000AD = 1;
        }
      }
      return;
    }
    if ( byte_2000009E && (signed int)(unsigned __int8)byte_2000017F > 0 )
    {
      byte_200000AD = 1;
      disable_laser();
      byte_2000009E = 0;
      current_state = 0;
      byte_200000AC = 0;
    }
  }
}


























































void __cdecl handle_poweron_button()
{
  byte_20000016 = 0;
  byte_20000017 = GPIO_Read(0x48000000, 0x80);
  if ( !byte_20000017 && (signed int)(unsigned __int16)++word_20000062 >= 2 && !someflag )
  {
    timer_downcount = 3000;
    word_2000001E = 30;
    byte_20000090 = 1;
    word_20000094 = 0;
    if ( (current_state == 99 || current_state == 98) && !math_mode && !byte_20000091 )
    {
      if ( !byte_2000009E )
        byte_200000AC = 1;
      byte_20000091 = 1;
    }
  }
}












int __fastcall fm_read_byte(int a1)
{
  int v2; 

  fm_read_buf(&v2, 1, a1, 0xA0);
  return (unsigned __int8)v2;
}


void __fastcall si_i2c_write(int a1)
{
  int v1; 
  signed int v2; 
  signed int v3; 

  v1 = a1;
  v2 = 8;
  while ( 1 )
  {
    v3 = v2;
    v2 = (unsigned __int8)(v2 - 1);
    if ( !v3 )
      break;
    GPIO_Reset(0x48000400, 0x10);
    delay_cycles(3);
    if ( v1 & 0x80 )
      GPIO_Set(0x48000400, 0x20);
    else
      GPIO_Reset(0x48000400, 0x20);
    v1 = 2 * v1 & 0xFF;
    delay_cycles(3);
    GPIO_Set(0x48000400, 16);
    delay_cycles(3);
  }
  GPIO_Reset(0x48000400, 16);
}


signed int si_i2c_start()
{
  signed int result; 

  GPIO_Set(0x48000400, 0x20);
  GPIO_Set(0x48000400, 0x10);
  delay_cycles(3);
  if ( (v48000410 == 0) & 0x20 )
  {
    result = 0;
  }
  else
  {
    GPIO_Reset(0x48000400, 32);
    delay_cycles(3);
    if ( v48000410 & 0x20 )
    {
      result = 0;
    }
    else
    {
      GPIO_Reset(0x48000400, 32);
      delay_cycles(3);
      result = 1;
    }
  }
  return result;
}


void si_i2c_stop()
{
  GPIO_Reset(0x48000400, 0x10);
  delay_cycles(3);
  GPIO_Reset(0x48000400, 0x20);
  delay_cycles(3);
  GPIO_Set(0x48000400, 0x10);
  delay_cycles(3);
  GPIO_Set(0x48000400, 0x20);
  delay_cycles(3);
}


signed int si_i2c_read_ack()
{
  signed int result; 

  GPIO_Reset(1207960576, 16);
  delay_cycles(3);
  GPIO_Set(1207960576, 32);
  delay_cycles(3);
  GPIO_Set(1207960576, 16);
  delay_cycles(3);
  if ( v48000410 & 0x20 )
  {
    GPIO_Reset(1207960576, 16);
    result = 0;
  }
  else
  {
    GPIO_Reset(1207960576, 16);
    result = 1;
  }
  return result;
}


int __fastcall si_write(_BYTE *a1, unsigned int a2, int a3)
{
  unsigned int v3; 
  _BYTE *v4; 
  int result; 
  unsigned int i; 
  int v7; 

  v7 = a3;
  v3 = a2;
  v4 = a1;
  result = si_i2c_start();
  if ( result )
  {
    si_i2c_write(v7);
    if ( si_i2c_read_ack() )
    {
      for ( i = 0; i < v3; i = (unsigned __int8)(i + 1) )
      {
        si_i2c_write(*v4);
        si_i2c_read_ack();
        ++v4;
      }
      si_i2c_stop();
      result = 1;
    }
    else
    {
      si_i2c_stop();
      result = 0;
    }
  }
  return result;
}


void __fastcall tmpbuf_to_eeprom()
{
  byte_2000018F = byte_20000190 - 1;
  tmpbuf[0] = 16 * byte_2000006A | byte_2000009D;
  tmpbuf[1] = math_mode | 16 * byte_20000000;
  *(_DWORD *)&tmpbuf[4] = 0;
  *(_DWORD *)&tmpbuf[8] = 0;
  *(_DWORD *)&tmpbuf[12] = 0;
  switch_(math_mode, (int)tmpbuf);
  JUMPOUT(*(_DWORD *)&word_8009A62);
}







void uart_send_Ata()
{
  char v0; 
  signed int i; 

  v0 = 0;
  byte_20000C34[0] = 'A';
  byte_20000C34[1] = 'T';
  byte_20000C34[2] = 'A';
  byte_20000C34[3] = BYTE3(dword_20000170);
  byte_20000C34[4] = (unsigned int)(dword_20000170 << 8) >> 24;
  byte_20000C34[5] = (unsigned int)(unsigned __int16)dword_20000170 << 16 >> 24;
  byte_20000C34[6] = dword_20000170;
  byte_20000C34[7] = BYTE3(dword_20000174);
  byte_20000C34[8] = (unsigned int)(dword_20000174 << 8) >> 24;
  byte_20000C34[9] = (unsigned int)(unsigned __int16)dword_20000174 << 16 >> 24;
  byte_20000C34[10] = dword_20000174;
  for ( i = 0; i < 11; i = (unsigned __int8)(i + 1) )
    v0 += byte_20000C34[i];
  byte_20000C34[11] = v0;
  byte_20000C34[12] = '#';
  uart1_send_buf(byte_20000C34, 13);
}




void uart_send_Atd()
{
  char v0; 
  signed int i; 

  v0 = 0;
  byte_20000C34[0] = 'A';
  byte_20000C34[1] = 'T';
  byte_20000C34[2] = 'D';
  byte_20000C34[3] = BYTE3(dword_200000C8);
  byte_20000C34[4] = dword_200000C8 << 8 >> 24;
  byte_20000C34[5] = (unsigned int)(unsigned __int16)dword_200000C8 << 16 >> 24;
  byte_20000C34[6] = dword_200000C8;
  byte_20000C34[7] = BYTE3(dword_20000170);
  byte_20000C34[8] = (unsigned int)(dword_20000170 << 8) >> 24;
  byte_20000C34[9] = (unsigned int)(unsigned __int16)dword_20000170 << 16 >> 24;
  byte_20000C34[10] = dword_20000170;
  byte_20000C34[11] = BYTE3(dword_20000170);
  byte_20000C34[12] = (unsigned int)(dword_20000170 << 8) >> 24;
  byte_20000C34[13] = (unsigned int)(unsigned __int16)dword_20000170 << 16 >> 24;
  byte_20000C34[14] = dword_20000170;
  for ( i = 0; i < 15; i = (unsigned __int8)(i + 1) )
    v0 += byte_20000C34[i];
  byte_20000C34[15] = v0;
  byte_20000C34[16] = 35;
  uart1_send_buf(byte_20000C34, 17);
}



void __cdecl uart_send_tmpbuf()
{
  char v0; 
  char *v1; 
  unsigned int i; 

  v0 = 0;
  v1 = tmpbuf;
  for ( i = 1; i < 0x14; i = (unsigned __int8)(i + 1) )
  {
    byte_20000C34[i] = *v1;
    v0 += byte_20000C34[i];
    ++v1;
  }
  byte_20000C34[20] = 0;
  byte_20000C34[21] = v0;
  byte_20000C34[0] = '#';
  uart1_send_buf(byte_20000C34, 22);
}


int sub_8009CE0()
{
  int result; 

  v40022000 = 17;
  v40021004 &= 0xFFC0FFFF;
  v40021004 |= 0x280000u;
  v40021000 |= 0x1000000u;
  while ( !(v40021000 & 0x2000000) )
    ;
  v40021004 = 4 * (v40021004 >> 2);
  v40021004 |= 2u;
  do
    result = v40021004 & 0xC;
  while ( result != 8 );
  return result;
}


void __fastcall apd_dcdc_set(unsigned __int16 a1)
{
  int v1; 

  v1 = a1;
  TIM_Cmd((_WORD *)0x40012C00, 0);
  word_20000C10 = 96;
  word_20000C12 = 1;
  dword_20000C18 = v1;
  word_20000C1C = 0;
  sub_800A068(0x40012C00, (int)&word_20000C10);
  sub_800A0FC(0x40012C00, 8);
  sub_8009FCC((_WORD *)0x40012C00, 1);
  TIM_Cmd((_WORD *)0x40012C00, 1);
  sub_800A00C(0x40012C00, 1);
}






int system_init()
{
  v40021000 |= 1u;
  v40021004 &= 0xF8FFB80C;
  v40021000 &= 0xFEF6FFFF;
  v40021000 &= 0xFFFBFFFF;
  v40021004 &= 0xFFC0FFFF;
  v4002102C = 16 * (v4002102C >> 4);
  v40021030 &= 0xFFFFFEAC;
  v40021034 = 2 * (v40021034 >> 1);
  v40021008 = 0;
  return sub_8009CE0();
}


unsigned int __fastcall delay_cycles8020(unsigned int result)
{
  unsigned int i; 
  signed int j; 

  for ( i = 0; i < result; ++i )
  {
    for ( j = 0; j < 8020; ++j )
      ;
  }
  return result;
}


int __fastcall TI2_Config(int result, int a2, __int16 a3, __int16 a4)
{
  int v4; 

  *(_WORD *)(result + 32) &= 0xFFFEu;
  v4 = (unsigned __int16)(*(_WORD *)(result + 32) & 0xFFF5) | a2 | 1;
  *(_WORD *)(result + 24) = *(_WORD *)(result + 24) & 0xFF0C | 16 * a4 | a3;
  *(_WORD *)(result + 32) = v4;
  return result;
}


int __fastcall TI1_Config(int result, int a2, __int16 a3, __int16 a4)
{
  int v4; 

  *(_WORD *)(result + 0x20) &= 0xFFEFu;
  v4 = (unsigned __int16)(*(_WORD *)(result + 32) & 0xFF5F) | 16 * a2 & 0xFFFF | 0x10;
  *(_WORD *)(result + 0x18) = *(_WORD *)(result + 24) & 0xCFF | (a4 << 12) | (a3 << 8);
  *(_WORD *)(result + 0x20) = v4;
  return result;
}


void tim16_isr()
{
  if ( TIM_GetITFlag(0x40014400, 1u) )
  {
    TIM_ClearITFlag(0x40014400, 1);
    timer_ticked = 1;
    if ( (signed int)(unsigned __int8)++timer_counter10 > 9 )
    {
      timer_counter10 = 0;
      ++timer_count;
      if ( (signed int)(unsigned __int16)timer_downcount > 0 )
        --timer_downcount;
      sub_8001AD4();
    }
  }
}





void __fastcall tim3_init()
{
  __int16 v0; 
  __int16 v1; 
  __int16 v2; 
  __int16 v3; 
  int v4; 

  sub_8008C24(2, 1);
  sub_8008C04(0x20000, 1);
  stru_20000160.pin = 0x40;
  stru_20000160.mode = 2;
  stru_20000160.speed = 3;
  gpio_init(0x48000000, &stru_20000160);
  gpio_set_AF(0x48000000, 6, 1);
  v0 = 0;
  v1 = 0;
  v2 = 2;
  v3 = 0;
  LOWORD(v4) = 0;
  TIM_PWMIConfig(0x40000400, (int)&v0);
  TIM_SelectInputTrigger(0x40000400, 0x50);     
  TIM_SelectSlaveMode(0x40000400, 4);           
  TIM_SelectMasterSlaveMode(0x40000400, 0x80);  
  TIM_Cmd((_WORD *)0x40000400, 1);
  TIM_ITConfig(0x40000400, 0x40, 1);            
}


int tim3_isr()
{
  return TIM_ClearITFlag(0x40000400, 1);
}


_WORD *__fastcall sub_8009FCC(_WORD *result, int a2)
{
  if ( a2 )
    *result |= 0x80u;
  else
    *result &= 0xFF7Fu;
  return result;
}


int __fastcall TIM_ClearITFlag(int result, __int16 a2)
{
  *(_WORD *)(result + 16) = ~a2;
  return result;
}


void __fastcall TIM_Cmd(_WORD *result, int a2)
{
  if ( a2 )
    *result |= 1u;
  else
    *result &= 0xFFFEu;
}


int __fastcall sub_800A00C(int result, int a2)
{
  if ( a2 )
    *(_WORD *)(result + 0x44) |= 0x8000u;
  else
    *(_WORD *)(result + 0x44) &= 0x7FFFu;
  return result;
}


bool __fastcall TIM_GetITFlag(int a1, unsigned __int16 a2)
{
  return *(_WORD *)(a1 + 16) & a2 && *(_WORD *)(a1 + 12) & a2;
}


void __fastcall TIM_ITConfig(int a1, int a2, int a3)
{
  if ( a3 )
    *(_WORD *)(a1 + 0xC) |= a2;
  else
    *(_WORD *)(a1 + 12) &= ~(_WORD)a2;
}


void __fastcall sub_800A068(int result, int a2)
{
  int v2; 
  __int16 v3; 
  int v4; 

  *(_WORD *)(result + 0x20) &= 0xFFFEu;
  LOWORD(v2) = *(_WORD *)(result + 4);
  v3 = *(_WORD *)(result + 0x18) & 0xFF8C | *(_WORD *)a2;
  v4 = *(_WORD *)(result + 0x20) & 0xFFFD | *(_WORD *)(a2 + 12) | *(_WORD *)(a2 + 2);
  if ( result == 1073818624 || result == 1073823744 || result == 1073824768 || result == 1073825792 )
  {
    LOWORD(v4) = (v4 & 0xFFF7 | *(_WORD *)(a2 + 14)) & 0xFFFB | *(_WORD *)(a2 + 4);
    v2 = v2 & 0xFCFF | *(_WORD *)(a2 + 16) | *(_WORD *)(a2 + 18);
  }
  *(_WORD *)(result + 4) = v2;
  *(_WORD *)(result + 0x18) = v3;
  *(_DWORD *)(result + 0x34) = *(_DWORD *)(a2 + 8);
  *(_WORD *)(result + 0x20) = v4;
}


int __fastcall sub_800A0FC(int result, __int16 a2)
{
  *(_WORD *)(result + 24) = *(_WORD *)(result + 24) & 0xFFF7 | a2;
  return result;
}


void __fastcall TIM_PWMIConfig(int a1, int a2)
{
  int v2; 
  int v3; 
  int v4; 
  __int16 v5; 

  v2 = a1;
  v3 = a2;
  if ( *(_WORD *)(a2 + 2) )
    v4 = 0;
  else
    v4 = 2;
  if ( *(_WORD *)(a2 + 4) == 1 )
    v5 = 2;
  else
    v5 = 1;
  if ( *(_WORD *)a2 )
  {
    TI1_Config(a1, *(_WORD *)(a2 + 2), *(_WORD *)(a2 + 4), *(_WORD *)(a2 + 8));
    TIM_SetIC1Prescaler(v2, *(_WORD *)(v3 + 6));
    TI2_Config(v2, v4, v5, *(_WORD *)(v3 + 8));
    TIM_SetIC2Prescaler(v2, *(_WORD *)(v3 + 6));
  }
  else
  {
    TI2_Config(a1, *(_WORD *)(a2 + 2), *(_WORD *)(a2 + 4), *(_WORD *)(a2 + 8));
    TIM_SetIC2Prescaler(v2, *(_WORD *)(v3 + 6));
    TI1_Config(v2, v4, v5, *(_WORD *)(v3 + 8));
    TIM_SetIC1Prescaler(v2, *(_WORD *)(v3 + 6));
  }
}


void __fastcall TIM_SelectInputTrigger(int result, __int16 a2)
{
  *(_WORD *)(result + 8) = *(_WORD *)(result + 8) & 0xFF8F | a2;
}


void __fastcall TIM_SelectMasterSlaveMode(int result, __int16 a2)
{
  *(_WORD *)(result + 8) &= 0xFF7Fu;
  *(_WORD *)(result + 8) |= a2;
}


void __fastcall TIM_SelectSlaveMode(int result, __int16 a2)
{
  *(_WORD *)(result + 8) &= 0xFFF8u;
  *(_WORD *)(result + 8) |= a2;
}


int __fastcall TIM_SetIC2Prescaler(int result, __int16 a2)
{
  *(_WORD *)(result + 24) &= 0xFFF3u;
  *(_WORD *)(result + 24) |= a2;
  return result;
}


int __fastcall TIM_SetIC1Prescaler(int result, __int16 a2)
{
  *(_WORD *)(result + 24) &= 0xF3FFu;
  *(_WORD *)(result + 24) |= a2 << 8;
  return result;
}


int __fastcall sub_800A1FC(int result, int a2)
{
  __int16 v2; 

  v2 = *(_WORD *)result;
  if ( result == 1073818624 || result == 0x40000000 || result == 1073742848 )
    v2 = v2 & 0xFF8F | *(_WORD *)(a2 + 2);
  if ( result != 1073745920 )
    v2 = v2 & 0xFCFF | *(_WORD *)(a2 + 8);
  *(_WORD *)result = v2;
  *(_DWORD *)(result + 44) = *(_DWORD *)(a2 + 4);
  *(_WORD *)(result + 40) = *(_WORD *)a2;
  if ( result == 1073818624 || result == 1073823744 || result == 1073824768 || result == 1073825792 )
    *(_WORD *)(result + 48) = *(_BYTE *)(a2 + 10);
  *(_WORD *)(result + 20) = 1;
  return result;
}


void __fastcall tim16_init()
{
  __int16 v0; 
  __int16 v1; 
  int v2; 
  int v3; 

  sub_8008C44(0x20000, 1);
  v0 = 47999;
  v1 = 0;
  v2 = 4;
  LOWORD(v3) = 0;
  BYTE2(v3) = 0;
  sub_800A1FC(0x40014400, (int)&v0);
  sub_8008A24();
  TIM_ClearITFlag(0x40014400, 1);
  TIM_ITConfig(0x40014400, 1, 1);
  TIM_Cmd((_WORD *)0x40014400, 1);
}


void __fastcall uart1_send_buf(char *result, int a2)
{
  char *v2; 
  int v3; 
  int i; 

  v2 = result;
  v3 = a2;
  for ( i = 0; i < v3; i = (unsigned __int8)(i + 1) )
    uart1_send((unsigned __int8)*v2++);
}


void usart1_isr()
{
  unsigned __int8 v0; 

  if ( sub_800A44E(0x40013800, 0x50105u) )
  {
    v0 = uart_recvbyte(0x40013800);
    uart_process(v0);
  }
  if ( sub_800A43A(0x40013800, 8) )
    sub_800A40C(0x40013800, 8);
  if ( sub_800A43A(0x40013800, 4) )
    sub_800A40C(0x40013800, 4);
  if ( sub_800A43A(0x40013800, 2) )
    sub_800A40C(0x40013800, 2);
  if ( sub_800A43A(0x40013800, 1) )
    sub_800A40C(0x40013800, 1);
  sub_800A44E(0x40013800, 0x70107u);
}


int __fastcall uart1_init(int a1)
{
  int v1; 
  char v3; 
  char v4; 
  char v5; 
  int v6; 
  int v7; 
  int v8; 
  int v9; 
  int v10; 
  int v11; 
  struc_gpio a2; 

  v1 = a1;
  sub_8008C04(0x20000, 1);
  sub_8008C44(0x4000, 1);
  gpio_set_AF(0x48000000, 9, 1);
  gpio_set_AF(0x48000000, 10, 1);
  a2.pin = 0x600;
  a2.mode = 2;
  a2.speed = 3;
  a2.otype = 0;
  a2.pupd = 1;
  gpio_init(0x48000000, &a2);
  v6 = v1;
  v7 = 0;
  v8 = 0;
  v9 = 0;
  v11 = 0;
  v10 = 12;
  sub_800A4E0((unsigned int *)0x40013800, (int)&v6);
  sub_800A49C((_DWORD *)0x40013800, 327941, 1);
  sub_800A410(1073821696, 0x50105u);
  sub_800A422((unsigned int *)0x40013800, 1);
  v3 = 27;
  v4 = 0;
  v5 = 1;
  return sub_80089B4((int)&v3);
}


int __fastcall sub_800A40C(int result, int a2)
{
  *(_DWORD *)(result + 32) = a2;
  return result;
}


int __fastcall sub_800A410(int result, unsigned int a2)
{
  *(_DWORD *)(result + 32) = 1 << (a2 >> 16);
  return result;
}


unsigned int *__fastcall sub_800A422(unsigned int *result, int a2)
{
  if ( a2 )
    *result |= 1u;
  else
    *result = 2 * (*result >> 1);
  return result;
}


bool __fastcall sub_800A43A(int a1, int a2)
{
  return (*(_DWORD *)(a1 + 28) & a2) != 0;
}


bool __fastcall sub_800A44E(int a1, unsigned int a2)
{
  unsigned int v2; 
  unsigned int v3; 
  signed int v4; 
  int v5; 

  v2 = a2;
  v3 = a2 << 16 >> 24;
  v4 = 1 << a2;
  if ( v3 == 1 )
  {
    v5 = v4 & *(_DWORD *)a1;
  }
  else if ( v3 == 2 )
  {
    v5 = v4 & *(_DWORD *)(a1 + 4);
  }
  else
  {
    v5 = v4 & *(_DWORD *)(a1 + 8);
  }
  return v5 && (1 << (v2 >> 16)) & *(_DWORD *)(a1 + 28);
}


_DWORD *__fastcall sub_800A49C(_DWORD *result, int a2, int a3)
{
  unsigned int v3; 
  signed int v4; 

  v3 = (unsigned int)(a2 << 16) >> 24;
  v4 = 1 << a2;
  if ( v3 == 2 )
  {
    ++result;
  }
  else if ( v3 == 3 )
  {
    result += 2;
  }
  if ( a3 )
    *result |= v4;
  else
    *result &= ~v4;
  return result;
}


int __fastcall sub_800A4E0(unsigned int *a1, int a2)
{
  unsigned int *v2; 
  _DWORD *v3; 
  int v4; 
  int v5; 
  __int16 v6; 
  int result; 
  __int16 v8; 
  int v9; 
  int v10; 
  int v11; 
  int v12; 
  int v13; 

  v2 = a1;
  v3 = (_DWORD *)a2;
  v13 = 0;
  *a1 = 2 * (*a1 >> 1);
  v2[1] = v2[1] & 0xFFFFCFFF | *(_DWORD *)(a2 + 8);
  *v2 = *v2 & 0xFFFFE9F3 | *(_DWORD *)(a2 + 4) | *(_DWORD *)(a2 + 12) | *(_DWORD *)(a2 + 16);
  v2[2] = v2[2] & 0xFFFFFCFF | *(_DWORD *)(a2 + 20);
  RCC_GetClock(&v9);
  if ( v2 == (unsigned int *)0x40013800 )
    v13 = v11;
  else
    v13 = v10;
  if ( *v2 & 0x8000 )
    v4 = sub_80001BC(25 * v13, 2 * *v3);
  else
    v4 = sub_80001BC(25 * v13, 4 * *v3);
  v5 = sub_80001BC(v4, 0x64u);
  v6 = 16 * v5;
  v12 = v4 - 100 * (v5 & 0xFFFFFFF);
  if ( *v2 & 0x8000 )
  {
    result = sub_80001BC(8 * v12 + 50, 0x64u) & 7;
    v8 = v6 | result;
  }
  else
  {
    result = sub_80001BC(16 * v12 + 50, 0x64u) & 0xF;
    v8 = v6 | result;
  }
  *((_WORD *)v2 + 6) = v8;
  return result;
}


int __fastcall uart_recvbyte(int a1)
{
  return *(_WORD *)(a1 + 36) & 0x1FF;
}


int __fastcall sub_800A5DE(int result, __int16 a2)
{
  *(_WORD *)(result + 40) = a2 & 0x1FF;
  return result;
}


void __fastcall uart_process(int chin)
{
  char v1; 
  char v2; 
  signed int v3; 

  uart_buf[uart_idx++] = chin;
  if ( (signed int)uart_idx >= 15 )
    uart_idx = 0;
  if ( !byte_20000158 )
  {
    if ( uart_buf[0] != 65 )
      uart_idx = 0;
    if ( uart_idx == 2 && chin != 'T' )
      uart_idx = 0;
    v1 = chin == '#';
    do
    {
      if ( !v1 )
        return;
      v1 = uart_idx == 7;
    }
    while ( uart_idx != 7 );
    if ( uart_buf[2] == 'M' )
    {
      if ( uart_buf[3] == 'D' )
      {
        byte_20000169 = 10 * (uart_buf[4] - 48) + uart_buf[5] - 48;
        if ( (signed int)(unsigned __int8)byte_20000169 > 19 )
          byte_20000169 = 0;
        byte_20000169 += 50;
      }
      goto LABEL_59;
    }
    if ( (signed int)(unsigned __int8)uart_buf[2] > 'M' )
    {
      if ( uart_buf[2] == 'R' )
      {
        if ( uart_buf[3] != 63 || uart_buf[4] != 63 || uart_buf[5] != 63 )
          byte_20000169 = 100 * (uart_buf[3] - '0') + 100 + 10 * (uart_buf[4] - '0') + uart_buf[5] - '0';
        else
          byte_20000169 = 18;
        goto LABEL_59;
      }
      if ( uart_buf[2] == 'S' )
      {
        if ( uart_buf[3] == '0' && uart_buf[4] == '0' && uart_buf[5] == '1' )
          byte_20000169 = 30;
        if ( uart_buf[3] == 'A' && uart_buf[4] == 'V' && uart_buf[5] == 'E' )
          byte_20000169 = 35;
        goto LABEL_59;
      }
      if ( uart_buf[2] == 'T' )
      {
        v3 = (unsigned __int8)(10 * (uart_buf[4] - '0') + uart_buf[5] - '0');
        if ( v3 <= 60 )
          word_20000070 = (unsigned __int8)(10 * (uart_buf[4] - '0') + uart_buf[5] - '0');
        byte_20000169 = 0;
        goto LABEL_59;
      }
      v2 = uart_buf[2] == 'X';
      if ( uart_buf[2] != 'X' )
        goto LABEL_19;
      byte_20000169 = 36;
    }
    else if ( uart_buf[2] == 'D' )
    {
      byte_20000169 = 19;
    }
    else if ( (signed int)(unsigned __int8)uart_buf[2] > 'D' )
    {
      if ( uart_buf[2] == 'I' )
      {
        byte_20000169 = 31;
      }
      else
      {
        v2 = uart_buf[2] == 'K';
        if ( uart_buf[2] != 'K' )
        {
LABEL_19:
          if ( v2 )
            byte_20000169 = '!';
          else
            byte_20000169 = 0;
          goto LABEL_59;
        }
        byte_20000169 = 100 * (uart_buf[3] - '0') + 10 * (uart_buf[4] - '0') + uart_buf[5] - '0';
      }
    }
    else
    {
      if ( uart_buf[2] != 'A' )
      {
        v2 = uart_buf[2] == 'C';
        goto LABEL_19;
      }
      byte_20000169 = 32;
    }
LABEL_59:
    byte_2000016A = 0;
    uart_idx = 0;
    timer_downcount = 3000;
    word_2000001E = 30;
    return;
  }
  if ( uart_buf[0] != 'S' )
    uart_idx = 0;
}






void uart_result()
{
  char v0; 
  char v1; 

  if ( byte_2000016A )
    return;
  byte_2000016A = 1;
  if ( byte_20000169 == 19 )
  {
    uart_send_Atd();
  }
  else if ( (signed int)(unsigned __int8)byte_20000169 > 19 )
  {
    if ( byte_20000169 != 30 && byte_20000169 != 31 )
    {
      v0 = byte_20000169 == ' ';
      if ( byte_20000169 != ' ' )
      {
LABEL_8:
        if ( v0 )
        {
          byte_20000C34[0] = 'A';
          byte_20000C34[1] = 'T';
          byte_20000C34[2] = 'R';
          byte_20000C34[3] = 0;
          byte_20000C34[4] = byte_20000190;
          v1 = 0;
          for ( dword_2000019C = 0; dword_2000019C < 5; ++dword_2000019C )
            v1 += byte_20000C34[dword_2000019C];
          byte_20000C34[5] = v1;
          byte_20000C34[6] = '#';
          uart1_send_buf(byte_20000C34, 7);
        }
        goto LABEL_26;
      }
      uart_send_Ata();
    }
  }
  else if ( byte_20000169 == 1 )
  {
    sub_8008F14();
    beep_do(1, 8);
  }
  else
  {
    if ( byte_20000169 != 2 )
    {
      if ( byte_20000169 == 3 )
      {
        if ( (signed int)(unsigned __int8)++byte_2000013E > 1 )
          byte_2000013E = 0;
        beep_do(1, 8);
        goto LABEL_26;
      }
      v0 = byte_20000169 == 18;
      goto LABEL_8;
    }
    byte_20000018 = byte_20000169 - 1;
    byte_20000019 = 1;
    disable_laser();
    byte_200000AD = 1;
    byte_2000009E = 0;
    byte_2000006C = 1;
    error_no = 0;
    current_state = 0;
    sub_800BC68();
    sub_800C8C0(byte_20000000);
    math_mode = 0;
    byte_2000018E = 1;
    dword_200000C0 = 0;
    digits_clear_4();
    byte_2000005E = 1;
    beep_do(1, 8);
  }
LABEL_26:
  if ( (signed int)(unsigned __int8)byte_20000169 > 0 && (signed int)(unsigned __int8)byte_20000169 < 10 )
  {
    convert_number((unsigned __int8)byte_20000169, 3);
    byte_20000C34[0] = 'A';
    byte_20000C34[1] = 'T';
    byte_20000C34[2] = 'K';
    byte_20000C34[3] = digits[3] + 0x30;
    byte_20000C34[4] = digits[4] + 0x30;
    byte_20000C34[5] = digits[5] + 0x30;
    byte_20000C34[6] = 35;
    uart1_send_buf(byte_20000C34, 7);
  }
  if ( (signed int)(unsigned __int8)byte_20000169 >= 50 && (signed int)(unsigned __int8)byte_20000169 <= 71 )
  {
    byte_20000169 -= 50;
    convert_number((unsigned __int8)byte_20000169, 3);
    byte_20000C34[0] = 'A';
    byte_20000C34[1] = 'T';
    byte_20000C34[2] = 'M';
    byte_20000C34[3] = 'D';
    byte_20000C34[4] = digits[4] + '0';
    byte_20000C34[5] = digits[5] + '0';
    byte_20000C34[6] = '#';
    uart1_send_buf(byte_20000C34, 7);
  }
  if ( (signed int)(unsigned __int8)byte_20000169 > 100 )
  {
    byte_2000018E = byte_20000169 - 100;
    byte_20000159 = 1;
    eeprom_to_tmpbuf();
    byte_20000159 = 0;
    uart_send_tmpbuf();
  }
}

















void __fastcall lcd_send_data(int a1)
{
  signed int i; 

  GPIO_Reset(0x48000400, 0x100);
  GPIO_Reset(0x48000400, 0x40);
  delay_cycles1(60u);
  GPIO_Set(0x48000400, 0x80);
  delay_cycles1(60u);
  GPIO_Set(0x48000400, 0x40);
  for ( i = 0; i < 8; i = (unsigned __int8)(i + 1) )
  {
    GPIO_Reset(0x48000400, 0x40);
    if ( a1 & 0x80 )
      GPIO_Set(0x48000400, 0x80);
    else
      GPIO_Reset(0x48000400, 0x80);
    delay_cycles1(60u);
    GPIO_Set(0x48000400, 0x40);
    delay_cycles1(60u);
    a1 = 2 * a1 & 0xFF;
  }
  GPIO_Set(0x48000400, 0x100);
}


void __fastcall fm_write_buf(_BYTE *a1, unsigned int a2, int a3, int a4)
{
  int v4; 
  unsigned int v5; 
  unsigned int i; 
  unsigned int v7; 
  int v8; 
  unsigned int v9; 
  unsigned int v10; 
  _BYTE *v11; 
  signed int j; 
  int v13; 

  v13 = a4;
  v4 = a3;
  v5 = a2;
  v10 = a2 >> 5;
  v9 = (a2 + a3) >> 5;
  v7 = (a2 + a3) & 0x1F;
  v11 = a1;
  for ( i = a2 >> 5; i <= v9; ++i )
  {
    if ( i == v10 )
    {
      if ( v10 == v9 )
        v8 = v4;
      else
        v8 = (32 - v5) & 0x1F;
    }
    else if ( i == v9 )
    {
      v8 = v7 & 0x1F;
      if ( !(v7 & 0x1F) )
      {
        fm_i2c_stop();
        delay_cycles8020(0xAu);
        return;
      }
    }
    else
    {
      v8 = 0;
    }
    if ( !fm_i2c_start() )
      return;
    fm_i2c_write(v13);
    if ( !fm_i2c_getack() )
    {
      fm_i2c_stop();
      return;
    }
    fm_i2c_write(v5 << 16 >> 24);
    fm_i2c_getack();
    fm_i2c_write((unsigned __int8)v5);
    fm_i2c_getack();
    for ( j = 0; j < 32; j = (unsigned __int8)(j + 1) )
    {
      ++v5;
      fm_i2c_write(*v11);
      fm_i2c_getack();
      ++v11;
      if ( v8 )
      {
        if ( v8 - 1 == j )
          break;
      }
    }
    fm_i2c_stop();
    delay_cycles8020(0xAu);
  }
}


signed int __fastcall fw_write_byte(int adr, int a2)
{
  return fm_write_byte(a2, adr, 160);
}


int __fastcall switch_(int a1, int a2)
{
  unsigned int v2; 
  int v3; 
  unsigned int v4; 

  v4 = *(_BYTE *)(v3 - 1);
  if ( v2 < v4 )
    v4 = v2;
  return ((int (*)(void))(v3 + 2 * *(_BYTE *)(v3 + v4)))();
}


int __fastcall sub_800AC00(int a1, int a2)
{
  unsigned int v2; 
  int result; 

  v2 = 2 * a2;
  result = a1 | (v2 << 11);
  if ( result )
    result = 4;
  if ( v2 >> 21 )
    result |= 1u;
  if ( v2 >> 21 == 2047 )
    result |= 2u;
  if ( result == 1 )
    result = 5;
  return result;
}


double __fastcall sub_800AC2C(int a1, int a2, int a3, int a4)
{
  int v4; 
  int v5; 
  double result; 
  double v7; 
  int v8; 
  double v9; 
  double v10; 
  double v11; 
  double v12; 
  double v13; 
  double v14; 
  double v15; 
  double v16; 
  double v17; 
  double v18; 

  v4 = a1;
  v5 = a2 - 1;
  for ( result = *(double *)(a1 + 8 * a2 - 8); v5 & 0xFFFFFFF9; result = dadd(v7, v9) )
  {
    v7 = sub_8000C3C(result);
    v8 = v4 + 8 * v5 - 8;
    LODWORD(v9) = *(_DWORD *)v8;
    --v5;
    HIDWORD(v9) = *(_DWORD *)(v8 + 4);
  }
  if ( v5 != 2 )
  {
    if ( v5 != 4 )
    {
      if ( v5 != 6 )
        return result;
      v10 = sub_8000C3C(result);
      v11 = dadd(v10, *(double *)(v4 + 40));
      v12 = sub_8000C3C(v11);
      result = dadd(v12, *(double *)(v4 + 32));
    }
    v13 = sub_8000C3C(result);
    v14 = dadd(v13, *(double *)(v4 + 24));
    v15 = sub_8000C3C(v14);
    result = dadd(v15, *(double *)(v4 + 16));
  }
  v16 = sub_8000C3C(result);
  v17 = dadd(v16, *(double *)(v4 + 8));
  v18 = sub_8000C3C(v17);
  return dadd(v18, *(double *)v4);
}


int sub_800ACD8()
{
  return sub_80011CC(0, 0x10000000, -767);
}


void sub_800ACEC()
{
  unsigned int v0; 
  signed int i; 
  unsigned int v2; 
  float v3; 
  signed int j; 
  float v5; 
  float v6; 
  float v7; 
  double v8; 
  double v9; 
  double v10; 
  double v11; 
  float v12; 

  v0 = 0;
  for ( i = 0; i < 64; i = (unsigned __int16)(i + 1) )
    v0 += adc_data_copy[i];
  v2 = v0 >> 6;
  v3 = 0.0;
  for ( j = 0; j < 64; j = (unsigned __int16)(j + 1) )
  {
    v5 = i2f(adc_data_copy[j]);
    v6 = i2f(v2);
    v7 = sub_800F728(v6, v5);
    v8 = f2d(v7);
    HIDWORD(v8) = (unsigned int)(2 * HIDWORD(v8)) >> 1;
    v9 = v8;
    v10 = f2d(v3);
    v11 = dadd(v10, v9);
    v3 = d2f(v11);
  }
  v12 = fdiv(v3, 64.0);
  signal_level = sub_8001098(v12);
  if ( signal_level < 8 )
  {
    apd_update_level(0);
    byte_20000117 = 0;
    byte_2000005A = 0;
  }
  if ( signal_level > 1000 )
  {
    byte_20000117 = 0;
    byte_2000005A = 0;
  }
  if ( (signal_level < 8 || signal_level > 1000) && byte_2000005A != 1 )
  {
    if ( (signed int)(unsigned __int8)++byte_2000011A > 64 )
    {
      current_state = 100;
      apd_pwm_value = word_200000B6;
      error_no = 1;
    }
    byte_20000117 = 0;
    if ( signal_level >= 1000 )
    {
      if ( (signed int)apd_pwm_value <= 68 )
      {
        if ( !byte_2000005D )
        {
          apd_update_level((unsigned __int8)byte_2000005D);
          byte_20000117 = 0;
          byte_2000005A = 0;
        }
      }
      else
      {
        if ( signal_level < 1200 )
          --apd_pwm_value;
        else
          apd_pwm_value -= 2;
        apd_dcdc_set(apd_pwm_value);
        handle_poweron_button();
        delay_cycles_16000(4);
      }
    }
    if ( signal_level < 8 )
    {
      if ( (signed int)apd_pwm_value >= 400 )
      {
        if ( !byte_2000005D )
        {
          apd_update_level((unsigned __int8)byte_2000005D);
          byte_20000117 = 0;
          byte_2000005A = 0;
        }
      }
      else
      {
        apd_dcdc_set(++apd_pwm_value);
        delay_cycles_16000(3);
      }
    }
  }
  else if ( (signed int)++byte_20000117 > 8 )
  {
    byte_2000005A = 1;
    byte_2000011A = 0;
    if ( byte_200000AC )
    {
      if ( byte_2000005A )
      {
        sub_8008F14();
        byte_20000091 = 1;
      }
    }
  }
}









signed int sub_800AEFC()
{
  signed int max; 
  int v1; 
  signed int i; 
  signed int result; 

  max = 0;
  v1 = 0;
  for ( i = 0; i < 64; i = (unsigned __int16)(i + 1) )
  {
    if ( adc_data_copy[i] > (signed int)signal_max )
      v1 = (unsigned __int8)(v1 + 1);
    if ( adc_data_copy[i] > max )
      max = adc_data_copy[i];
  }
  if ( v1 || max <= 2048 )
  {
    if ( (signed int)apd_pwm_value <= 68 )
    {
      result = 1;
    }
    else
    {
      apd_dcdc_set(--apd_pwm_value);
      delay_cycles_16000(4);
      result = 0;
    }
  }
  else
  {
    result = 1;
  }
  return result;
}


void __cdecl sub_800AF74()
{
  unsigned int v0; 
  signed int i; 
  unsigned int v2; 
  float v3; 
  signed int j; 
  float v5; 
  float v6; 
  float v7; 
  double v8; 
  double v9; 
  double v10; 
  double v11; 
  float v12; 

  v0 = 0;
  for ( i = 0; i < 64; i = (unsigned __int16)(i + 1) )
    v0 += adc_data_copy[i];
  v2 = v0 >> 6;
  v3 = 0.0;
  for ( j = 0; j < 64; j = (unsigned __int16)(j + 1) )
  {
    v5 = i2f(adc_data_copy[j]);
    v6 = i2f(v2);
    v7 = sub_800F728(v6, v5);
    v8 = f2d(v7);
    HIDWORD(v8) = (unsigned int)(2 * HIDWORD(v8)) >> 1;
    v9 = v8;
    v10 = f2d(v3);
    v11 = dadd(v10, v9);
    v3 = d2f(v11);
  }
  v12 = fdiv(v3, 64.0);
  signal_level = sub_8001098(v12);
  if ( signal_level < 1000 )
  {
    byte_200001AE = 1;
    byte_200001EE = 1;
  }
  else if ( (signed int)apd_pwm_value > 68 )
  {
    apd_dcdc_set(--apd_pwm_value);
    delay_cycles_16000(4);
  }
}




int __fastcall sub_800B04C(double a1)
{
  double v1; 
  int result; 
  signed int v3; 
  double v4; 
  double v5; 
  double v6; 
  double v7; 
  double v8; 
  double v9; 
  double v10; 
  double v11; 
  double v12; 
  double v13; 
  double v14; 
  double v15; 
  double v16; 
  double v17; 
  double v18; 
  double v19; 
  double v20; 
  double v21; 
  signed int v22; 
  double v23; 
  double v24; 
  double v25; 

  v1 = a1;
  LODWORD(a1) = (unsigned int)(2 * HIDWORD(a1)) >> 1;
  if ( SLODWORD(a1) >= 0x44100000 )
  {
    if ( SLODWORD(a1) > 0x7FF00000 || LODWORD(a1) == 0x7FF00000 && LODWORD(v1) )
      result = sub_80011CC(SLODWORD(v1), SHIDWORD(a1), 1);
    else
      result = 0x54442D18;
    return result;
  }
  if ( SLODWORD(a1) >= 0x3FDC0000 )
  {
    HIDWORD(v1) = (unsigned int)(2 * HIDWORD(a1)) >> 1;
    if ( SLODWORD(a1) >= 0x3FF30000 )
    {
      if ( SLODWORD(a1) >= 0x40038000 )
      {
        v3 = 3;
        v1 = sub_80006E4(-1.0, v1);
      }
      else
      {
        v3 = 2;
        v9 = sub_8000C3C(v1);
        v10 = dadd(v9, 1.0);
        v11 = dsub(v1, 1.5);
        v1 = sub_80006E4(v11, v10);
      }
    }
    else if ( SLODWORD(a1) >= 1072037888 )
    {
      v3 = 1;
      v7 = dadd(v1, 1.0);
      v8 = dsub(v1, 1.0);
      v1 = sub_80006E4(v8, v7);
    }
    else
    {
      v3 = 0;
      v4 = dadd(v1, 2.0);
      LODWORD(v5) = sub_80011CC(SLODWORD(v1), SHIDWORD(v1), 1);
      v6 = dsub(v5, 1.0);
      v1 = sub_80006E4(v6, v4);
    }
    goto LABEL_20;
  }
  if ( SLODWORD(a1) >= 1042284544 )
  {
    v3 = -1;
LABEL_20:
    v12 = sub_8000C3C(v1);
    v13 = sub_8000C3C(v12);
    v14 = v13;
    v15 = sub_800AC2C((int)&unk_800FCE0, 6, SLODWORD(v13), SHIDWORD(v13));
    v25 = sub_8000C3C(v15);
    v16 = sub_800AC2C((int)dword_800FCB8, 5, SLODWORD(v14), SHIDWORD(v14));
    v17 = sub_8000C3C(v16);
    if ( v3 >= 0 )
    {
      v20 = dadd(v25, v17);
      v21 = sub_8000C3C(v20);
      v22 = v3;
      v23 = dsub(v21, unk_800FC98[v22]);
      v24 = dsub(v23, v1);
      result = COERCE_UNSIGNED_INT64(sub_80006B6(v24, *(double *)((char *)&unk_800FC78 + v22 * 8)));
    }
    else
    {
      v18 = dadd(v25, v17);
      v19 = sub_8000C3C(v18);
      result = COERCE_UNSIGNED_INT64(sub_80006B6(v19, v1));
    }
    return result;
  }
  if ( sub_800AC00(SLODWORD(v1), SHIDWORD(a1)) == 4 )
    sub_800ACD8();
  return LODWORD(v1);
}



double __fastcall atan2(double result, double a2)
{
  signed int v2; 
  unsigned int v3; 
  signed int v4; 
  int v5; 
  int v6; 
  int v7; 
  double v8; 
  double v9; 
  double v10; 
  signed int v11; 

  v11 = HIDWORD(a2);
  v2 = HIDWORD(a2);
  v3 = (unsigned int)(2 * HIDWORD(a2)) >> 1;
  HIDWORD(a2) = (unsigned int)(2 * HIDWORD(result)) >> 1;
  v5 = HIDWORD(result);
  if ( (((LODWORD(a2) | (unsigned int)-LODWORD(a2)) >> 31) | v3) > 0x7FF00000
    || ((((unsigned int)-LODWORD(result) | LODWORD(result)) >> 31) | v4) > 0x7FF00000 )
  {
    HIDWORD(a2) = v2;
    return dadd(result, a2);
  }
  if ( !((v2 - 0x3FF00000) | LODWORD(a2)) )
  {
    LODWORD(result) = sub_800B04C(result);
    return result;
  }
  v6 = (v2 >> 30) & 2 | (HIDWORD(result) >> 31);
  if ( !(LODWORD(result) | v4) )
  {
    if ( !v6 || v6 == 1 )
      return result;
    if ( v6 == 2 )
      return 3.14159265;
    if ( v6 == 3 )
      return -3.14159265;
  }
  if ( !(LODWORD(a2) | v3) )
  {
    if ( SHIDWORD(result) < 0 )
      return -1.57079633;
    return 1.57079633;
  }
  if ( v3 != 0x7FF00000 )
    goto LABEL_23;
  if ( v4 != 0x7FF00000 )
  {
    if ( !v6 )
      return 0.0;
    if ( v6 == 1 )
      return -0.0;
    if ( v6 != 2 )
    {
      if ( v6 != 3 )
        goto LABEL_23;
      return -3.14159265;
    }
    return 3.14159265;
  }
  v3 = 0x3FF00000;
  v4 = 0x3FF00000;
  HIDWORD(result) = 0x3FF00000;
  v11 = 0x3FF00000;
LABEL_23:
  if ( v4 == 0x7FF00000 )
  {
    if ( v5 < 0 )
      return -1.57079633;
    return 1.57079633;
  }
  v7 = (signed int)(v4 - v3) >> 20;
  if ( v7 <= 60 )
  {
    if ( v2 >= 0 || v7 >= -60 )
    {
      HIDWORD(a2) = v11;
      v8 = sub_80006E4(result, a2);
      HIDWORD(v8) = (unsigned int)(2 * HIDWORD(v8)) >> 1;
      LODWORD(result) = sub_800B04C(v8);
    }
    else
    {
      result = 0.0;
    }
  }
  else
  {
    result = 1.57079633;
  }
  if ( v6 )
  {
    if ( v6 == 1 )
    {
      HIDWORD(result) ^= 0x80000000;
    }
    else if ( v6 == 2 )
    {
      v10 = dsub(result, 1.2246468e-16);
      result = sub_80006B6(v10, 3.14159265);
    }
    else
    {
      v9 = dsub(result, 1.2246468e-16);
      result = dsub(v9, 3.14159265);
    }
  }
  return result;
}



void __fastcall beep_do(int result, char a2)
{
  if ( beep_enabled )
  {
    byte_2000012C = a2;
    byte_20000198 = result;
  }
  else
  {
    byte_20000198 = 0;
  }
}





void __cdecl beep_do_()
{
  if ( beep_enabled )
    byte_20000198 = 2;
  else
    byte_20000198 = 0;
}




int __fastcall sub_800B42C(int result, signed int a2)
{
  int v2; 
  signed int v3; 
  signed int i; 
  int j; 
  char v6; 
  int v7; 

  v2 = result;
  v3 = a2;
  for ( i = 1; i < v3; i = (unsigned __int8)(i + 1) )
  {
    for ( j = 0; v3 - i > j; j = (unsigned __int8)(j + 1) )
    {
      f_gt(*(float *)(v2 + 4 * j), *(float *)(v2 + 4 * (j + 1)));
      if ( !v6 )
      {
        v7 = *(_DWORD *)(v2 + 4 * j);
        *(_DWORD *)(v2 + 4 * j) = *(_DWORD *)(v2 + 4 * (j + 1));
        *(_DWORD *)(v2 + 4 * (j + 1)) = v7;
      }
    }
    result = i + 1;
  }
  return result;
}


int __fastcall sub_800B476(int result, signed int a2)
{
  int v2; 
  signed int i; 
  int v4; 

  v2 = result;
  for ( i = 1; i < a2; i = (unsigned __int8)(i + 1) )
  {
    for ( result = 0; a2 - i > result; result = (unsigned __int8)(result + 1) )
    {
      if ( *(_DWORD *)(v2 + 4 * result) > *(_DWORD *)(v2 + 4 * (result + 1)) )
      {
        v4 = *(_DWORD *)(v2 + 4 * result);
        *(_DWORD *)(v2 + 4 * result) = *(_DWORD *)(v2 + 4 * (result + 1));
        *(_DWORD *)(v2 + 4 * (result + 1)) = v4;
      }
    }
  }
  return result;
}


void __fastcall sub_800B4B8()
{
  int i; 
  float v1; 
  double v2; 
  char v3; 
  double v4; 
  double v5; 
  double v6; 
  double v7; 
  double v8; 
  double v9; 
  double v10; 
  double v11; 
  double v12; 
  double v13; 
  double v14; 
  double v15; 

  for ( i = 0; i < byte_20000189; i = (unsigned __int8)(i + 1) )
  {
    v1 = fsub(*(float *)&dword_20000D8C[i], *(float *)&dword_20000D0C[i]);
    dword_20000034 = v1;
    v2 = f2d(v1);
    d_lt(v2, 0.0);
    if ( !v3 )
    {
      v4 = f2d(dword_20000034);
      v5 = dadd(v4, 360.0);
      dword_20000034 = d2f(v5);
    }
    if ( byte_200000A6 )
      dword_20000034 = fadd(dword_20000034, dword_200000E4);
    else
      dword_20000034 = fadd(dword_20000034, dword_200000EC);
    v6 = f2d(dword_20000034);
    d_lt(v6, 0.0);
    if ( !v3 )
    {
      v7 = f2d(dword_20000034);
      v8 = dadd(v7, 360.0);
      dword_20000034 = d2f(v8);
    }
    v9 = f2d(dword_20000034);
    d_gt(v9, 360.0);
    if ( !v3 )
    {
      v10 = f2d(dword_20000034);
      v11 = dsub(v10, 360.0);
      dword_20000034 = d2f(v11);
    }
    v12 = f2d(dword_20000034);
    v13 = sub_8000C3C(v12);
    laser1_phase_max = d2f(v13);
    LODWORD(laser1_phase_min) = 0x43A00000;
    v14 = f2d(320.0);
    v15 = sub_8000C3C(v14);
    laser1_phase_min = d2f(v15);
    laser1_phase_max = fdiv(laser1_phase_max, laser1_phase_min);
    dword_20000C8C[i] = laser1_phase_max;
    sub_800B658(320.0, i);
    dword_20000264[i] = sub_8001098(dword_200000E8);
  }
}






int __fastcall sub_800B658(float a1, int a2)
{
  float v2; 
  int v3; 
  float v4; 
  double v5; 
  double v6; 
  unsigned __int8 v7; 
  double v8; 
  double v9; 
  float v10; 
  double v11; 
  double v12; 
  double v13; 
  double v14; 
  char v15; 
  double v16; 
  double v17; 
  double v18; 
  float v19; 
  float v20; 
  double v21; 
  double v22; 

  v2 = a1;
  v3 = a2;
  dword_20000034 = dword_20000040;
  v4 = fmul(a1, dword_20000040);
  dword_20000034 = v4;
  v5 = f2d(v4);
  v6 = sub_80006E4(v5, 299792.458);
  v7 = double2uint(v6);
  v8 = uint2double(v7);
  v9 = sub_8000C3C(v8);
  dword_20000034 = d2f(v9);
  dword_20000034 = fdiv(dword_20000034, v2);
  dword_20000034 = fadd(dword_20000034, dword_20000C8C[v3]);
  v10 = dword_20000034;
  dword_20000034 = fsub(dword_20000034, dword_20000040);
  v11 = f2d(v2);
  v12 = sub_80006E4(299792.458, v11);
  dword_20000200 = d2f(v12);
  v13 = f2d(*(float *)&dword_20000200);
  v14 = sub_80006E4(v13, 2.0);
  dword_20000204 = d2f(v14);
  laser1_phase_max = v10;
  f_gt(dword_20000034, 0.0);
  if ( v15 )
  {
    LODWORD(dword_20000034) ^= 0x80000000;
    f_gt(dword_20000034, *(float *)&dword_20000204);
    if ( !v15 )
      laser1_phase_max = fadd(v10, *(float *)&dword_20000200);
  }
  else
  {
    f_gt(dword_20000034, *(float *)&dword_20000204);
    if ( !v15 )
      laser1_phase_max = fsub(v10, *(float *)&dword_20000200);
  }
  v16 = f2d(laser1_phase_max);
  d_lt(v16, 0.00001);
  if ( !v15 )
    LODWORD(laser1_phase_max) = 0;
  v17 = f2d(laser1_phase_max);
  v18 = dadd(v17, 0.5);
  v19 = d2f(v18);
  v20 = v19;
  v21 = f2d(v19);
  v22 = sub_8000C3C(v21);
  dword_200000E8 = d2f(v22);
  return LODWORD(v20);
}




float __fastcall sub_800B814(int a1, int a2, int a3)
{
  int v3; 
  int v4; 
  float v5; 
  double v6; 
  char v7; 
  double v8; 
  double v9; 
  double v10; 
  double v11; 
  float v12; 
  double v13; 
  double v14; 
  float v15; 
  float v16; 
  double v17; 
  double v18; 
  double v19; 
  double v20; 
  float v21; 

  v3 = a1;
  v4 = a2;
  if ( a1 == a2 )
  {
    laser1_phase_max = flt_20000EEC[a1];
    v17 = f2d(laser1_phase_max);
    v18 = sub_8000C3C(v17);
    laser1_phase_min = d2f(v18);
    v19 = f2d(*(float *)&dword_800FBA4[v3]);
    v20 = sub_8000C3C(v19);
    v21 = d2f(v20);
    v16 = fdiv(laser1_phase_min, v21);
  }
  else
  {
    dword_20000034 = flt_20000EEC[a1];
    laser1_phase_max = flt_20000EEC[a2];
    v5 = fsub(laser1_phase_max, dword_20000034);
    laser1_phase_max = v5;
    v6 = f2d(v5);
    d_lt(v6, 0.000000001);
    if ( !v7 )
    {
      v8 = f2d(laser1_phase_max);
      v9 = dadd(v8, 360.0);
      laser1_phase_max = d2f(v9);
    }
    v10 = f2d(laser1_phase_max);
    v11 = sub_8000C3C(v10);
    laser1_phase_min = d2f(v11);
    v12 = fsub(*(float *)&dword_800FBA4[v4], *(float *)&dword_800FBA4[v3]);
    v13 = f2d(v12);
    v14 = sub_8000C3C(v13);
    v15 = d2f(v14);
    v16 = fdiv(laser1_phase_min, v15);
  }
  return v16;
}



void __fastcall sub_800B958(int a1, int a2)
{
  byte_200001F7 = 1;
  if ( a1 )
    laser1_phase[a2][byte_200001C2] = calc_phase(word_20000AE8, 64);
  else
    laser2_phase[a2][byte_200001C2] = calc_phase(word_20000AE8, 64);
}



void __fastcall sub_800B9AC(_WORD *result, int a2)
{
  _WORD *v2; 
  int v3; 
  signed int v4; 
  signed int i; 
  signed int j; 
  _WORD *v7; 
  signed int k; 
  signed int l; 
  signed int m; 
  _WORD *v11; 
  signed int n; 

  v2 = result;
  v3 = a2;
  v4 = 0;
  if ( byte_200001C3 == 1 )
  {
    for ( i = 0; i < 64; i = (unsigned __int16)(i + 1) )
    {
      *result = 0;
      ++result;
    }
    if ( !v3 )
      v4 = 1;
    for ( j = 0; j < 4; j = (unsigned __int16)(j + 1) )
    {
      v7 = v2;
      for ( k = 0; k < 64; k = (unsigned __int16)(k + 1) )
      {
        *v7 += adc_data_copy[v4];
        ++v7;
        v4 = (unsigned __int16)(v4 + 2);
      }
    }
  }
  else
  {
    for ( l = 0; l < 64; l = (unsigned __int16)(l + 1) )
    {
      *result = 0;
      ++result;
    }
    for ( m = 0; m < 8; m = (unsigned __int16)(m + 1) )
    {
      v11 = v2;
      for ( n = 0; n < 64; n = (unsigned __int16)(n + 1) )
      {
        *v11 += adc_data_copy[v4];
        ++v11;
        v4 = (unsigned __int16)(v4 + 1);
      }
    }
  }
}



void sub_800BA54()
{
  if ( byte_2000009E && byte_2000010D )
  {
    if ( !byte_20000199 )
    {
      if ( byte_2000010E == 1 )
      {
        byte_2000006C = 0;
        beep_do(4, 8);
      }
      if ( byte_2000010E == 2 )
      {
        byte_2000006C = 2;
        beep_do(4, 8);
      }
      if ( byte_2000010E == 3 )
      {
        byte_2000006C = 1;
        beep_do(1, 9);
      }
      if ( (unsigned __int8)byte_200000AF != (unsigned __int8)byte_2000006C )
        byte_200000AF = byte_2000006C;
      if ( (unsigned int)dword_200000BC < 0x3E8 && byte_2000010E != 3 )
        byte_2000012C = 8;
    }
  }
  else if ( byte_2000009E )
  {
    byte_2000006C = 1;
    if ( byte_200000AF != 1 )
      byte_200000AF = byte_2000006C;
    beep_do(4, 8);
  }
}










void __cdecl sub_800BB28()
{
  signed int i; 
  char v1; 
  float v2; 
  double v3; 
  signed int v4; 

  byte_200001AE = 0;
  byte_2000009A = 0;
  laser1_phase[0][(unsigned __int8)byte_20000118++] = calc_phase(adc_data_copy, 64);
  if ( (signed int)(unsigned __int8)byte_20000118 >= 3 )
  {
    byte_20000118 = 0;
    laser1_phase_max = laser1_phase[0][0];
    laser1_phase_min = laser1_phase[0][0];
    for ( i = 1; i < 3; i = (unsigned __int8)(i + 1) )
    {
      f_lt(laser1_phase_max, laser1_phase[0][i]);
      if ( !v1 )
        laser1_phase_max = laser1_phase[0][i];
      f_gt(laser1_phase_min, laser1_phase[0][i]);
      if ( !v1 )
        laser1_phase_min = laser1_phase[0][i];
    }
    v2 = fsub(laser1_phase_max, laser1_phase_min);
    v3 = f2d(v2);
    d_gt(v3, 2.0);
    if ( v1 )
    {
      byte_2000009A = 1;
    }
    else
    {
      if ( !somemagicflag )
      {
        GPIO_Reset(0x48000400, 0x1000);
        byte_200000A6 = 0;
        new_adc_data = 0;
        v4 = 0;
        while ( !byte_200001AE )
        {
          if ( new_adc_data )
          {
            if ( v4 )
            {
              sub_800AF74();
            }
            else if ( sub_800AEFC() )
            {
              v4 = 1;
            }
            new_adc_data = 0;
          }
        }
      }
      byte_2000009A = 1;
    }
  }
}








void sub_800BC54()
{
  byte_2000009B = 0;
  new_adc_data = 0;
}




void __cdecl sub_800BC68()
{
  current_state = 0;
  dword_20000258[0] = 0;
  dword_2000025C = 0;
  dword_20000260 = 0;
  byte_2000009D = 0;
  byte_200000F2 = 0;
  digit_1_decimal = 0;
  digit_2_decimal = 0;
  digit_3_decimal = 0;
  digit_4_decimal = 0;
  for ( dword_20000100 = 0; (unsigned int)dword_20000100 < 0xA; ++dword_20000100 )
    digits_4[dword_20000100] = 0;
  byte_2000006A = 0;
}













float __fastcall sub_800BCD4(float a1, int a2)
{
  int v2; 
  double v3; 
  double v4; 
  float result; 
  double v6; 
  double v7; 
  double v8; 
  float v9; 
  double v10; 
  double v11; 
  double v12; 
  double v13; 
  double v14; 

  v2 = a2;
  v3 = f2d(a1);
  v4 = sub_80006E4(v3, 10.0);
  result = d2f(v4);
  dword_20000034 = result;
  if ( !v2 )
  {
    v6 = f2d(dword_20000034);
    v7 = sub_80006E4(v6, 3.048);
    v8 = dadd(v7, 0.5);
    result = d2f(v8);
    dword_20000034 = result;
  }
  if ( v2 == 2 )
  {
    v9 = fdiv(dword_20000034, 10.0);
    v10 = f2d(v9);
    v11 = dadd(v10, 0.5);
    result = d2f(v11);
    dword_20000034 = result;
  }
  if ( v2 == 3 )
  {
    v12 = f2d(dword_20000034);
    v13 = sub_80006E4(v12, 2.53999);
    v14 = dadd(v13, 0.5);
    result = d2f(v14);
    dword_20000034 = result;
  }
  return result;
}


void __fastcall do_math()
{
  int v0; 
  double v1; 
  double v2; 
  float v3; 
  float v4; 
  double v5; 
  double v6; 
  int v7; 
  double v8; 
  double v9; 
  double v10; 
  double v11; 
  int v12; 
  double v13; 
  double v14; 
  double v15; 
  double v16; 
  double v17; 
  signed __int64 v18; 
  double v19; 
  double v20; 
  double v21; 
  double v22; 
  double v23; 
  signed __int64 v24; 

  if ( (signed int)(unsigned __int8)error_no <= 0 && byte_200000AE != 2 && math_mode < 8u )
  {
    switch ( math_mode )
    {
      case 0u:
        if ( byte_2000009E )
        {
          if ( !byte_2000010D )
          {
            dword_2000025C = dword_200000D4;
            dword_20000258[0] = dword_200000D8;
          }
        }
        else if ( byte_20000119 )
        {
          dword_20000260 = dword_2000025C;
          dword_2000025C = dword_20000258[0];
          dword_20000258[0] = dword_200000C8;
          digit_1_decimal = digit_2_decimal;
          digit_2_decimal = digit_3_decimal;
          digit_3_decimal = digit_4_decimal;
        }
        else if ( byte_200000F2 )
        {
          if ( byte_200000F2 == 1 )
          {
            dword_2000025C = dword_20000258[0];
            dword_20000258[0] = dword_200000C8;
            byte_200000F2 = 2;
            byte_20000119 = 1;
            digit_2_decimal = digit_3_decimal;
            digit_3_decimal = digit_4_decimal;
          }
        }
        else
        {
          dword_20000258[0] = dword_200000C8;
          byte_200000F2 = 1;
          digit_3_decimal = digit_4_decimal;
        }
        break;
      default:
        return;
      case 1u:
        if ( byte_2000009D )
        {
          if ( byte_2000009D == 1 )
          {
            if ( byte_2000009E )
            {
              if ( !dword_200000D8 )
                dword_200000D8 = dword_200000C8;
              if ( dword_200000D8 > dword_200000C8 )
                dword_200000D8 = dword_200000C8;
              dword_2000025C = dword_200000D8;
            }
            else
            {
              if ( !dword_200000D8 )
                dword_2000025C = dword_200000C8;
              num_result = dword_20000260 * dword_2000025C;
              v0 = sub_80001BC(dword_20000260 * dword_2000025C, 1000u);
              num_result = v0;
              v1 = uint2double(v0);
              v2 = dadd(v1, 0.5);
              num_result = double2uint(v2);
              byte_2000009D = 2;
            }
            if ( !current_state )
              byte_200000F3 = 1;
          }
        }
        else if ( byte_2000009E )
        {
          if ( !dword_200000D8 )
            dword_200000D8 = dword_200000C8;
          if ( dword_200000D8 > dword_200000C8 )
            dword_200000D8 = dword_200000C8;
          dword_20000260 = dword_200000D8;
        }
        else
        {
          if ( !dword_200000D8 )
            dword_20000260 = dword_200000C8;
          byte_2000009D = 1;
          byte_20000090 = 1;
        }
        break;
      case 2u:
        if ( byte_2000009D )
        {
          if ( byte_2000009D == 1 )
          {
            if ( byte_2000009E )
            {
              if ( !dword_200000D8 )
                dword_200000D8 = dword_200000C8;
              if ( dword_200000D8 > dword_200000C8 )
                dword_200000D8 = dword_200000C8;
              dword_2000025C = dword_200000D8;
            }
            else
            {
              if ( !dword_200000D8 )
                dword_2000025C = dword_200000C8;
              byte_2000009D = 2;
              byte_20000090 = 1;
            }
          }
          else if ( byte_2000009D == 2 )
          {
            if ( byte_2000009E )
            {
              if ( !dword_200000D8 )
                dword_200000D8 = dword_200000C8;
              if ( dword_200000D8 > dword_200000C8 )
                dword_200000D8 = dword_200000C8;
              dword_20000258[0] = dword_200000D8;
            }
            else
            {
              if ( !dword_200000D8 )
                dword_20000258[0] = dword_200000C8;
              byte_2000009D = 3;
              dword_20000034 = i2f(dword_20000258[0]);
              v3 = i2f(dword_20000260);
              dword_20000034 = fmul(v3, dword_20000034);
              dword_20000034 = fdiv(dword_20000034, 1000.0);
              v4 = i2f(dword_2000025C);
              dword_20000034 = fmul(v4, dword_20000034);
              dword_20000034 = fdiv(dword_20000034, 1000.0);
              num_result = sub_8001098(dword_20000034);
            }
            if ( !current_state )
              byte_200000F3 = 1;
          }
        }
        else if ( byte_2000009E )
        {
          if ( !dword_200000D8 )
            dword_200000D8 = dword_200000C8;
          if ( dword_200000D8 > dword_200000C8 )
            dword_200000D8 = dword_200000C8;
          dword_20000260 = dword_200000D8;
        }
        else
        {
          if ( !dword_200000D8 )
            dword_20000260 = dword_200000C8;
          byte_2000009D = 1;
          byte_20000090 = 1;
        }
        break;
      case 4u:
        if ( byte_2000009D )
        {
          if ( byte_2000009D == 1 )
          {
            if ( byte_2000009E )
            {
              if ( !dword_200000D8 )
                dword_200000D8 = dword_200000C8;
              if ( dword_200000D8 > dword_200000C8 )
                dword_200000D8 = dword_200000C8;
              dword_2000025C = dword_200000D8;
            }
            else if ( !dword_200000D8 )
            {
              dword_2000025C = dword_200000C8;
            }
            if ( !byte_2000009E )
            {
              byte_2000009D = 2;
              if ( dword_2000025C >= (unsigned int)dword_20000260 )
              {
                current_state = 100;
                error_no = 5;
                byte_20000058 = 100;
              }
              else
              {
                dword_20000128 = dword_2000025C * dword_2000025C;
                num_result = dword_20000260 * dword_20000260 - dword_2000025C * dword_2000025C;
                v5 = uint2double((unsigned __int16)dword_20000260 * (unsigned __int16)dword_20000260 - (unsigned __int16)dword_2000025C * (unsigned __int16)dword_2000025C);
                v6 = dsqrt(v5);
                v7 = double2uint(v6);
                num_result = v7;
                v8 = uint2double(v7);
                v9 = dadd(v8, 0.5);
                num_result = double2uint(v9);
              }
            }
            if ( !error_no && !current_state )
              byte_200000F3 = 1;
          }
        }
        else if ( byte_2000009E )
        {
          if ( !dword_200000D4 )
            dword_200000D4 = dword_200000C8;
          if ( dword_200000D4 < dword_200000C8 )
            dword_200000D4 = dword_200000C8;
          dword_20000260 = dword_200000D4;
        }
        else
        {
          if ( !dword_200000D4 )
            dword_20000260 = dword_200000C8;
          byte_2000009D = 1;
          byte_20000090 = 1;
        }
        break;
      case 5u:
        if ( byte_2000009D )
        {
          if ( byte_2000009D == 1 )
          {
            if ( byte_2000009E )
            {
              if ( !dword_200000D8 )
                dword_200000D8 = dword_200000C8;
              if ( dword_200000D8 > dword_200000C8 )
                dword_200000D8 = dword_200000C8;
              dword_2000025C = dword_200000D8;
            }
            else if ( !dword_200000D8 )
            {
              dword_2000025C = dword_200000C8;
            }
            if ( !byte_2000009E )
            {
              byte_2000009D = 2;
              dword_20000128 = dword_2000025C * dword_2000025C;
              num_result = dword_20000260 * dword_20000260 + dword_2000025C * dword_2000025C;
              v10 = uint2double((unsigned __int16)dword_20000260 * (unsigned __int16)dword_20000260 + (unsigned __int16)dword_2000025C * (unsigned __int16)dword_2000025C);
              v11 = dsqrt(v10);
              v12 = double2uint(v11);
              num_result = v12;
              v13 = uint2double(v12);
              v14 = dadd(v13, 0.5);
              num_result = double2uint(v14);
            }
            if ( !error_no && !current_state )
              byte_200000F3 = 1;
          }
        }
        else if ( byte_2000009E )
        {
          if ( !dword_200000D8 )
            dword_200000D8 = dword_200000C8;
          if ( dword_200000D8 > dword_200000C8 )
            dword_200000D8 = dword_200000C8;
          dword_20000260 = dword_200000D8;
        }
        else
        {
          if ( !dword_200000D8 )
            dword_20000260 = dword_200000C8;
          byte_2000009D = 1;
          byte_20000090 = 1;
        }
        break;
      case 6u:
        if ( byte_2000009D )
        {
          if ( byte_2000009D == 1 )
          {
            if ( byte_2000009E )
            {
              if ( !dword_200000D4 )
                dword_200000D4 = dword_200000C8;
              if ( dword_200000D4 < dword_200000C8 )
                dword_200000D4 = dword_200000C8;
              dword_2000025C = dword_200000D4;
            }
            else
            {
              if ( !dword_200000D4 )
                dword_2000025C = dword_200000C8;
              byte_2000009D = 2;
              if ( dword_2000025C < (unsigned int)dword_20000260 )
              {
                byte_20000090 = 1;
              }
              else
              {
                error_no = 5;
                current_state = 100;
                byte_2000009D = 2;
              }
            }
          }
          else if ( byte_2000009D == 2 )
          {
            if ( byte_2000009E )
            {
              if ( !dword_200000D8 )
                dword_200000D8 = dword_200000C8;
              if ( dword_200000D8 > dword_200000C8 )
                dword_200000D8 = dword_200000C8;
              dword_20000258[0] = dword_200000D8;
            }
            else
            {
              dword_20000258[0] = dword_200000C8;
            }
            if ( !byte_2000009E )
            {
              if ( dword_20000258[0] < (unsigned int)dword_2000025C )
              {
                dword_20000258[0] = dword_200000C8;
                byte_2000009D = 3;
                dword_20000128 = dword_200000C8 * dword_200000C8;
                num_result = dword_20000260 * dword_20000260 - dword_200000C8 * dword_200000C8;
                v15 = uint2double((unsigned __int16)dword_20000260 * (unsigned __int16)dword_20000260 - (unsigned __int16)dword_200000C8 * (unsigned __int16)dword_200000C8);
                v16 = dsqrt(v15);
                num_result = double2uint(v16);
                dword_20000128 = dword_20000258[0] * dword_20000258[0];
                dword_20000134 = dword_2000025C * dword_2000025C - dword_20000258[0] * dword_20000258[0];
                v17 = ui2double(dword_2000025C * dword_2000025C - dword_20000258[0] * dword_20000258[0]);
                v18 = dsqrt(v17);
                dword_20000134 = sub_8000B30(v18);
                num_result -= dword_20000134;
                v19 = uint2double(num_result);
                v20 = dadd(v19, 0.5);
                num_result = double2uint(v20);
              }
              else
              {
                error_no = 5;
                current_state = 100;
                byte_2000009D = 3;
              }
            }
            if ( !error_no && !current_state )
              byte_200000F3 = 1;
          }
        }
        else if ( byte_2000009E )
        {
          if ( !dword_200000D4 )
            dword_200000D4 = dword_200000C8;
          if ( dword_200000D4 < dword_200000C8 )
            dword_200000D4 = dword_200000C8;
          dword_20000260 = dword_200000D4;
        }
        else
        {
          if ( !dword_200000D4 )
            dword_20000260 = dword_200000C8;
          byte_2000009D = 1;
          byte_20000090 = 1;
        }
        break;
      case 7u:
        if ( byte_2000009D )
        {
          if ( byte_2000009D == 1 )
          {
            if ( byte_2000009E )
            {
              if ( !dword_200000D8 )
                dword_200000D8 = dword_200000C8;
              if ( dword_200000D8 > dword_200000C8 )
                dword_200000D8 = dword_200000C8;
              dword_2000025C = dword_200000D8;
            }
            else
            {
              dword_2000025C = dword_200000C8;
            }
            if ( !byte_2000009E )
            {
              if ( dword_2000025C >= (unsigned int)dword_20000260 )
              {
                current_state = 100;
                error_no = 5;
                byte_2000009D = 2;
                byte_20000058 = 100;
              }
              else
              {
                byte_2000009D = 2;
                byte_20000090 = 1;
              }
            }
          }
          else if ( byte_2000009D == 2 )
          {
            if ( byte_2000009E )
            {
              if ( !dword_200000D4 )
                dword_200000D4 = dword_200000C8;
              if ( dword_200000D4 < dword_200000C8 )
                dword_200000D4 = dword_200000C8;
              dword_20000258[0] = dword_200000D4;
            }
            if ( !byte_2000009E )
            {
              if ( !dword_200000D4 )
                dword_20000258[0] = dword_200000C8;
              if ( dword_20000258[0] <= (unsigned int)dword_2000025C )
              {
                current_state = 100;
                error_no = 5;
                byte_2000009D = 3;
                byte_20000058 = 100;
              }
              else
              {
                byte_2000009D = 3;
                dword_20000128 = dword_2000025C * dword_2000025C;
                num_result = dword_20000260 * dword_20000260 - dword_2000025C * dword_2000025C;
                v21 = uint2double((unsigned __int16)dword_20000260 * (unsigned __int16)dword_20000260 - (unsigned __int16)dword_2000025C * (unsigned __int16)dword_2000025C);
                v22 = dsqrt(v21);
                num_result = double2uint(v22);
                dword_20000128 = dword_2000025C * dword_2000025C;
                dword_20000134 = dword_20000258[0] * dword_20000258[0] - dword_2000025C * dword_2000025C;
                v23 = ui2double(dword_20000258[0] * dword_20000258[0] - dword_2000025C * dword_2000025C);
                v24 = dsqrt(v23);
                dword_20000134 = sub_8000B30(v24);
                num_result += dword_20000134;
              }
            }
            if ( !error_no && !current_state )
              byte_200000F3 = 1;
          }
        }
        else if ( byte_2000009E )
        {
          if ( !dword_200000D4 )
            dword_200000D4 = dword_200000C8;
          if ( dword_200000D4 < dword_200000C8 )
            dword_200000D4 = dword_200000C8;
          dword_20000260 = dword_200000D4;
        }
        else
        {
          if ( !dword_200000D4 )
            dword_20000260 = dword_200000C8;
          byte_2000009D = 1;
          byte_20000090 = 1;
        }
        break;
    }
  }
}
























unsigned int __fastcall delay_mode_cycles(unsigned int result)
{
  unsigned int i; 
  signed int j; 

  for ( i = 0; i < result; ++i )
  {
    for ( j = 0; j < 8020; ++j )
      ;
  }
  return result;
}


void __fastcall lcd_fill(int from, int to, unsigned __int8 what)
{
  int i; 

  for ( i = 0; i < to; i = (unsigned __int8)(i + 1) )
  {
    lcd_data[from] = what;
    from = (unsigned __int8)(from + 1);
  }
}


void __cdecl sub_800C8A4()
{
  digits_4[0] = 11;
  digits_4[1] = 10;
  digits_4[2] = 10;
  digits_4[3] = 10;
  digits_4[4] = 11;
  digits_4[5] = 11;
  digits_4[6] = 11;
}


void __fastcall sub_800C8C0(int a1)
{
  int v1; 

  v1 = math_mode;
  if ( current_state == 153 )
    math_mode = byte_200000AB;
  switch_(a1, v1);
  JUMPOUT(*(_DWORD *)&word_800C8DC);
}




void __fastcall sub_800C964(int a1, int a2)
{
  switch_(a1, a2);
  JUMPOUT(*(_DWORD *)&word_800C96C);
}



void __fastcall copy_digits(signed int result)
{
  signed int v1; 
  signed int i; 
  signed int j; 
  signed int k; 

  v1 = result;
  if ( !result )
  {
    while ( result < 6 )
    {
      digits_1[result] = digits[result];
      result = (unsigned __int8)(result + 1);
    }
  }
  if ( v1 == 1 )
  {
    for ( i = 0; i < 6; i = (unsigned __int8)(i + 1) )
      digits_2[i] = digits[i];
  }
  if ( v1 == 2 )
  {
    for ( j = 0; j < 6; j = (unsigned __int8)(j + 1) )
      digits_3[j] = digits[j];
  }
  if ( v1 == 3 )
  {
    for ( k = 0; k < 6; k = (unsigned __int8)(k + 1) )
      digits_4[k] = digits[k];
  }
}


int __fastcall sub_800CA78(double a1)
{
  signed int v1; 
  double v2; 
  int v3; 
  int v4; 
  double v5; 
  char v6; 
  double v7; 
  unsigned int v8; 
  double v9; 

  v1 = ((unsigned int)(2 * HIDWORD(a1)) >> 21) - 1023;
  LODWORD(v2) = -2013235812;
  v3 = HIDWORD(a1);
  v4 = LODWORD(a1);
  if ( v1 >= 20 )
  {
    if ( v1 <= 51 )
    {
      v8 = 0xFFFFFFFF >> (((unsigned int)(2 * HIDWORD(a1)) >> 21) - 19);
      if ( LODWORD(a1) & v8 )
      {
        HIDWORD(v2) = 2117592124;
        v9 = sub_80006B6(a1, v2);
        d_gt(v9, 0.0);
        if ( !v6 )
        {
          if ( v3 < 0 && v1 != 20 )
            v4 += 1 << (52 - v1);
          v4 &= ~v8;
        }
        goto LABEL_18;
      }
    }
  }
  else
  {
    if ( v1 < 0 )
    {
      HIDWORD(v2) = 2117592124;
      v5 = dadd(a1, v2);
      d_gt(v5, 0.0);
      if ( v6 )
      {
LABEL_18:
        LODWORD(a1) = v4;
        return LODWORD(a1);
      }
      if ( v3 >= 0 )
      {
        v4 = 0;
        goto LABEL_18;
      }
      if ( !(((unsigned int)(2 * v3) >> 1) | v4) )
        goto LABEL_18;
LABEL_10:
      v4 = 0;
      goto LABEL_18;
    }
    if ( HIDWORD(a1) & (0xFFFFFu >> (((unsigned int)(2 * HIDWORD(a1)) >> 21) + 1)) | LODWORD(a1) )
    {
      HIDWORD(v2) = 2117592124;
      v7 = dadd(a1, v2);
      d_gt(v7, 0.0);
      if ( v6 )
        goto LABEL_18;
      goto LABEL_10;
    }
  }
  return LODWORD(a1);
}


void __fastcall convet_2_digits(unsigned int result)
{
  byte_2000018B = 0;
  byte_2000018C = 0;
  while ( result >= 0xA )
  {
    result -= 10;
    ++byte_2000018B;
  }
  byte_2000018C = result;
}




void __fastcall convert_number(unsigned int a1, int a2)
{
  unsigned int v2; 
  signed int i; 
  int v4; 

  v2 = a1;
  for ( i = 0; i < 5; i = (unsigned __int8)(i + 1) )
    digits[i] = 0;
  v4 = a2;
  byte_2000007B = 0;
  while ( v2 > 99999 )
  {
    v2 = sub_80001BC(v2, 0xAu);
    --v4;
  }
  if ( v4 >= 0 )
  {
    byte_2000007B = v4;
    while ( v2 >= 10000 )
    {
      v2 -= 10000;
      ++digits[0];
    }
    while ( v2 >= 0x3E8 )
    {
      v2 -= 1000;
      ++digits[1];
    }
    while ( v2 >= 0x64 )
    {
      v2 -= 100;
      ++digits[2];
    }
    while ( v2 >= 0xA )
    {
      v2 -= 10;
      ++digits[3];
    }
    digits[4] = v2;
  }
  else
  {
    digits[3] = 10;
    digits[4] = 10;
    digits[5] = 10;
  }
}



void __fastcall select_laser(int a1)
{
  unsigned __int8 v1; 

  v1 = a1;
  if ( a1 )
    GPIO_Reset(0x48000400, 0x2000);
  else
    GPIO_Set(0x48000400, 0x2000);
  selected_laser = v1;
}


unsigned int __fastcall delay_cycles1(unsigned int result)
{
  unsigned int i; 

  for ( i = 0; i < result; ++i )
    ;
  return result;
}


void __cdecl main()
{
  double v0; 
  double v1; 
  double v2; 
  double v3; 
  double v4; 
  float v5; 
  double v6; 
  double v7; 
  double v8; 
  double v9; 
  double v10; 
  double v11; 
  float v12; 
  double v13; 
  double v14; 
  double v15; 
  double v16; 
  double v17; 
  double v18; 
  double v19; 
  double v20; 
  double v21; 
  double v22; 
  double v23; 
  double v24; 
  double v25; 

  digits_4[6] = 11;
  digits_4[7] = 11;
  digits_4[8] = 11;
  digits_4[9] = 11;
  beep_enabled = 1;
  if ( !somemagicflag )
  {
    if ( word_200000DC & 0x8000 )
    {
      v2 = f2d(320.0);
      v15 = sub_80006E4(299792.458, v2);
      v21 = sub_80006E4(v15, 360.0);
      v3 = ui2double(word_200000DC & 0x7FFF);
      v4 = sub_80006E4(v3, v21);
      v5 = d2f(v4);
      dword_200000E4 = v5;
      v6 = f2d(v5);
      v7 = sub_80006B6(v6, 360.0);
      dword_200000E4 = d2f(v7);
    }
    else
    {
      v0 = f2d(320.0);
      v1 = sub_80006E4(299792.458, v0);
      v20 = sub_80006E4(v1, 360.0);
      v18 = uint2double(word_200000DC);
      v24 = sub_80006E4(v18, v20);
      dword_200000E4 = d2f(v24);
    }
    if ( word_200000DE & 0x8000 )
    {
      v9 = f2d(320.0);
      v17 = sub_80006E4(299792.458, v9);
      v23 = sub_80006E4(v17, 360.0);
      v10 = ui2double(word_200000DE & 0x7FFF);
      v11 = sub_80006E4(v10, v23);
      v12 = d2f(v11);
      dword_200000EC = v12;
      v13 = f2d(v12);
      v14 = sub_80006B6(v13, 360.0);
      dword_200000EC = d2f(v14);
    }
    else
    {
      v8 = f2d(320.0);
      v16 = sub_80006E4(299792.458, v8);
      v22 = sub_80006E4(v16, 360.0);
      v19 = uint2double(word_200000DE);
      v25 = sub_80006E4(v19, v22);
      dword_200000EC = d2f(v25);
    }
  }
  LODWORD(dword_20000208[0]) = 0;
  LODWORD(dword_2000020C) = 0;
  byte_200000AA = 0;
  byte_200000AF = 1;
  dword_20000B9C = 0;
  dword_20000BA0 = 0;
  dword_20000BA4 = 0;
  adc_read_battery();
  beep_do_();
  math_mode = 0;
  uart1_init(115200);
  delay_cycles_16000(18);
  bt_set_name();
  delay_cycles_16000(18);
  bt_set_baud();
  delay_cycles_16000(18);
  bt_save_config();
  delay_cycles_16000(18);
  uart1_init(9600);
  delay_cycles_16000(18);
  bt_set_name();
  delay_cycles_16000(18);
  bt_save_config();
  byte_2000006D = 1;
  GPIO_Reset(0x48000000, 0x2000);
  sub_800C8C0(byte_20000000);
  byte_2000016D = 1;
  byte_20000158 = 0;
  while ( 1 )
  {
    if ( timer_ticked == 1 )
    {
      button_handler();
      sub_80050B8();
      word_20000138 = 0;
      uart_result();
      byte_200000A2 = 1;
      timer_ticked = 0;
    }
    if ( (signed int)timer_count > 9 )
    {
      if ( !current_state )
        adc_read_battery();
      if ( byte_2000005B )
      {
        byte_2000005B = 0;
        if ( current_state == 161 && (signed int)word_20000070 > 0 )
        {
          --word_20000070;
          beep_do(1, 8);
        }
      }
      else
      {
        byte_2000005B = 1;
      }
      if ( (signed int)word_2000001E > 0 )
      {
        if ( !byte_2000009E )
          --word_2000001E;
        if ( (signed int)byte_2000006D > 0 && (signed int)word_2000001E > 0 )
          GPIO_Reset(0x48000400, 8);
        if ( !word_2000001E || !byte_2000006D )
          GPIO_Set(0x48000400, 8);
      }
      timer_count = 0;
      byte_20000182 = 10;
    }
    if ( (signed int)byte_20000182 > 9 )
    {
      byte_20000182 = 0;
      lcd_draw();
      byte_2000005C = 0;
      if ( !byte_2000005D && !byte_2000009E )
      {
        if ( (signed int)word_20000110 > 0 )
          --word_20000110;
        if ( !word_20000110 && (signed int)current_state > 0 && (signed int)current_state < 100 )
        {
          disable_laser();
          error_no = 0;
          current_state = 100;
        }
      }
      if ( !timer_downcount && !byte_2000005D && byte_2000016D == 1 )
      {
        if ( !byte_2000009E )
          JUMPOUT(&loc_800E18C);
        timer_downcount = 3000;
        byte_2000006C = 1;
        beep_do(1, 8);
        error_no = 0;
        byte_2000010D = 0;
        byte_2000010C = 0;
        byte_2000010E = 0;
        byte_2000009E = 0;
      }
    }
    if ( byte_200000A2 )
    {
      byte_200000A2 = 0;
      sub_800E23C();
      if ( byte_2000005C || byte_2000005E )
      {
        if ( (signed int)math_mode > 0 && byte_2000005C )
          do_math();
        if ( !math_mode )
        {
          if ( byte_2000005C )
            byte_200000F3 = 1;
        }
        lcd_draw();
        byte_2000005E = 0;
        byte_2000005C = 0;
      }
    }
  }
}



























unsigned int __fastcall abs_diff(unsigned int a1, unsigned int a2)
{
  unsigned int result; 

  if ( a1 < a2 )
    result = a2 - a1;
  else
    result = a1 - a2;
  return result;
}


void __cdecl sub_800D5B8()
{
  signed int i; 
  char v1; 
  float v2; 
  float v3; 
  float v4; 
  float v5; 
  double v6; 
  double v7; 
  unsigned int v8; 
  signed int j; 
  signed int k; 
  unsigned int v11; 

  for ( i = 0; i < byte_20000189; i = (unsigned __int8)(i + 1) )
  {
    dword_20000034 = i2f(dword_20000264[i]);
    dword_20000264[i] = sub_8001098(dword_20000034);
    if ( !somemagicflag )
    {
      if ( (unsigned int)dword_20000264[i] > 80000 )
      {
        dword_20000034 = i2f(dword_20000264[i] - 80000);
        dword_20000034 = fdiv(dword_20000034, 320000.0);
        dword_20000034 = fmul(dword_20000034, 80.0);
        f_gt(dword_20000034, 80.0);
        if ( !v1 )
          LODWORD(dword_20000034) = 0x42A00000;
        v2 = i2f(dword_20000264[i]);
        v3 = fsub(v2, dword_20000034);
        dword_20000264[i] = sub_8001098(v3);
      }
      if ( (unsigned int)dword_20000264[i] > 70000 && (unsigned int)dword_20000264[i] <= 175000 )
        dword_20000264[i] -= 25;
      if ( (unsigned int)dword_20000264[i] > 130000 && (unsigned int)dword_20000264[i] <= 150000 )
        dword_20000264[i] -= 15;
      if ( (unsigned int)dword_20000264[i] >= 15000 && (unsigned int)dword_20000264[i] <= 0x61A8 )
        dword_20000264[i] -= 10;
      if ( (unsigned int)dword_20000264[i] >= 30000 && (unsigned int)dword_20000264[i] <= 40000 )
        dword_20000264[i] -= 20;
      if ( (unsigned int)dword_20000264[i] >= 40000 && (unsigned int)dword_20000264[i] <= 70000 )
        dword_20000264[i] -= 25;
      if ( (unsigned int)dword_20000264[i] > 175000 && (unsigned int)dword_20000264[i] < 210000 )
        dword_20000264[i] += 10;
      if ( (unsigned int)dword_20000264[i] > 175000 )
        dword_20000264[i] -= 40;
      if ( (unsigned int)(dword_20000264[i] + 1120) <= 8000 )
      {
        dword_20000034 = i2f(8000 - dword_20000264[i]);
        dword_20000034 = fdiv(dword_20000034, 4000.0);
        dword_20000034 = fmul(dword_20000034, 10.0);
        v4 = i2f(dword_20000264[i]);
        v5 = fsub(v4, dword_20000034);
        dword_20000264[i] = sub_8001098(v5);
      }
      if ( (unsigned int)dword_20000264[i] > 4500 && (unsigned int)dword_20000264[i] < 0x2328 )
        dword_20000264[i] -= 18;
      if ( (unsigned int)dword_20000264[i] <= 4500 && (unsigned int)dword_20000264[i] > 0x28 )
        dword_20000264[i] -= 40;
      if ( (unsigned int)dword_20000264[i] > 500000 )
        dword_20000264[i] -= 80;
      if ( (unsigned int)dword_20000264[i] > 600000 )
        dword_20000264[i] -= 20;
      if ( (unsigned int)dword_20000264[i] > 800000 )
        dword_20000264[i] -= 50;
      dword_20000264[i] += 10 * byte_200000F0;
    }
    v6 = uint2double(dword_20000264[i]);
    LODWORD(v7) = sub_800CA78(v6);
    dword_20000264[i] = double2uint(v7);
  }
  sub_800B476((int)dword_20000264, byte_20000189);
  word_2000022C = LOWORD(dword_20000264[byte_20000189 - 1]) - LOWORD(dword_20000264[0]);
  v8 = (unsigned int)(dword_2000026C + dword_20000268) >> 1;
  if ( !dword_200000CC )
    dword_200000CC = (unsigned int)(dword_2000026C + dword_20000268) >> 1;
  if ( !dword_2000026C )
  {
    error_no = 1;
    byte_2000005A = 0;
  }
  if ( (unsigned int)(dword_2000026C - dword_20000268) > 2000 )
    error_no = 1;
  if ( v8 < 450 || v8 > max_distance )
    error_no = 8;
  if ( (unsigned int)(dword_20000264[byte_20000189 - 1] - dword_20000264[0]) < 0x14 && !error_no )
    ++byte_20000064;
  if ( dword_20000264[byte_20000189 - 1] == dword_20000264[0] && !error_no )
    byte_20000064 = -56;
  if ( error_no )
  {
    if ( error_no != 8 )
    {
      for ( j = 0; j < byte_20000189; j = (unsigned __int8)(j + 1) )
      {
        if ( abs_diff(dword_20000264[j], dword_200000CC) < 0x3C )
        {
          v8 = dword_200000CC;
          byte_20000064 = 3;
          error_no = 0;
          LOBYTE(j) = 66;
        }
      }
    }
  }
  else if ( abs_diff(dword_200000CC, (unsigned int)(dword_2000026C + dword_20000268) >> 1) > 4500 )
  {
    for ( k = 0; k < byte_20000189; k = (unsigned __int8)(k + 1) )
    {
      if ( abs_diff(dword_20000264[k], dword_200000CC) < 0x1F4 )
      {
        v8 = dword_20000264[k];
        byte_20000064 = 3;
        LOBYTE(k) = 66;
      }
    }
    byte_2000005A = 0;
  }
  if ( !error_no )
  {
    v11 = abs_diff(dword_200000CC, v8);
    byte_20000064 += sub_80001D0(v11, 0xAu);
    if ( (signed int)(unsigned __int8)byte_20000064 >= 3 )
    {
      byte_20000064 = 0;
      if ( abs_diff(dword_200000CC, v8) > 30 )
        dword_200000CC = v8;
      else
        dword_200000CC = (dword_200000CC + v8) >> 1;
    }
  }
  if ( !dword_200000CC && error_no != 8 )
    error_no = 1;
}













void __cdecl sub_800DADC()
{
  signed int i; 
  signed int j; 
  double v2; 
  char v3; 
  double v4; 
  double v5; 
  char v6; 

  byte_20000098 = 1;
  for ( i = 0; i < byte_20000189; i = (unsigned __int8)(i + 1) )
  {
    for ( j = 0; j < 4; j = (unsigned __int8)(j + 1) )
    {
      flt_20000EEC[j] = fsub(laser1_phase[j][i], laser2_phase[j][i]);
      v2 = f2d(flt_20000EEC[j]);
      d_lt(v2, 0.0);
      if ( !v3 )
      {
        v4 = f2d(flt_20000EEC[j]);
        v5 = dadd(v4, 360.0);
        flt_20000EEC[j] = d2f(v5);
      }
    }
    dword_20000044 = sub_800DC44();
    dword_20000DAC[i] = dword_20000044;
  }
  sub_800B42C((int)dword_20000DAC, byte_20000189);
  dword_20000034 = fsub(
                     dword_20000DAC[((signed int)byte_20000189 >> 1) + 1],
                     dword_20000DAC[((signed int)byte_20000189 >> 1) - 1]);
  f_gt(dword_20000034, 1000.0);
  if ( !v3 )
    byte_20000098 = 0;
  dword_20000034 = fsub(dword_20000DAC[byte_20000189 - 2], dword_20000DB4);
  f_gt(dword_20000034, 18000.0);
  if ( !v3 )
    byte_20000098 = 0;
  if ( byte_20000098 == 1 )
    dword_20000044 = dword_20000DAC[(signed int)byte_20000189 >> 1];
  sub_800F578(dword_20000044, -1.0);
  if ( v6 )
    byte_20000098 = 0;
  if ( !byte_20000098 )
    ++byte_20000096;
}


float sub_800DC44()
{
  char v0; 
  float v1; 
  float v2; 
  float v3; 
  float v4; 
  float v5; 
  float v6; 
  float v7; 
  float v8; 
  float result; 
  double v10; 
  double v11; 

  error_no = 0;
  dword_200001C8 = sub_800B814(2, 3, 0);
  f_gt(dword_200001C8, 152000.0);
  if ( !v0 )
  {
    v1 = fsub(320.0, 318.1);
    v2 = fdiv(300000.0, v1);
    dword_200001C8 = fsub(v2, dword_200001C8);
  }
  dword_20000C8C[0] = sub_800B814(0, 1, 0);
  dword_20000040 = dword_200001C8;
  v3 = fsub(270.0, 260.0);
  dword_200001CC = sub_800B658(v3, 0);
  LODWORD(dword_20000040) = dword_200001CC;
  dword_20000C8C[0] = sub_800B814(0, 3, 0);
  dword_20000C90 = sub_800B814(0, 2, 0);
  v4 = fsub(320.0, 260.0);
  dword_200001D0 = sub_800B658(v4, 0);
  v5 = fsub(318.1, 260.0);
  dword_200001D4 = sub_800B658(v5, 1);
  v6 = fmul(2.0, dword_20000040);
  f_lt(v6, *(float *)&dword_200001D0);
  if ( !v0 || (v7 = fmul(2.0, dword_20000040), f_lt(v7, *(float *)&dword_200001D4), !v0) )
  {
    f_gt(dword_20000040, 1000.0);
    if ( !v0 )
      error_no = 2;
  }
  v8 = fadd(*(float *)&dword_200001D0, *(float *)&dword_200001D4);
  dword_20000C8C[0] = fdiv(v8, 2.0);
  dword_20000034 = dword_20000C8C[0];
  if ( error_no )
  {
    LODWORD(dword_20000034) = 0;
    if ( error_no == 2 )
      LODWORD(dword_20000034) = 0xBF800000;
    error_no = 0;
    result = dword_20000034;
  }
  else
  {
    v10 = f2d(dword_20000034);
    v11 = dadd(v10, 0.5);
    result = d2f(v11);
  }
  return result;
}








void __fastcall sub_800DDE8(unsigned __int8 *a1)
{
  unsigned __int8 *v1; 
  double v2; 
  char v3; 
  double v4; 
  double v5; 
  signed int j; 
  float v7; 
  float v8; 
  unsigned __int16 v9; 
  float v10; 
  float v11; 
  float v12; 
  int v13; 
  unsigned int v14; 
  signed int v15; 
  unsigned int v16; 
  signed int i; 

  v1 = a1;
  v2 = f2d(dword_20000034);
  d_gt(v2, 0.0);
  if ( v3 )
  {
    convert_number(0, 0);
    for ( i = 0; i < 4; i = (unsigned __int8)(i + 1) )
      digits[i] = digits[i + 2];
    v1[6] = 11;
    v1[7] = 11;
    v1[8] = 11;
    v1[9] = 11;
  }
  else
  {
    dword_20000034 = fdiv(dword_20000034, 10.0);
    v4 = f2d(dword_20000034);
    v5 = sub_80006E4(v4, 25.3999);
    dword_20000034 = d2f(v5);
    word_20000144 = sub_8001098(dword_20000034);
    word_20000144 = sub_80001D0(word_20000144, 0xCu);
    convert_number(word_20000144, 0);
    for ( j = 0; j < 3; j = (unsigned __int8)(j + 1) )
      digits[j] = digits[j + 2];
    word_20000144 *= 12;
    v7 = i2f(word_20000144);
    v8 = sub_800F728(v7, dword_20000034);
    word_20000144 = sub_8001098(v8);
    if ( (signed int)word_20000144 < 10 )
    {
      digits[3] = 0;
      digits[4] = word_20000144;
    }
    else
    {
      word_20000144 -= 10;
      digits[3] = 1;
      digits[4] = word_20000144;
    }
    v9 = sub_8001098(dword_20000034);
    word_20000144 = v9;
    v10 = i2f(v9);
    v11 = sub_800F728(v10, dword_20000034);
    dword_20000034 = v11;
    v12 = fmul(v11, 16.0);
    dword_20000034 = v12;
    v13 = sub_8001098(v12);
    v14 = v13;
    if ( !v13 )
      v14 = 1;
    v1[6] = 11;
    v1[7] = 11;
    v15 = 0;
    if ( !(v14 & 1) )
    {
      v14 >>= 1;
      v15 = 1;
    }
    if ( !(v14 & 1) )
    {
      v14 >>= 1;
      v15 = (unsigned __int8)(v15 + 1);
    }
    if ( !(v14 & 1) )
    {
      v14 >>= 1;
      v15 = (unsigned __int8)(v15 + 1);
    }
    if ( v14 <= 0xA )
    {
      v1[7] = v14;
      if ( !v1[7] )
        v1[7] = 1;
    }
    else
    {
      v1[6] = 1;
      v1[7] = v14 - 10;
    }
    v16 = 16;
    while ( v15 > 0 )
    {
      v16 >>= 1;
      v15 = (unsigned __int8)(v15 - 1);
    }
    if ( v16 == 16 )
    {
      v1[8] = 1;
      v1[9] = 6;
    }
    if ( v16 == 8 )
    {
      v1[8] = 11;
      v1[9] = 8;
    }
    if ( v16 == 4 )
    {
      v1[8] = 11;
      v1[9] = 4;
    }
    if ( v16 == 2 )
    {
      v1[8] = 11;
      v1[9] = 2;
    }
  }
}


void __fastcall sub_800DFD4(unsigned __int8 *a1)
{
  unsigned __int8 *v1; 
  double v2; 
  char v3; 
  double v4; 
  double v5; 
  float v6; 
  unsigned int v7; 
  signed int v8; 
  unsigned int v9; 

  v1 = a1;
  v2 = f2d(dword_20000034);
  d_gt(v2, 0.0);
  if ( v3 )
  {
    convert_number(0, 0);
    v1[6] = 11;
    v1[7] = 11;
    v1[8] = 11;
    v1[9] = 11;
  }
  else
  {
    dword_20000034 = fdiv(dword_20000034, 10.0);
    v4 = f2d(dword_20000034);
    v5 = sub_80006E4(v4, 25.3999);
    dword_20000034 = d2f(v5);
    word_20000144 = sub_8001098(dword_20000034);
    convert_number(word_20000144, 0);
    v6 = i2f(word_20000144);
    dword_20000034 = sub_800F728(v6, dword_20000034);
    dword_20000034 = fmul(dword_20000034, 16.0);
    v7 = sub_8001098(dword_20000034);
    if ( !v7 )
      v7 = 1;
    v1[6] = 11;
    v1[7] = 11;
    v8 = 0;
    if ( !(v7 & 1) )
    {
      v7 >>= 1;
      v8 = 1;
    }
    if ( !(v7 & 1) )
    {
      v7 >>= 1;
      v8 = (unsigned __int8)(v8 + 1);
    }
    if ( !(v7 & 1) )
    {
      v7 >>= 1;
      v8 = (unsigned __int8)(v8 + 1);
    }
    if ( v7 <= 0xA )
    {
      v1[7] = v7;
      if ( !v1[7] )
        v1[7] = 1;
    }
    else
    {
      v1[6] = 1;
      v1[7] = v7 - 10;
    }
    v9 = 16;
    while ( v8 > 0 )
    {
      v9 >>= 1;
      v8 = (unsigned __int8)(v8 - 1);
    }
    if ( v9 == 16 )
    {
      v1[8] = 1;
      v1[9] = 6;
    }
    if ( v9 == 8 )
    {
      v1[8] = 11;
      v1[9] = 8;
    }
    if ( v9 == 4 )
    {
      v1[8] = 11;
      v1[9] = 4;
    }
    if ( v9 == 2 )
    {
      v1[8] = 11;
      v1[9] = 2;
    }
  }
}


void __cdecl lcd_update()
{
  int v0; 
  signed int i; 
  signed int j; 

  v0 = 0;
  for ( i = 0; i < 4; i = (unsigned __int8)(i + 1) )
  {
    lcd_send_cmd(0x10);
    lcd_send_cmd((unsigned __int8)i);
    lcd_send_cmd(0xC0);
    for ( j = 0; j < 14; j = (unsigned __int8)(j + 1) )
    {
      lcd_send_data(lcd_data[v0]);
      v0 = (unsigned __int8)(v0 + 1);
    }
  }
}


int __fastcall uart1_send_string(_BYTE *a1)
{
  _BYTE *v1; 
  int result; 

  v1 = a1;
  while ( 1 )
  {
    result = *v1;
    if ( !*v1 )
      break;
    if ( (signed int)*v1 < 128 )
      uart1_send(*v1++);
  }
  return result;
}


double __fastcall dsqrt(double a1)
{
  double v1; 
  unsigned int v2; 
  unsigned int v3; 
  unsigned int v4; 

  v1 = a1;
  v2 = sub_8001228(LODWORD(a1), HIDWORD(a1));
  v4 = v3;
  if ( (0x7FF00000 - (2 * (v3 | (v2 != 0)) >> 1)) >> 31
    && !((0x7FF00000 - (2 * (HIDWORD(v1) | (unsigned int)(LODWORD(v1) != 0)) >> 1)) >> 31) )
  {
    sub_8001130(1);
  }
  return COERCE_DOUBLE(__PAIR__(v4, v2));
}


void __fastcall sub_800E23C()
{
  int v0; 
  unsigned int v1; 
  signed int v2; 
  signed int v3; 
  int v4; 
  char v5; 
  float v6; 
  double v7; 
  unsigned __int8 v8; 
  int v9; 
  signed int j; 
  int v11; 
  signed int i; 

  v2 = current_state;
  if ( current_state == 10 )
  {
    if ( new_adc_data )
    {
      sub_800B9AC(word_20000AE8, 0);
      new_adc_data = 0;
      sub_800B958(selected_laser, si_cfg);
      if ( ++byte_200001C2 >= (signed int)byte_20000189 )
      {
        byte_200001C2 = 0;
        if ( (signed int)(unsigned __int8)++byte_200001C5 <= 1 )
        {
          ++byte_200001C5;
          if ( selected_laser )
            select_laser(0);
          else
            select_laser(1);
          current_state = 9;
        }
        else if ( (signed int)si_cfg <= 0 )
        {
          current_state = 63;
        }
        else
        {
          si_write_config(--si_cfg);
          delay_cycles_16000(2);
          current_state = 9;
          byte_200001C5 = 0;
        }
        sub_800BC54();
        while ( !new_adc_data )
          ;
        sub_800BC54();
      }
      new_adc_data = 0;
    }
    byte_200000A2 = 1;
    byte_200000A1 = 0;
  }
  else
  {
    if ( (signed int)current_state <= 10 )
    {
      switch_(current_state - 2, v0);
      v2 = v3 >> 24;
      v4 = *(_DWORD *)(v3 + 4);
      __cdp(12, 14, v1, 15, 13, 7);
    }
    if ( v2 == 0x61 )
    {
      if ( new_adc_data )
      {
        byte_200001C1 = 0;
        byte_20000189 = 8;
        byte_20000098 = 1;
        sub_800BB28();
        if ( byte_2000009A )
        {
          if ( byte_200000A6 )
          {
            if ( apd_pwm_value > (signed int)(unsigned __int16)adp_pwm_value_laser2 )
            {
              apd_pwm_value = adp_pwm_value_laser2;
              apd_dcdc_set(adp_pwm_value_laser2);
              delay_cycles_16000(8);
            }
          }
          else if ( apd_pwm_value > (signed int)(unsigned __int16)adp_pwm_value_laser1 )
          {
            apd_pwm_value = adp_pwm_value_laser1;
            apd_dcdc_set(adp_pwm_value_laser1);
            delay_cycles_16000(8);
          }
          current_state = 2;
          byte_20000096 = 0;
          byte_20000118 = 0;
          byte_200001C1 = 0;
          byte_200000AC = 0;
        }
        else if ( (signed int)(unsigned __int16)word_20000112 <= 0 )
        {
          error_no = 1;
          current_state = 100;
        }
        else
        {
          --word_20000112;
        }
        new_adc_data = 0;
      }
      byte_200000A2 = 1;
    }
    else if ( v2 > 0x61 )
    {
      if ( v2 == 98 )
      {
        current_state = 99;
        word_20000092 = 1;
        byte_20000117 = 0;
        new_adc_data = 0;
        adc_capture_dma(0);
        return;
      }
      if ( v2 != 99 )
      {
        v5 = v2 == 100;
        if ( v2 == 100 )
        {
          disable_laser();
          beep_do(2, 8);
          current_state = 101;
          byte_200001E9 = 32;
          byte_200000F3 = 0;
          return;
        }
        goto LABEL_9;
      }
      if ( new_adc_data )
      {
        if ( !byte_2000005D )
          sub_800ACEC();
        new_adc_data = 0;
      }
      byte_200000A2 = 1;
    }
    else if ( v2 == 63 )
    {
      byte_200000A0 = 0;
      sub_800DADC();
      if ( (signed int)(unsigned __int8)++byte_200001E9 >= 16 )
      {
        byte_200001E9 = 0;
        sub_8008DF0();
      }
      if ( byte_20000098 == 1 )
      {
        current_state = 92;
      }
      else
      {
        byte_2000009F = 0;
        byte_200000A0 = 0;
        byte_20000118 = 0;
        byte_20000079 = 0;
        current_state = 2;
        ++byte_20000096;
      }
      if ( (signed int)byte_20000096 > 6 )
      {
        error_no = 1;
        current_state = 92;
      }
      byte_200000A2 = 1;
      byte_20000058 = 0;
    }
    else
    {
      if ( v2 != 92 )
      {
        v5 = v2 == 93;
LABEL_9:
        if ( v5 )
        {
          if ( !byte_2000017F )
            ++byte_2000017F;
          if ( byte_200000AD )
          {
            byte_2000009E = 0;
            byte_20000078 = 0;
          }
          if ( byte_2000009E )
          {
            byte_2000009F = 0;
            if ( !error_no )
            {
              dword_20000040 = dword_20000044;
              sub_800B4B8();
              sub_800D5B8();
            }
            if ( (signed int)(unsigned __int8)error_no > 0 )
            {
              dword_200000CC = 0;
              dword_200000D0 = 0;
            }
            dword_200000C4 = dword_200000CC;
            dword_200000C0 = dword_200000CC;
            if ( !byte_2000005A )
              dword_200000CC = (unsigned __int8)byte_2000005A;
            if ( !dword_200000D0 )
              dword_200000D0 = dword_200000C4;
            byte_20000188 = 1;
            if ( abs_diff(dword_200000D0, dword_200000C4) > 30000 )
            {
              error_no = 1;
              byte_20000188 = 0;
              dword_200000D0 = dword_200000C4;
            }
            if ( (signed int)(unsigned __int8)error_no <= 0 || error_no == 8 )
            {
              sub_800BA54();
              if ( !error_no && byte_20000188 )
              {
                if ( dword_200000C4 )
                  byte_2000011B = 0;
                dword_200000C8 = byte_800F810[(unsigned __int8)byte_2000013E] + dword_200000C4;
                v11 = sub_80001BC(dword_200000C8 + 5, 0xAu);
                dword_200000C8 = 10 * v11;
                dword_200000C0 = 10 * v11;
                if ( !dword_200000D4 )
                  dword_200000D4 = dword_200000C8;
                if ( !dword_200000D8 )
                  dword_200000D8 = dword_200000C8;
                if ( dword_200000D4 < dword_200000C8 )
                  dword_200000D4 = dword_200000C8;
                if ( dword_200000D8 > dword_200000C8 )
                  dword_200000D8 = dword_200000C8;
                byte_2000005C = 1;
                byte_200001EF = 1;
                do_math();
              }
              for ( i = 0; i < 8; i = (unsigned __int8)(i + 1) )
              {
                button_handler();
                handle_poweron_button();
              }
              byte_2000005A = 0;
              byte_20000118 = 0;
              if ( current_state == 93 )
              {
                sub_8008F14();
                byte_200000AC = 1;
              }
              if ( error_no == 8 )
              {
                if ( (signed int)(unsigned __int8)++byte_2000006E > 5 )
                {
                  byte_2000009E = 0;
                  current_state = 100;
                }
              }
              else
              {
                byte_2000006E = 0;
              }
              dword_200000D0 = dword_200000C4;
            }
            else
            {
              beep_do(2, 8);
              ++byte_2000011B;
              byte_2000005A = 0;
              byte_20000118 = 0;
              for ( j = 0; j < 8; j = (unsigned __int8)(j + 1) )
              {
                button_handler();
                handle_poweron_button();
              }
              byte_2000005A = 0;
              byte_20000118 = 0;
              if ( current_state == 93 )
              {
                sub_8008F14();
                byte_200000AC = 1;
              }
              if ( (signed int)(unsigned __int8)byte_2000011B > 5 )
              {
                current_state = 100;
                error_no = 1;
                byte_2000009E = 0;
                byte_200000AC = 0;
              }
            }
            byte_20000058 = 100;
          }
          else
          {
            byte_2000009F = byte_2000009E;
            if ( !error_no )
            {
              dword_20000040 = dword_20000044;
              sub_800B4B8();
              sub_800D5B8();
              dword_200000C4 = dword_200000CC;
              dword_200000C0 = dword_200000CC;
            }
            if ( !byte_2000005A )
              dword_200000CC = (unsigned __int8)byte_2000005A;
            if ( !dword_200000C4 && error_no != 8 )
              error_no = 1;
            if ( (signed int)(unsigned __int8)error_no <= 0 || error_no == 8 )
            {
              beep_do(1, 8);
              disable_laser();
              if ( error_no == 8 )
              {
                current_state = 100;
              }
              else
              {
                dword_200000C8 = byte_800F810[(unsigned __int8)byte_2000013E] + dword_200000C4;
                v9 = sub_80001BC(dword_200000C8 + 5, 0xAu);
                dword_200000C8 = 10 * v9;
                dword_200000C0 = 10 * v9;
                byte_2000005C = 1;
                byte_200001EF = 1;
                current_state = 0;
              }
            }
            else if ( (signed int)(unsigned __int8)++byte_2000011B <= 2 )
            {
              current_state = 2;
              apd_dcdc_set(++apd_pwm_value);
              select_laser(1);
              delay_cycles_16000(10);
            }
            else
            {
              current_state = 100;
              disable_laser();
              beep_do(2, 8);
            }
            byte_20000058 = 100;
          }
          if ( byte_200001EF == 1 )
          {
            word_20000120 = adp_pwm_value_laser2;
            word_20000122 = adp_pwm_value_laser1;
          }
        }
        return;
      }
      if ( !error_no )
      {
        dword_20000040 = dword_20000044;
        sub_800B4B8();
        sub_800D5B8();
        dword_20000208[byte_20000099] = i2f(dword_200000CC);
        sub_800F578(dword_2000020C, 0.0);
        if ( v5 )
          dword_2000020C = i2f(dword_200000CC);
        if ( (signed int)++byte_20000099 > 1 )
          byte_20000099 = 0;
        v6 = fsub(dword_20000208[0], dword_2000020C);
        v7 = f2d(v6);
        HIDWORD(v7) = (unsigned int)(2 * HIDWORD(v7)) >> 1;
        d_gt(v7, 4687.5);
        if ( !(!v5 & v8) && !somemagicflag )
          error_no = 1;
      }
      current_state = 93;
      if ( (signed int)(unsigned __int8)error_no > 0 && (signed int)(unsigned __int8)++byte_200001DC < 4 )
        current_state = 2;
    }
  }
}












































int __fastcall uart1_send(int a1)
{
  sub_800A5DE(0x40013800, a1);
  while ( !sub_800A43A(0x40013800, 128) )
    ;
  return sub_800A410(0x40013800, 0x60106u);
}


void __fastcall apd_update_level(int a1)
{
  int v1; 
  signed __int16 v2; 
  signed int v3; 
  signed int i; 
  signed int j; 

  v1 = a1;
  v2 = 0;
  adc_stop();
  apd_pwm_value = 400;
  if ( adp_pwm_value_laser2 )
    apd_pwm_value = adp_pwm_value_laser2 + 20;
  if ( v1 == 1 )
    apd_pwm_value = word_2000008C + 10;
  apd_dcdc_set(apd_pwm_value);
  signal_level = 0;
  v3 = 0;
  if ( v1 == 2 )
    select_laser(0);
  adc_select_channel(8);
  handle_poweron_button();
  delay_cycles_16000(8);
  handle_poweron_button();
  if ( v1 == 1 )
  {
    signal_level = 0;
    for ( i = 0; i < 64; i = (unsigned __int8)(i + 1) )
    {
      sub_8001638(0x40012400);
      while ( !sub_80015C0(0x40012400, 4) )
        ;
      signal_level += ADC_ReadResult(0x40012400);
      sub_8001518((_DWORD *)0x40012400, 4);
    }
    signal_level >>= 6;
    if ( signal_level > 800 )
    {
      apd_pwm_value = 400;
      apd_dcdc_set(400u);
      handle_poweron_button();
      delay_cycles_16000(8);
      handle_poweron_button();
      v1 = 0;
    }
  }
  while ( (signal_level <= 800 || signal_level >= 3600) && v3 < 160 )
  {
    signal_level = 0;
    for ( j = 0; j < 64; j = (unsigned __int8)(j + 1) )
    {
      sub_8001638(0x40012400);
      while ( !sub_80015C0(0x40012400, 4) )
        ;
      signal_level += ADC_ReadResult(0x40012400);
      sub_8001518((_DWORD *)0x40012400, 4);
    }
    signal_level >>= 6;
    if ( signal_level < 0x320 || signal_level > 0xE10 )
    {
      if ( (signed int)apd_pwm_value > 68 )
      {
        if ( (signed int)apd_pwm_value > 300 )
          v2 = 8;
        if ( (signed int)apd_pwm_value > 250 && (signed int)apd_pwm_value <= 300 )
          v2 = 4;
        if ( (signed int)apd_pwm_value <= 250 )
          v2 = 4;
        apd_pwm_value -= v2;
        apd_dcdc_set(apd_pwm_value);
        handle_poweron_button();
        delay_cycles_16000(3);
      }
      v3 = (unsigned __int16)(v3 + 1);
      if ( v3 > 160 )
      {
        signal_level = 4095;
        current_state = 100;
        error_no = 1;
      }
    }
  }
  if ( v1 != 1 )
  {
    word_2000008C = apd_pwm_value;
    word_200000B6 = apd_pwm_value;
  }
  adc_stop();
  adc_capture_dma(0);
}






void __fastcall si_write_config(int x)
{
  if ( x )
  {
    switch ( x )
    {
      case 1:
        si_write(si_disable_output1, 2u, 192);
        si_write(si_enable_fanout1, 2u, 192);
        si_write(si_set_135_00_134_995mhz, 0x44u, 192);
        si_write(si_reset_pll1, 2u, 192);
        si_write(si_enable_output1, 2u, 192);
        break;
      case 2:
        si_write(si_disable_output2, 2u, 192);
        si_write(si_enable_fanout2, 2u, 192);
        si_write(si_set_159_05_159_045, 0x44u, 192);
        si_write(si_reset_pll2, 2u, 192);
        si_write(si_enable_output2, 2u, 192);
        break;
      case 3:
        si_write(si_disable_output3, 2u, 192);
        si_write(si_enable_fanout3, 2u, 192);
        si_write(si_set_160_159_995, 0x44u, 192);
        si_write(si_reset_pll3, 2u, 192);
        si_write(si_enable_output3, 2u, 192);
        break;
    }
  }
  else
  {
    si_write(si_disable_output, 2u, 0xC0);
    si_write(si_enable_fanout, 2u, 192);
    si_write(si_set_130_00_129_995mhz, 0x44u, 192);
    si_write(si_reset_pll, 2u, 192);
    si_write(si_enable_output, 2u, 192);
  }
}


float __fastcall calc_phase(_WORD *a1, int a2)
{
  int v2; 
  int v3; 
  int i; 
  float v5; 
  float v6; 
  float v7; 
  double v8; 
  double v9; 
  double v10; 
  float v11; 
  double v12; 
  double v13; 
  double v14; 
  double v15; 
  char v16; 
  double v17; 
  double v18; 
  _WORD *v20; 
  float v21; 
  float v22; 
  float v23; 

  v2 = a2;
  v20 = a1;
  v23 = 0.0;
  v22 = 0.0;
  v3 = 0;
  for ( i = 0; i < v2; i = (unsigned __int8)(i + 1) )
  {
    v5 = i2f(*v20);
    v6 = fmul(v5, sin_tbl[v3]);
    v23 = fadd(v23, v6);
    v7 = fmul(v5, cos_tbl[v3]);
    v22 = fadd(v22, v7);
    v3 = (unsigned __int8)(v3 + 1);
    ++v20;
  }
  v8 = f2d(v23);
  v9 = f2d(v22);
  v10 = atan2(v9, v8);
  v11 = d2f(v10);
  v12 = f2d(v11);
  v13 = sub_8000C3C(v12);
  v14 = sub_80006E4(v13, 3.14159265);
  v21 = d2f(v14);
  v15 = f2d(v21);
  d_lt(v15, 0.00001);
  if ( !v16 )
  {
    v17 = f2d(v21);
    v18 = dadd(v17, 360.0);
    v21 = d2f(v18);
  }
  return v21;
}


int __fastcall d_lt(double a1, double a2)
{
  int v2; 

  v2 = HIDWORD(a1) | HIDWORD(a2);
  if ( (HIDWORD(a1) | HIDWORD(a2)) < 0 )
  {
    if ( v2 + 0x100000 < 0 )
    {
      v2 - 0x100000 >= 0;
      return LODWORD(a1);
    }
    if ( (unsigned int)(2 * HIDWORD(a1)) < 0xFFE00000 && (unsigned int)(2 * HIDWORD(a2)) < 0xFFE00000 )
      return LODWORD(a1);
LABEL_14:
    LODWORD(a1) = sub_800113C(LODWORD(a1), HIDWORD(a1), LODWORD(a2), HIDWORD(a2), 0x4160019);
    return LODWORD(a1);
  }
  if ( v2 + 0x100000 >= 0 )
  {
    v2 - 0x100000 < 0;
    return LODWORD(a1);
  }
  if ( HIDWORD(a1) + 0x100000 < 0 || HIDWORD(a2) + 0x100000 < 0 )
    goto LABEL_14;
  return LODWORD(a1);
}


unsigned int __fastcall d_gt(double a1, double a2)
{
  int v2; 

  v2 = HIDWORD(a2) | HIDWORD(a1);
  if ( (HIDWORD(a2) | HIDWORD(a1)) < 0 )
  {
    if ( v2 + 0x100000 < 0 )
    {
      v2 - 0x100000 >= 0;
      return LODWORD(a1);
    }
    if ( (unsigned int)(2 * HIDWORD(a2)) < 0xFFE00000 && (unsigned int)(2 * HIDWORD(a1)) < 0xFFE00000 )
      return LODWORD(a1);
LABEL_14:
    LODWORD(a1) = sub_800113C(LODWORD(a2), HIDWORD(a2), LODWORD(a1), HIDWORD(a1), 68550681);
    return LODWORD(a1);
  }
  if ( v2 + 0x100000 >= 0 )
  {
    v2 - 0x100000 < 0;
    return LODWORD(a1);
  }
  if ( HIDWORD(a2) + 0x100000 < 0 || HIDWORD(a1) + 0x100000 < 0 )
    goto LABEL_14;
  return LODWORD(a1);
}


float __fastcall fadd(float result, float a2)
{
  int v2; 
  int v3; 
  signed int v4; 
  unsigned int v5; 
  char v6; 
  unsigned int v7; 
  unsigned int v8; 
  unsigned int v9; 
  unsigned int v10; 

  if ( (LODWORD(result) ^ LODWORD(a2)) < 0 )
    JUMPOUT(&loc_800F74C);
  v2 = LODWORD(result) - LODWORD(a2);
  if ( LODWORD(result) < LODWORD(a2) )
  {
    LODWORD(result) -= v2;
    LODWORD(a2) += v2;
  }
  v3 = LODWORD(result) >> 23;
  v4 = (unsigned __int8)(LODWORD(result) >> 23);
  if ( v4 == 255 )
  {
    if ( LODWORD(result) << 9 )
      result = 5.1042e38/*NaN*/;
  }
  else
  {
    v5 = (unsigned int)(2 * LODWORD(a2)) >> 24;
    if ( v5 )
    {
      v6 = v4 - v5;
      v7 = ((LODWORD(a2) << 8) | 0x80000000) >> v6;
      v8 = (LODWORD(result) << 8) | 0x80000000;
      v9 = v8 + v7;
      if ( __CFADD__(v8, v7) )
      {
        v9 = __ROR4__(v9 | 1, 1);
        ++v4;
        ++v3;
      }
      v10 = v9 >> 8;
      if ( __CFSHR__(v9, 8) )
      {
        ++v10;
        if ( !(v9 << 25) && !(4 * ((LODWORD(a2) << 7) ^ (v7 >> 1 << v6))) )
          v10 &= 0xFFFFFFFE;
      }
      LODWORD(result) = v10 + ((v3 - 1) << 23);
      if ( v4 >= 255 )
        LODWORD(result) = LODWORD(result) >> 23 << 23;
    }
    else if ( !(unsigned __int8)(LODWORD(result) >> 23) )
    {
      LODWORD(result) = LODWORD(result) >> 31 << 31;
    }
  }
  return result;
}


int __fastcall sub_800F578(int result, float a2)
{
  int v2; 

  v2 = result | LODWORD(a2);
  if ( (result | LODWORD(a2)) >= 0 )
  {
    if ( v2 + 0x800000 >= 0 )
    {
      v2 - 0x800000 < 0;
      return result;
    }
    if ( result + 0x800000 >= 0 && LODWORD(a2) + 0x800000 >= 0 )
      return result;
    return sub_800132C(result, LODWORD(a2), 68288521);
  }
  if ( v2 + 0x800000 < 0 )
  {
    v2 - 0x800000 >= 0;
    return result;
  }
  if ( (unsigned int)(2 * result) >= 0xFF000000 || (unsigned int)(2 * LODWORD(a2)) >= 0xFF000000 )
    return sub_800132C(result, LODWORD(a2), 68288521);
  return result;
}


int __fastcall f_lt(int result, float a2)
{
  int v2; 

  v2 = result | LODWORD(a2);
  if ( (result | LODWORD(a2)) >= 0 )
  {
    if ( v2 + 0x800000 >= 0 )
    {
      v2 - 0x800000 < 0;
      return result;
    }
    if ( result + 0x800000 >= 0 && LODWORD(a2) + 0x800000 >= 0 )
      return result;
    return sub_800132C(result, LODWORD(a2), 68550665);
  }
  if ( v2 + 0x800000 < 0 )
  {
    v2 - 0x800000 >= 0;
    return result;
  }
  if ( (unsigned int)(2 * result) >= 0xFF000000 || (unsigned int)(2 * LODWORD(a2)) >= 0xFF000000 )
    return sub_800132C(result, LODWORD(a2), 68550665);
  return result;
}


float __fastcall fmul(float a1, float a2)
{
  int v2; 
  unsigned int v3; 
  int v4; 
  unsigned int v5; 
  unsigned int v6; 
  unsigned int v7; 
  unsigned int v8; 
  int v9; 
  int v10; 
  unsigned int v11; 
  unsigned int v12; 
  float result; 

  v3 = 2 * LODWORD(a2);
  v4 = 2 * LODWORD(a2) + __CFSHL__(LODWORD(a2), 1) + v2 + __CFSHL__(LODWORD(a1), 1) + v2;
  v5 = (unsigned int)(2 * LODWORD(a1)) >> 24;
  if ( v5 )
  {
    v6 = v3 >> 24;
    if ( v6 )
    {
      if ( v5 != 255 && v6 != 255 )
      {
        v7 = LODWORD(a1) & 0x7FFFFF;
        v8 = LODWORD(a2) & 0x7FFFFF;
        v9 = v7 * v8;
        v10 = v5 + v6 - 127;
        v11 = (v7 >> 8) * (v8 >> 8) + ((v7 + v8) << 7) + ((v7 * v8 - ((v7 >> 8) * (v8 >> 8) << 16)) >> 16);
        if ( v11 >> 30 )
        {
          v11 = (v11 >> 1) - 0x20000000;
          ++v10;
        }
        v12 = v11 >> 7;
        if ( __CFSHR__(v11, 7) )
        {
          ++v12;
          if ( !(v9 << 15) && !(v11 << 26) )
            v12 &= 0xFFFFFFFE;
        }
        if ( (unsigned int)v10 < 0xFF && v10 << 23 )
        {
          LODWORD(result) = (v12 | (v4 << 31)) + (v10 << 23);
          return result;
        }
        if ( v10 <= 0 )
        {
          LODWORD(result) = v4 << 31;
          return result;
        }
        goto LABEL_17;
      }
      goto LABEL_22;
    }
  }
  else
  {
    v6 = v3 >> 24;
  }
  if ( v5 != 255 && v6 != 255 )
  {
    LODWORD(result) = v4 << 31;
    return result;
  }
LABEL_22:
  if ( (unsigned int)(2 * LODWORD(a1)) <= 0xFF000000 && (unsigned int)(2 * LODWORD(a2)) <= 0xFF000000 && v5 + v6 != 255 )
  {
LABEL_17:
    LODWORD(result) = ((v4 << 8) | 0xFF) << 23;
    return result;
  }
  return 5.1042e38/*NaN*/;
}


int __fastcall f_gt(int result, float a2)
{
  int v2; 

  v2 = LODWORD(a2) | result;
  if ( (LODWORD(a2) | result) >= 0 )
  {
    if ( v2 + 0x800000 >= 0 )
    {
      v2 - 0x800000 < 0;
      return result;
    }
    if ( LODWORD(a2) + 0x800000 >= 0 && result + 0x800000 >= 0 )
      return result;
    return sub_800132C(
             result ^ LODWORD(a2) ^ LODWORD(a2) ^ result ^ LODWORD(a2),
             LODWORD(a2) ^ result ^ LODWORD(a2),
             68550665);
  }
  if ( v2 + 0x800000 < 0 )
  {
    v2 - 0x800000 >= 0;
    return result;
  }
  if ( (unsigned int)(2 * LODWORD(a2)) >= 0xFF000000 || (unsigned int)(2 * result) >= 0xFF000000 )
    return sub_800132C(
             result ^ LODWORD(a2) ^ LODWORD(a2) ^ result ^ LODWORD(a2),
             LODWORD(a2) ^ result ^ LODWORD(a2),
             68550665);
  return result;
}


float __cdecl sub_800F728(float a1, float a2)
{
  if ( ((LODWORD(a1) ^ 0x80000000 ^ LODWORD(a2)) & 0x80000000) != 0 )
    JUMPOUT(&loc_800F74C);
  JUMPOUT(&loc_800F4F8);
}


float __fastcall fsub(float result, float a2)
{
  unsigned int v2; 
  int v3; 
  unsigned int v4; 
  int v5; 
  unsigned int v6; 
  char v7; 
  unsigned int v8; 
  unsigned int v9; 
  unsigned __int8 v10; 
  unsigned int v11; 
  int v12; 
  unsigned int v13; 
  unsigned int v14; 
  signed int v15; 
  int v16; 
  unsigned int v17; 

  if ( (LODWORD(result) ^ LODWORD(a2)) < 0 )
    JUMPOUT(&loc_800F4F8);
  if ( LODWORD(result) < LODWORD(a2) )
  {
    v2 = (LODWORD(result) - LODWORD(a2)) ^ 0x80000000;
    LODWORD(result) -= v2;
    LODWORD(a2) += v2;
  }
  v3 = LODWORD(result) >> 23;
  v4 = 2 * LODWORD(a2);
  v5 = (unsigned __int8)(LODWORD(result) >> 23);
  if ( v5 == 255 )
  {
    v17 = v4 >> 24;
    if ( LODWORD(result) << 9 || v17 == 255 )
      result = 5.1042e38/*NaN*/;
  }
  else
  {
    v6 = v4 >> 24;
    if ( !v6 )
    {
      if ( (unsigned __int8)(LODWORD(result) >> 23) )
        return result;
      return 0.0;
    }
    v7 = v5 - v6;
    v8 = ((LODWORD(a2) << 8) | 0x80000000) >> v7;
    v9 = ((LODWORD(result) << 8) & 0x7FFFFFFF) - v8;
    if ( (v9 & 0x80000000) != 0 )
    {
      v10 = __CFSHL__(v9, 2);
      v11 = 4 * v9;
      if ( !v10 )
      {
        v14 = v11 >> 1;
        if ( v14 )
        {
          v15 = 1;
          if ( !(v14 >> 16) )
          {
            v14 <<= 16;
            v15 = 17;
          }
          if ( !(v14 >> 24) )
          {
            v14 <<= 8;
            v15 += 8;
          }
          if ( !(v14 >> 28) )
          {
            v14 *= 16;
            v15 += 4;
          }
          if ( !(v14 >> 30) )
          {
            v14 *= 4;
            v15 += 2;
          }
          if ( !(v14 >> 31) )
          {
            v14 *= 2;
            ++v15;
          }
          v3 -= v15;
          v16 = v5 - v15;
          LODWORD(result) = (2 * v14 >> 9) + (v3 << 23);
          if ( v16 >= 1 )
            return result;
LABEL_32:
          LODWORD(result) = (unsigned int)(v3 + 192) >> 8 << 31;
          return result;
        }
        return 0.0;
      }
      v9 = v11 >> 1;
      --v3;
      if ( v5 == 1 )
        goto LABEL_32;
    }
    v12 = v3 << 23;
    v13 = v9 >> 8;
    if ( __CFSHR__(v9, 8) )
    {
      LODWORD(result) = v12 + __CFSHR__(v9, 8) + v13;
      if ( !(v9 << 25) )
      {
        if ( 2 * ((LODWORD(a2) << 8) ^ (v8 << v7)) )
          --LODWORD(result);
        else
          LODWORD(result) &= 0xFFFFFFFE;
      }
    }
    else
    {
      LODWORD(result) = v13 + v12;
    }
  }
  return result;
}
